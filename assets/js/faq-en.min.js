document.addEventListener("DOMContentLoaded",()=>{"use strict";const e=Array.from(document.querySelectorAll(".faq-item")),t=document.querySelector(".faq-navigation"),a=document.getElementById("faq-search"),n=document.getElementById("clear-search"),o=Array.from(document.querySelectorAll(".faq-section")),r=document.querySelector(".main-content"),s=document.querySelector(".page-header"),c=document.querySelector(".main-content");if(!e.length&&!s&&!c)return;function l(e,t){let a;return function(){const n=this,o=arguments;clearTimeout(a),a=setTimeout(()=>e.apply(n,o),t)}}if(t&&t.addEventListener("click",e=>{const t=e.target.closest("a");if(!t)return;const a=t.dataset.category||"unknown";"function"==typeof gtag&&gtag("event","faq_nav_click",{event_category:"FAQ Navigation",event_label:`Clicked category: ${a}`,value:1}),"function"==typeof hj&&hj("event",`faq_nav_clicked_category_${a.replace(/\s/g,"_").toLowerCase()}`)}),document.querySelectorAll(".button-link").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.ctaType||"generic";"function"==typeof gtag&&gtag("event","faq_cta_click",{event_category:"FAQ Call to Action",event_label:`CTA Clicked: ${t}`,value:1}),"function"==typeof hj&&hj("event",`faq_cta_clicked_${t}`)})}),document.querySelectorAll(".faq-answer .text-link").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.linkType||"generic";"function"==typeof gtag&&gtag("event","faq_text_link_click",{event_category:"FAQ Internal Link",event_label:`Text link clicked: ${t}`,value:1}),"function"==typeof hj&&hj("event",`faq_text_link_clicked_${t}`)})}),a&&n&&o.length){let t=document.getElementById("faq-search-status");t||(t=document.createElement("div"),t.id="faq-search-status",t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="faq-search-status sr-only",(a.closest("form")||a.parentNode).appendChild(t)),n.getAttribute("aria-label")||n.setAttribute("aria-label","Clear FAQ search");const r=(a,n)=>{const o=e.length,r=a.trim();t.textContent=r?n?`${n} result${1===n?"":"s"} found for “${r}”.`:`No results found for “${r}”.`:`Showing all ${o} questions.`},s=()=>{const e=(a.value||"").trim().toLowerCase();n.style.display=e?"block":"none";let t=0;o.forEach(a=>{let n=!1;a.querySelectorAll(".faq-item").forEach(a=>{const o=a.querySelector("summary"),r=o?o.textContent.toLowerCase():"",s=a.querySelector(".faq-answer"),c=s?s.textContent.toLowerCase():"",l=(a.dataset.keywords||"").toLowerCase();!e||r.includes(e)||c.includes(e)||l.includes(e)?(a.hidden=!1,n=!0,t++,!e||a.open||a.dataset.openedByUser||(a.open=!0,a.dataset.openedBySearch="true",o&&o.setAttribute("aria-expanded","true"))):(a.hidden=!0,a.open&&a.dataset.openedBySearch&&(a.open=!1,delete a.dataset.openedBySearch,o&&o.setAttribute("aria-expanded","false")))}),a.hidden=!n}),"function"==typeof gtag&&gtag("event","faq_search",{event_category:"FAQ Search",search_term:e,results_count:t}),"function"==typeof hj&&e&&hj("event",`faq_searched_${e.replace(/\s/g,"_").toLowerCase()}`),r(e,t)},c=l(s,200);a.addEventListener("input",c),a.addEventListener("keydown",e=>{"Escape"===e.key&&(e.preventDefault(),a.value="",n.style.display="none",s())}),n.addEventListener("click",()=>{a.value="",n.style.display="none",e.forEach(e=>{e.hidden=!1,e.open&&e.dataset.openedBySearch&&(e.open=!1,delete e.dataset.openedBySearch);const t=e.querySelector("summary");t&&t.setAttribute("aria-expanded",e.open?"true":"false")}),o.forEach(e=>{e.hidden=!1}),r("",e.length),"function"==typeof gtag&&gtag("event","faq_search_cleared",{event_category:"FAQ Search",event_label:"Search input cleared"}),"function"==typeof hj&&hj("event","faq_search_cleared"),a.focus()}),n.style.display="none",r("",e.length)}r&&e.length&&r.addEventListener("click",t=>{const a=t.target.closest(".faq-item summary");if(!a)return;if("A"===t.target.tagName)return t.preventDefault(),void(window.location.href=t.target.href);t.preventDefault();const n=a.parentElement,o=n.dataset.questionId||"unknown",r=n.open;e.forEach(e=>{if(e!==n){e.open=!1,delete e.dataset.openedByUser,delete e.dataset.openedBySearch;const t=e.querySelector("summary");t&&t.setAttribute("aria-expanded","false")}}),r?(n.open=!1,a.setAttribute("aria-expanded","false"),"function"==typeof gtag&&gtag("event","faq_collapse",{event_category:"FAQ Interaction",event_label:`Question collapsed: ${o}`,question_text:a.textContent.trim()}),"function"==typeof hj&&hj("event",`faq_collapsed_${o}`),delete n.dataset.openedBySearch,delete n.dataset.openedByUser):(n.open=!0,a.setAttribute("aria-expanded","true"),n.dataset.openedByUser="true",delete n.dataset.openedBySearch,setTimeout(()=>{const e=n.getBoundingClientRect();(e.top<0||e.bottom>window.innerHeight)&&n.scrollIntoView({behavior:"smooth",block:"nearest"})},450),"function"==typeof gtag&&gtag("event","faq_expand",{event_category:"FAQ Interaction",event_label:`Question expanded: ${o}`,question_text:a.textContent.trim()}),"function"==typeof hj&&hj("event",`faq_expanded_${o}`))}),e.forEach(e=>{const t=e.querySelector("summary");t&&(t.setAttribute("aria-expanded",e.open?"true":"false"),t.addEventListener("focus",()=>{const e=getComputedStyle(document.documentElement).getPropertyValue("--primary-blue")||"#007bff";t.style.outline=`3px solid ${e.trim()}66`,t.style.outlineOffset="5px"}),t.addEventListener("blur",()=>{t.style.outline="none",t.style.outlineOffset="0"}))});!!window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches||(s&&(s.style.opacity="0",s.style.transform="translateY(-20px)",setTimeout(()=>{s.style.transition="opacity 1s ease-out, transform 1s ease-out",s.style.opacity="1",s.style.transform="translateY(0)"},100)),c&&(c.style.opacity="0",c.style.transform="translateY(20px)",setTimeout(()=>{c.style.transition="opacity 1s ease-out, transform 1s ease-out",c.style.opacity="1",c.style.transform="translateY(0)"},300)))});