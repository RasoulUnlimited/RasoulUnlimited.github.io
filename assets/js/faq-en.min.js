document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll(".faq-item"),t=document.querySelector(".faq-navigation"),n=document.getElementById("faq-search"),a=document.getElementById("clear-search"),o=document.querySelectorAll(".faq-section");function r(e,t){let n;return function(){const a=this,o=arguments;clearTimeout(n),n=setTimeout(()=>e.apply(a,o),t)}}t&&t.addEventListener("click",e=>{const t=e.target.closest("a");if(!t)return;const n=t.dataset.category;"function"==typeof gtag&&gtag("event","faq_nav_click",{event_category:"FAQ Navigation",event_label:`Clicked category: ${n}`,value:1}),"function"==typeof hj&&hj("event",`faq_nav_clicked_category_${n.replace(/\s/g,"_").toLowerCase()}`)}),document.querySelectorAll(".button-link").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.ctaType;"function"==typeof gtag&&gtag("event","faq_cta_click",{event_category:"FAQ Call to Action",event_label:`CTA Clicked: ${t}`,value:1}),"function"==typeof hj&&hj("event",`faq_cta_clicked_${t}`)})}),document.querySelectorAll(".faq-answer .text-link").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.linkType;"function"==typeof gtag&&gtag("event","faq_text_link_click",{event_category:"FAQ Internal Link",event_label:`Text link clicked: ${t}`,value:1}),"function"==typeof hj&&hj("event",`faq_text_link_clicked_${t}`)})});const c=r(()=>{const e=n.value.trim().toLowerCase();e.length>0?a.style.display="block":a.style.display="none";let t=0;o.forEach(n=>{let a=!1;n.querySelectorAll(".faq-item").forEach(n=>{const o=n.querySelector("summary").textContent.toLowerCase(),r=n.querySelector(".faq-answer"),c=r?r.textContent.toLowerCase():"",s=n.dataset.keywords?n.dataset.keywords.toLowerCase():"";o.includes(e)||c.includes(e)||s.includes(e)?(n.style.display="block",a=!0,t++,n.open||n.hasAttribute("data-opened-by-user")||(n.open=!0,n.setAttribute("data-opened-by-search","true"))):(n.style.display="none",n.open&&n.hasAttribute("data-opened-by-search")&&(n.open=!1,n.removeAttribute("data-opened-by-search")))}),n.style.display=a?"block":"none"}),"function"==typeof gtag&&gtag("event","faq_search",{event_category:"FAQ Search",search_term:e,results_count:t}),"function"==typeof hj&&hj("event",`faq_searched_${e.replace(/\s/g,"_").toLowerCase()}`)},200);n.addEventListener("input",c),a.addEventListener("click",()=>{n.value="",a.style.display="none",e.forEach(e=>{e.style.display="block",e.open&&e.hasAttribute("data-opened-by-search")&&(e.open=!1,e.removeAttribute("data-opened-by-search"))}),o.forEach(e=>{e.style.display="block"}),"function"==typeof gtag&&gtag("event","faq_search_cleared",{event_category:"FAQ Search",event_label:"Search input cleared"}),"function"==typeof hj&&hj("event","faq_search_cleared")});const s=document.querySelector(".main-content");s&&s.addEventListener("click",t=>{const n=t.target.closest(".faq-item summary");if(!n)return;if("A"===t.target.tagName)return t.preventDefault(),void(window.location.href=t.target.href);t.preventDefault();const a=n.parentElement,o=a.dataset.questionId,r=a.open;e.forEach(e=>{e!==a&&(e.open=!1,e.removeAttribute("data-opened-by-user"))}),r?(a.open=!1,"function"==typeof gtag&&gtag("event","faq_collapse",{event_category:"FAQ Interaction",event_label:`Question collapsed: ${o}`,question_text:n.textContent.trim()}),"function"==typeof hj&&hj("event",`faq_collapsed_${o}`),a.removeAttribute("data-opened-by-search"),a.removeAttribute("data-opened-by-user")):(a.open=!0,setTimeout(()=>{const e=a.getBoundingClientRect();(e.top<0||e.bottom>window.innerHeight)&&a.scrollIntoView({behavior:"smooth",block:"nearest"})},450),"function"==typeof gtag&&gtag("event","faq_expand",{event_category:"FAQ Interaction",event_label:`Question expanded: ${o}`,question_text:n.textContent.trim()}),"function"==typeof hj&&hj("event",`faq_expanded_${o}`),a.setAttribute("data-opened-by-user","true"),a.removeAttribute("data-opened-by-search"))}),e.forEach(e=>{const t=e.querySelector("summary");t.addEventListener("focus",()=>{t.style.outline=`3px solid ${getComputedStyle(document.documentElement).getPropertyValue("--primary-blue")}66`,t.style.outlineOffset="5px"}),t.addEventListener("blur",()=>{t.style.outline="none",t.style.outlineOffset="0"})});const l=document.querySelector(".page-header"),i=document.querySelector(".main-content");l&&(l.style.opacity="0",l.style.transform="translateY(-20px)",setTimeout(()=>{l.style.transition="opacity 1s ease-out, transform 1s ease-out",l.style.opacity="1",l.style.transform="translateY(0)"},100)),i&&(i.style.opacity="0",i.style.transform="translateY(20px)",setTimeout(()=>{i.style.transition="opacity 1s ease-out, transform 1s ease-out",i.style.opacity="1",i.style.transform="translateY(0)"},300))});