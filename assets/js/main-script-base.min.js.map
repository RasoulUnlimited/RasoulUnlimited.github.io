{"version":3,"file":"main-script-base.min.js","names":["window","langStrings","storage","testKey","localStorage","setItem","removeItem","err","getSafeStorage","ASSET_FALLBACK_FAILED_CLASS","NETWORK_EVENT_NAME","assetFallbackAttempts","Set","lastNetworkToastAt","darkMediaQuery","matchMedia","prefersDark","matches","THEME_STORAGE_KEY","LEGACY_THEME_STORAGE_KEY","isValidTheme","value","readStoredTheme","storedTheme","getItem","legacyTheme","savedTheme","reduceMotionQuery","prefersReducedMotion","TOAST_EXIT_FALLBACK_MS","TOAST_STACK_SHIFTS_BOTTOM","TOAST_STACK_SHIFTS_TOP","TOAST_STACK_SCALE_LOSS","TOAST_KIND_ICONS","success","error","info","default","toastRegistry","Map","toastState","top","position","viewport","visible","queue","bottom","normalizeToastOptions","optionsOrType","input","kind","safeKind","String","toLowerCase","normalizeToastKind","type","durationRaw","Number","duration","isFinite","Math","round","id","trim","customClass","iconClass","iconColor","closeButton","role","ariaLive","swipeDismiss","getToastState","ensureToastViewport","state","isConnected","selector","existing","document","querySelector","HTMLElement","body","createElement","className","dataset","toastPosition","setAttribute","appendChild","isSwipeEnabled","entry","setting","settings","touchCapable","navigator","maxTouchPoints","canUseToastSwipe","syncToastStack","Array","isArray","length","shifts","slice","reverse","forEach","index","toast","shift","min","scaleLoss","style","setProperty","removeEntry","collection","indexOf","splice","pruneToastState","filter","mounted","stopToastTimers","dismissing","get","delete","timer","clearTimeout","progressAnimation","cancel","stopSwipeRebound","swipe","reboundTimer","resetSwipeState","classList","remove","releaseToastSwipe","cleanup","applyToastContent","classes","push","join","toastKind","tabIndex","removeAttribute","fragment","createDocumentFragment","icon","text","textContent","message","isFaLocale","documentElement","lang","startsWith","closeBtn","innerHTML","addEventListener","dismissToastEntry","once","progress","replaceChildren","startToastLifecycle","hidden","animate","transform","easing","fill","startToastProgress","setTimeout","mountToastEntry","pointerId","active","startX","startY","startAt","lastX","lastY","lastAt","onPointerDown","event","isPrimary","button","target","Element","closest","clientX","clientY","Date","now","add","setPointerCapture","onPointerMove","dx","dy","abs","completeSwipe","elapsed","max","velocity","absDx","absDy","direction","targetOffset","innerWidth","onPointerCancel","removeEventListener","installToastSwipe","requestAnimationFrame","__ruToastFeedback","flushToastQueue","next","finalized","finalize","createToastEntry","console","warn","has","refreshVisibleToast","targetState","set","createToast","updateNetworkState","online","notify","isOnline","toggle","detail","timestamp","dispatchEvent","CustomEvent","createEvent","initCustomEvent","emitNetworkStatusEvent","strings","keyOrder","key","result","getNetworkMessage","resolveAssetFallback","rawUrl","parsed","URL","location","href","origin","toSameOriginUrl","toString","path","pathname","test","replace","markAssetFallbackAttempt","originalUrl","fallbackUrl","currentCount","assetFallbackCount","applyTheme","theme","showToast","isDark","shouldShowToast","getElementById","checked","themeChanged","msg","onLine","HTMLScriptElement","src","script","defer","async","crossOrigin","referrerPolicy","nonce","insertAdjacentElement","injectScriptFallback","HTMLLinkElement","rel","link","media","injectStylesheetFallback","handleThemeSystemChange","e","addListener","initThemeToggle","themeToggleInput","themeToggleInit","currentTheme","getAttribute","newTheme","preventDefault","endOfPageShown","lastScrollY","ticking","scrollY","pageYOffset","scrollPosition","innerHeight","docHeight","scrollHeight","offsetHeight","endOfPage","checkPageEnd","progressBar","scrollTop","clientHeight","width","scrollPercent","clamped","updateProgressBar","passive","yearEl","getFullYear","backToTopBtn","resolveCopyToastMessage","subject","keys","unsupported","isFa","fallback","resolveShareToastMessage","copyText","options","allowExecCommand","clipboard","writeText","ok","mode","probe","left","select","execCommand","copyWithExecCommand","emitToast","bindCopyButton","btn","HTMLButtonElement","toastCopyBound","stopPropagation","textToCopy","includes","originalIcon","showCopySuccessState","failedKind","scrollTo","behavior","querySelectorAll","toastShareBound","shareUrl","share","title","url","name","bindShareButton","rect","getBoundingClientRect","x","y","ripple","triggerSuccess","element"],"sources":["main-script-base.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function () {\r\n  \"use strict\";\r\n\r\n  // Ensure language strings object exists\r\n  if (!window.langStrings) {\r\n    window.langStrings = {};\r\n  }\r\n\r\n  /**\r\n   * Safe localStorage accessor with feature / privacy mode detection\r\n   */\r\n  function getSafeStorage() {\r\n    const testKey = \"__theme_pref__\";\r\n    try {\r\n      localStorage.setItem(testKey, testKey);\r\n      localStorage.removeItem(testKey);\r\n      return localStorage;\r\n    } catch (err) {\r\n      // e.g. Safari private mode or blocked storage\r\n      return null;\r\n    }\r\n  }\r\n\r\n  const storage = getSafeStorage();\n  const ASSET_FALLBACK_CLASS = \"asset-fallback-active\";\n  const ASSET_FALLBACK_FAILED_CLASS = \"asset-fallback-failed\";\n  const NETWORK_EVENT_NAME = \"ru:network-status\";\n  const assetFallbackAttempts = new Set();\n  let lastNetworkToastAt = 0;\n\r\n  // Reuse a single MediaQueryList if available\r\n  const darkMediaQuery = window.matchMedia\n    ? window.matchMedia(\"(prefers-color-scheme: dark)\")\n    : null;\n  const prefersDark = !!(darkMediaQuery && darkMediaQuery.matches);\n  const THEME_STORAGE_KEY = \"theme\";\n  const LEGACY_THEME_STORAGE_KEY = \"app:theme\";\n\n  function isValidTheme(value) {\n    return value === \"dark\" || value === \"light\";\n  }\n\n  function readStoredTheme() {\n    if (!storage) {return null;}\n\n    const storedTheme = storage.getItem(THEME_STORAGE_KEY);\n    if (isValidTheme(storedTheme)) {\n      return storedTheme;\n    }\n\n    const legacyTheme = storage.getItem(LEGACY_THEME_STORAGE_KEY);\n    if (!isValidTheme(legacyTheme)) {\n      return null;\n    }\n\n    // One-time migration from legacy key to canonical key.\n    try {\n      storage.setItem(THEME_STORAGE_KEY, legacyTheme);\n      storage.removeItem(LEGACY_THEME_STORAGE_KEY);\n    } catch (err) {\n      // Ignore storage failures in restricted environments.\n    }\n\n    return legacyTheme;\n  }\n\n  const savedTheme = readStoredTheme();\n\r\n  // Motion preference (for smooth scroll, etc.)\r\n  const reduceMotionQuery = window.matchMedia\r\n    ? window.matchMedia(\"(prefers-reduced-motion: reduce)\")\r\n    : null;\r\n  const prefersReducedMotion = !!(reduceMotionQuery && reduceMotionQuery.matches);\r\n\r\n  const TOAST_LIMIT_PER_POSITION = 3;\n  const TOAST_DEFAULT_DURATION = 2800;\n  const TOAST_EXIT_FALLBACK_MS = prefersReducedMotion ? 60 : 260;\n  const TOAST_STACK_SHIFTS_BOTTOM = [0, -3, -6];\n  const TOAST_STACK_SHIFTS_TOP = [0, 3, 6];\n  const TOAST_STACK_SCALE_LOSS = [0, 0.005, 0.01];\n  const TOAST_SWIPE_MIN_DISTANCE = 56;\n  const TOAST_SWIPE_MAX_CROSS_AXIS = 24;\n  const TOAST_SWIPE_MIN_VELOCITY = 0.35;\n  const TOAST_SWIPE_DISMISS_OFFSET_VW = 72;\n  const TOAST_KIND_ICONS = {\n    success: \"fas fa-check-circle\",\n    error: \"fas fa-exclamation-circle\",\n    info: \"fas fa-circle-info\",\n    default: \"fas fa-bell\",\n  };\n  const toastRegistry = new Map();\n  const toastState = {\n    top: {\n      position: \"top\",\n      viewport: null,\n      visible: [],\n      queue: [],\n    },\n    bottom: {\n      position: \"bottom\",\n      viewport: null,\n      visible: [],\n      queue: [],\n    },\n  };\n\n  function normalizeToastKind(kind) {\n    const safeKind = String(kind || \"default\").toLowerCase();\n    if (safeKind === \"success\" || safeKind === \"error\" || safeKind === \"info\") {\n      return safeKind;\n    }\n    return \"default\";\n  }\n\n  function normalizeToastOptions(optionsOrType) {\n    const input =\n      typeof optionsOrType === \"string\"\n        ? { kind: optionsOrType }\n        : optionsOrType && typeof optionsOrType === \"object\"\n          ? optionsOrType\n          : {};\n\n    const kind = normalizeToastKind(input.kind || input.type);\n    const durationRaw = Number(input.duration);\n    const duration =\n      Number.isFinite(durationRaw) && durationRaw >= 0\n        ? Math.round(durationRaw)\n        : TOAST_DEFAULT_DURATION;\n    const id = typeof input.id === \"string\" ? input.id.trim() : \"\";\n    const position = input.position === \"top\" ? \"top\" : \"bottom\";\n    const customClass =\n      typeof input.customClass === \"string\" ? input.customClass.trim() : \"\";\n    const iconClass =\n      typeof input.iconClass === \"string\" && input.iconClass.trim()\n        ? input.iconClass.trim()\n        : TOAST_KIND_ICONS[kind];\n    const iconColor =\n      typeof input.iconColor === \"string\" ? input.iconColor.trim() : \"\";\n    const closeButton = !!input.closeButton;\n    const role =\n      typeof input.role === \"string\" && input.role.trim()\n        ? input.role.trim()\n        : kind === \"error\"\n          ? \"alert\"\n          : \"status\";\n    const ariaLive =\n      typeof input.ariaLive === \"string\" && input.ariaLive.trim()\n        ? input.ariaLive.trim()\n        : kind === \"error\"\n          ? \"assertive\"\n          : \"polite\";\n    const swipeDismiss =\n      input.swipeDismiss === true\n        ? true\n        : input.swipeDismiss === false\n          ? false\n          : \"auto\";\n\n    return {\n      id,\n      kind,\n      duration,\n      position,\n      customClass,\n      iconClass,\n      iconColor,\n      closeButton,\n      role,\n      ariaLive,\n      swipeDismiss,\n    };\n  }\n\n  function getToastState(position) {\n    return position === \"top\" ? toastState.top : toastState.bottom;\n  }\n\n  function ensureToastViewport(position) {\n    const state = getToastState(position);\n    if (state.viewport && state.viewport.isConnected) {\n      return state.viewport;\n    }\n\n    const selector = `.toast-viewport[data-toast-position=\"${position}\"]`;\n    const existing = document.querySelector(selector);\n    if (existing instanceof HTMLElement) {\n      state.viewport = existing;\n      return state.viewport;\n    }\n\n    if (!document.body) {\n      return null;\n    }\n\n    const viewport = document.createElement(\"div\");\n    viewport.className = \"toast-viewport\";\n    viewport.dataset.toastPosition = position;\n    viewport.setAttribute(\"aria-live\", \"off\");\n    document.body.appendChild(viewport);\n    state.viewport = viewport;\n    return viewport;\n  }\n\n  function canUseToastSwipe() {\n    const touchCapable =\n      (typeof navigator.maxTouchPoints === \"number\" && navigator.maxTouchPoints > 0) ||\n      \"ontouchstart\" in window;\n\n    if (typeof window.matchMedia !== \"function\") {\n      return touchCapable;\n    }\n    try {\n      return window.matchMedia(\"(pointer: coarse)\").matches || touchCapable;\n    } catch {\n      return touchCapable;\n    }\n  }\n\n  function isSwipeEnabled(entry) {\n    const setting = entry && entry.settings ? entry.settings.swipeDismiss : \"auto\";\n    if (setting === false) {\n      return false;\n    }\n    if (setting === true) {\n      return true;\n    }\n    return canUseToastSwipe();\n  }\n\n  function syncToastStack(state) {\n    if (!state || !Array.isArray(state.visible) || state.visible.length === 0) {\n      return;\n    }\n\n    const shifts =\n      state.position === \"top\" ? TOAST_STACK_SHIFTS_TOP : TOAST_STACK_SHIFTS_BOTTOM;\n\n    // The newest visible toast gets the front-most stack values.\n    const ordered = state.visible.slice().reverse();\n    ordered.forEach((entry, index) => {\n      if (!entry || !(entry.toast instanceof HTMLElement)) {\n        return;\n      }\n\n      const shift = shifts[Math.min(index, shifts.length - 1)];\n      const scaleLoss =\n        TOAST_STACK_SCALE_LOSS[Math.min(index, TOAST_STACK_SCALE_LOSS.length - 1)];\n      entry.toast.style.setProperty(\"--toast-stack-shift\", `${shift}px`);\n      entry.toast.style.setProperty(\"--toast-stack-scale-loss\", String(scaleLoss));\n      entry.toast.style.setProperty(\"--toast-z\", String(300 - index));\n    });\n  }\n\n  function removeEntry(collection, entry) {\n    const index = collection.indexOf(entry);\n    if (index >= 0) {\n      collection.splice(index, 1);\n    }\n  }\n\n  function pruneToastState(state) {\n    state.visible = state.visible.filter((entry) => {\n      if (!entry || !(entry.toast instanceof HTMLElement)) {\n        return false;\n      }\n      if (entry.toast.isConnected && entry.mounted) {\n        return true;\n      }\n\n      stopToastTimers(entry);\n      entry.mounted = false;\n      entry.dismissing = false;\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      return false;\n    });\n\n    state.queue = state.queue.filter((entry) => !!entry && !entry.dismissing);\n  }\n\n  function stopToastTimers(entry) {\n    if (entry.timer) {\n      clearTimeout(entry.timer);\n      entry.timer = null;\n    }\n    if (entry.progressAnimation) {\n      try {\n        entry.progressAnimation.cancel();\n      } catch {}\n      entry.progressAnimation = null;\n    }\n  }\n\n  function stopSwipeRebound(entry) {\n    if (entry && entry.swipe && entry.swipe.reboundTimer) {\n      clearTimeout(entry.swipe.reboundTimer);\n      entry.swipe.reboundTimer = null;\n    }\n  }\n\n  function resetSwipeState(entry) {\n    if (!entry || !(entry.toast instanceof HTMLElement)) {\n      return;\n    }\n\n    stopSwipeRebound(entry);\n    entry.toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n    entry.toast.classList.remove(\"is-swiping\", \"swipe-dismiss\", \"swipe-rebound\");\n  }\n\n  function releaseToastSwipe(entry) {\n    if (!entry || !entry.swipe || typeof entry.swipe.cleanup !== \"function\") {\n      return;\n    }\n    entry.swipe.cleanup();\n    entry.swipe.cleanup = null;\n  }\n\n  function installToastSwipe(entry) {\n    if (\n      !entry ||\n      !(entry.toast instanceof HTMLElement) ||\n      !isSwipeEnabled(entry) ||\n      (entry.swipe && typeof entry.swipe.cleanup === \"function\")\n    ) {\n      return;\n    }\n\n    const toast = entry.toast;\n    const state = {\n      pointerId: null,\n      active: false,\n      startX: 0,\n      startY: 0,\n      startAt: 0,\n      lastX: 0,\n      lastY: 0,\n      lastAt: 0,\n      reboundTimer: null,\n      cleanup: null,\n    };\n    entry.swipe = state;\n\n    const onPointerDown = (event) => {\n      if (entry.dismissing || event.isPrimary === false || event.button > 0) {\n        return;\n      }\n      if (event.target instanceof Element && event.target.closest(\".toast-close\")) {\n        return;\n      }\n\n      state.pointerId = event.pointerId;\n      state.active = true;\n      state.startX = event.clientX;\n      state.startY = event.clientY;\n      state.startAt = Date.now();\n      state.lastX = event.clientX;\n      state.lastY = event.clientY;\n      state.lastAt = state.startAt;\n      stopSwipeRebound(entry);\n      toast.classList.add(\"is-swiping\");\n      toast.classList.remove(\"swipe-rebound\", \"swipe-dismiss\");\n      stopToastTimers(entry);\n\n      if (typeof toast.setPointerCapture === \"function\") {\n        try {\n          toast.setPointerCapture(event.pointerId);\n        } catch {}\n      }\n    };\n\n    const onPointerMove = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n\n      const dx = event.clientX - state.startX;\n      const dy = event.clientY - state.startY;\n      state.lastX = event.clientX;\n      state.lastY = event.clientY;\n      state.lastAt = Date.now();\n\n      if (Math.abs(dy) > TOAST_SWIPE_MAX_CROSS_AXIS * 1.6) {\n        return;\n      }\n\n      toast.style.setProperty(\"--toast-swipe-x\", `${dx}px`);\n    };\n\n    const completeSwipe = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n\n      state.active = false;\n      const dx = state.lastX - state.startX;\n      const dy = state.lastY - state.startY;\n      const elapsed = Math.max(1, state.lastAt - state.startAt);\n      const velocity = Math.abs(dx) / elapsed;\n      const absDx = Math.abs(dx);\n      const absDy = Math.abs(dy);\n      const validSwipe =\n        absDx >= TOAST_SWIPE_MIN_DISTANCE &&\n        absDy <= TOAST_SWIPE_MAX_CROSS_AXIS &&\n        velocity >= TOAST_SWIPE_MIN_VELOCITY;\n\n      if (validSwipe) {\n        toast.classList.remove(\"is-swiping\", \"swipe-rebound\");\n        toast.classList.add(\"swipe-dismiss\");\n        const direction = dx >= 0 ? 1 : -1;\n        const targetOffset = Math.round((window.innerWidth * TOAST_SWIPE_DISMISS_OFFSET_VW) / 100);\n        toast.style.setProperty(\"--toast-swipe-x\", `${direction * targetOffset}px`);\n\n        if (prefersReducedMotion) {\n          dismissToastEntry(entry);\n          return;\n        }\n\n        setTimeout(() => {\n          dismissToastEntry(entry);\n        }, 110);\n        return;\n      }\n\n      toast.classList.remove(\"is-swiping\", \"swipe-dismiss\");\n      toast.classList.add(\"swipe-rebound\");\n      toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n      state.reboundTimer = setTimeout(() => {\n        toast.classList.remove(\"swipe-rebound\");\n        state.reboundTimer = null;\n      }, prefersReducedMotion ? 1 : 220);\n      startToastLifecycle(entry);\n    };\n\n    const onPointerCancel = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n      state.active = false;\n      toast.classList.remove(\"is-swiping\", \"swipe-dismiss\");\n      toast.classList.add(\"swipe-rebound\");\n      toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n      state.reboundTimer = setTimeout(() => {\n        toast.classList.remove(\"swipe-rebound\");\n        state.reboundTimer = null;\n      }, prefersReducedMotion ? 1 : 220);\n      startToastLifecycle(entry);\n    };\n\n    toast.addEventListener(\"pointerdown\", onPointerDown);\n    toast.addEventListener(\"pointermove\", onPointerMove);\n    toast.addEventListener(\"pointerup\", completeSwipe);\n    toast.addEventListener(\"pointercancel\", onPointerCancel);\n    toast.addEventListener(\"lostpointercapture\", onPointerCancel);\n\n    state.cleanup = () => {\n      toast.removeEventListener(\"pointerdown\", onPointerDown);\n      toast.removeEventListener(\"pointermove\", onPointerMove);\n      toast.removeEventListener(\"pointerup\", completeSwipe);\n      toast.removeEventListener(\"pointercancel\", onPointerCancel);\n      toast.removeEventListener(\"lostpointercapture\", onPointerCancel);\n      stopSwipeRebound(entry);\n      if (entry && entry.swipe) {\n        entry.swipe.active = false;\n      }\n    };\n  }\n\n  function applyToastContent(entry) {\n    const { settings, toast } = entry;\n    const classes = [\"dynamic-toast\", `toast-kind-${settings.kind}`];\n    if (settings.customClass) {\n      classes.push(settings.customClass);\n    }\n    toast.className = classes.join(\" \");\n    toast.dataset.toastKind = settings.kind;\n    toast.dataset.toastPosition = settings.position;\n    toast.setAttribute(\"role\", settings.role);\n    toast.setAttribute(\"aria-live\", settings.ariaLive);\n    toast.setAttribute(\"aria-atomic\", \"true\");\n    toast.tabIndex = -1;\n    if (settings.id) {\n      toast.id = settings.id;\n    } else {\n      toast.removeAttribute(\"id\");\n    }\n\n    const fragment = document.createDocumentFragment();\n    if (settings.iconClass) {\n      const icon = document.createElement(\"i\");\n      icon.className = `${settings.iconClass} toast-icon`.trim();\n      if (settings.iconColor) {\n        icon.dataset.iconColor = settings.iconColor;\n      }\n      icon.setAttribute(\"aria-hidden\", \"true\");\n      fragment.appendChild(icon);\n    }\n\n    const text = document.createElement(\"span\");\n    text.className = \"toast-message\";\n    text.textContent = entry.message;\n    fragment.appendChild(text);\n\n    if (settings.closeButton) {\n      const isFaLocale = (document.documentElement.lang || \"\")\n        .toLowerCase()\n        .startsWith(\"fa\");\n      const closeBtn = document.createElement(\"button\");\n      closeBtn.type = \"button\";\n      closeBtn.className = \"toast-close\";\n      closeBtn.setAttribute(\n        \"aria-label\",\n        isFaLocale ? \"بستن پیام\" : \"Close message\"\n      );\n      closeBtn.innerHTML = '<i class=\"fas fa-times\" aria-hidden=\"true\"></i>';\n      closeBtn.addEventListener(\n        \"click\",\n        () => dismissToastEntry(entry),\n        { once: true }\n      );\n      fragment.appendChild(closeBtn);\n    }\n\n    const progress = document.createElement(\"span\");\n    progress.className = \"toast-progress\";\n    progress.setAttribute(\"aria-hidden\", \"true\");\n    fragment.appendChild(progress);\n\n    toast.replaceChildren(fragment);\n  }\n\n  function startToastProgress(entry) {\n    const progress = entry.toast.querySelector(\".toast-progress\");\n    if (!(progress instanceof HTMLElement)) {\n      return;\n    }\n\n    progress.hidden = entry.settings.duration <= 0;\n    if (prefersReducedMotion || entry.settings.duration <= 0) {\n      return;\n    }\n\n    if (typeof progress.animate !== \"function\") {\n      return;\n    }\n\n    try {\n      entry.progressAnimation = progress.animate(\n        [\n          { transform: \"scaleX(1)\" },\n          { transform: \"scaleX(0)\" },\n        ],\n        {\n          duration: entry.settings.duration,\n          easing: \"linear\",\n          fill: \"forwards\",\n        }\n      );\n    } catch {}\n  }\n\n  function startToastLifecycle(entry) {\n    stopToastTimers(entry);\n    startToastProgress(entry);\n\n    if (entry.settings.duration > 0) {\n      entry.timer = setTimeout(() => {\n        dismissToastEntry(entry);\n      }, entry.settings.duration);\n    }\n  }\n\n  function refreshVisibleToast(entry) {\n    if (!entry.mounted || !entry.toast) {\n      return;\n    }\n\n    entry.dismissing = false;\n    resetSwipeState(entry);\n    applyToastContent(entry);\n    entry.toast.classList.add(\"show\");\n    entry.toast.classList.remove(\"is-closing\");\n    startToastLifecycle(entry);\n    syncToastStack(entry.state || getToastState(entry.settings.position));\n  }\n\n  function mountToastEntry(entry) {\n    const state = entry.state || getToastState(entry.settings.position);\n    const viewport = ensureToastViewport(state.position);\n    if (!viewport) {\n      return;\n    }\n\n    entry.state = state;\n    entry.mounted = true;\n    entry.dismissing = false;\n    resetSwipeState(entry);\n    applyToastContent(entry);\n    viewport.appendChild(entry.toast);\n    state.visible.push(entry);\n    syncToastStack(state);\n    installToastSwipe(entry);\n\n    requestAnimationFrame(() => {\n      if (!entry.mounted) {\n        return;\n      }\n\n      entry.toast.classList.add(\"show\");\n      startToastLifecycle(entry);\n\n      if (typeof window.__ruToastFeedback === \"function\") {\n        try {\n          window.__ruToastFeedback();\n        } catch {}\n      }\n    });\n  }\n\n  function flushToastQueue(position) {\n    const state = getToastState(position);\n    ensureToastViewport(position);\n    pruneToastState(state);\n\n    while (\n      state.visible.length < TOAST_LIMIT_PER_POSITION &&\n      state.queue.length > 0\n    ) {\n      const next = state.queue.shift();\n      if (!next) {\n        continue;\n      }\n\n      if (next.dismissing) {\n        continue;\n      }\n\n      mountToastEntry(next);\n    }\n    syncToastStack(state);\n  }\n\n  function dismissToastEntry(entry) {\n    if (!entry || entry.dismissing) {\n      return;\n    }\n\n    entry.dismissing = true;\n    stopToastTimers(entry);\n    stopSwipeRebound(entry);\n\n    if (!entry.mounted || !(entry.toast instanceof HTMLElement)) {\n      const queuedState = entry.state || getToastState(entry.settings.position);\n      removeEntry(queuedState.queue, entry);\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      releaseToastSwipe(entry);\n      entry.dismissing = false;\n      return;\n    }\n\n    const { toast } = entry;\n    toast.classList.remove(\"show\");\n    toast.classList.add(\"is-closing\");\n\n    let finalized = false;\n    const finalize = () => {\n      if (finalized) {\n        return;\n      }\n      finalized = true;\n\n      const state = entry.state || getToastState(entry.settings.position);\n      removeEntry(state.visible, entry);\n      removeEntry(state.queue, entry);\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      releaseToastSwipe(entry);\n      toast.remove();\n      entry.mounted = false;\n      entry.dismissing = false;\n      flushToastQueue(state.position);\n      syncToastStack(state);\n    };\n\n    toast.addEventListener(\n      \"transitionend\",\n      (event) => {\n        if (event.target === toast) {\n          finalize();\n        }\n      },\n      { once: true }\n    );\n    setTimeout(finalize, TOAST_EXIT_FALLBACK_MS);\n  }\n\n  function createToastEntry(message, optionsOrType) {\n    if (!message && message !== 0) {\n      return null;\n    }\n    if (!document.body) {\n      console.warn(\"Cannot show toast: document.body not ready\");\n      return null;\n    }\n\n    const settings = normalizeToastOptions(optionsOrType);\n    const text = String(message);\n\n    pruneToastState(toastState.top);\n    pruneToastState(toastState.bottom);\n\n    if (settings.id && toastRegistry.has(settings.id)) {\n      const entry = toastRegistry.get(settings.id);\n      entry.message = text;\n      entry.settings = {\n        ...entry.settings,\n        ...settings,\n        position: entry.mounted ? entry.settings.position : settings.position,\n      };\n\n      if (entry.mounted) {\n        refreshVisibleToast(entry);\n        return entry;\n      }\n\n      const targetState = getToastState(entry.settings.position);\n      removeEntry(toastState.top.queue, entry);\n      removeEntry(toastState.bottom.queue, entry);\n      entry.state = targetState;\n      targetState.queue.push(entry);\n      flushToastQueue(targetState.position);\n      return entry;\n    }\n\n    const entry = {\n      message: text,\n      settings,\n      state: getToastState(settings.position),\n      toast: document.createElement(\"div\"),\n      timer: null,\n      progressAnimation: null,\n      dismissing: false,\n      mounted: false,\n      swipe: null,\n    };\n\n    if (settings.id) {\n      toastRegistry.set(settings.id, entry);\n    }\n\n    entry.state.queue.push(entry);\n    flushToastQueue(entry.state.position);\n    return entry;\n  }\n\n  /**\n   * Unified toast API.\n   * Backward compatible signatures:\n   *  - createToast(message, \"success\"|\"error\"|\"info\"|\"default\")\n   *  - createToast(message, options)\n   */\n  function createToast(message, optionsOrType) {\n    const entry = createToastEntry(message, optionsOrType);\n    return entry ? entry.toast : null;\n  }\n\n  // Expose the unified toast API globally.\n  window.createToast = createToast;\n\n  function getNetworkMessage(online) {\n    const strings = window.langStrings || {};\n    const keyOrder = online\n      ? [\"backOnline\", \"online\", \"connectionRestored\"]\n      : [\"offline\", \"connectionLost\"];\n\n    for (const key of keyOrder) {\n      const value = strings[key];\n      if (typeof value === \"function\") {\n        const result = value();\n        if (typeof result === \"string\" && result.trim()) {\n          return result;\n        }\n      } else if (typeof value === \"string\" && value.trim()) {\n        return value;\n      }\n    }\n\n    return online\n      ? \"Connection restored.\"\n      : \"You are offline. Some features may be unavailable.\";\n  }\n\n  function emitNetworkStatusEvent(online) {\n    const detail = { online, timestamp: Date.now() };\n    try {\n      window.dispatchEvent(\n        new CustomEvent(NETWORK_EVENT_NAME, {\n          detail,\n        })\n      );\n    } catch (err) {\n      // CustomEvent fallback for old browsers.\n      try {\n        const event = document.createEvent(\"CustomEvent\");\n        event.initCustomEvent(NETWORK_EVENT_NAME, false, false, detail);\n        window.dispatchEvent(event);\n      } catch {}\n    }\n  }\n\n  function updateNetworkState(online, notify) {\n    const isOnline = !!online;\n\n    document.documentElement.classList.toggle(\"online\", isOnline);\n    document.documentElement.classList.toggle(\"offline\", !isOnline);\n    document.documentElement.setAttribute(\"data-network-status\", isOnline ? \"online\" : \"offline\");\n\n    if (document.body) {\n      document.body.classList.toggle(\"online\", isOnline);\n      document.body.classList.toggle(\"offline\", !isOnline);\n    }\n\n    emitNetworkStatusEvent(isOnline);\n\n    if (!notify || typeof window.createToast !== \"function\") {\n      return;\n    }\n\n    const now = Date.now();\n    if (now - lastNetworkToastAt < 1200) {\n      return;\n    }\n    lastNetworkToastAt = now;\n    window.createToast(getNetworkMessage(isOnline), {\n      id: \"network-status-toast\",\n      kind: isOnline ? \"success\" : \"info\",\n      duration: 2600,\n    });\n  }\n\n  function installNetworkResilience() {\n    const initialOnline = navigator.onLine !== false;\n    updateNetworkState(initialOnline, false);\n    window.addEventListener(\"online\", () => updateNetworkState(true, true));\n    window.addEventListener(\"offline\", () => updateNetworkState(false, true));\n  }\n\n  function toSameOriginUrl(rawUrl) {\n    if (!rawUrl) {\n      return null;\n    }\n\n    try {\n      const parsed = new URL(rawUrl, window.location.href);\n      if (parsed.origin !== window.location.origin) {\n        return null;\n      }\n      return parsed;\n    } catch {\n      return null;\n    }\n  }\n\n  function resolveAssetFallback(rawUrl) {\n    const parsed = toSameOriginUrl(rawUrl);\n    if (!parsed) {\n      return null;\n    }\n\n    const next = new URL(parsed.toString());\n    const path = next.pathname;\n\n    if (/\\.min\\.js$/i.test(path)) {\n      next.pathname = path.replace(/\\.min\\.js$/i, \".js\");\n      return next.toString();\n    }\n\n    if (/\\.min\\.css$/i.test(path)) {\n      next.pathname = path.replace(/\\.min\\.css$/i, \".css\");\n      return next.toString();\n    }\n\n    return null;\n  }\n\n  function markAssetFallbackAttempt(target, originalUrl, fallbackUrl) {\n    const key = `${originalUrl}::${fallbackUrl}`;\n    if (assetFallbackAttempts.has(key)) {\n      return false;\n    }\n\n    assetFallbackAttempts.add(key);\n    target.setAttribute(\"data-asset-failed\", \"true\");\n    document.documentElement.classList.add(ASSET_FALLBACK_CLASS);\n    const currentCount = Number(document.documentElement.dataset.assetFallbackCount || \"0\");\n    document.documentElement.dataset.assetFallbackCount = String(currentCount + 1);\n    return true;\n  }\n\n  function injectScriptFallback(target, fallbackUrl) {\n    const script = document.createElement(\"script\");\n    script.src = fallbackUrl;\n    script.defer = !!target.defer;\n    script.async = !!target.async;\n    if (target.type) {\n      script.type = target.type;\n    }\n    if (target.crossOrigin) {\n      script.crossOrigin = target.crossOrigin;\n    }\n    if (target.referrerPolicy) {\n      script.referrerPolicy = target.referrerPolicy;\n    }\n    if (target.nonce) {\n      script.nonce = target.nonce;\n    }\n    script.setAttribute(\"data-asset-fallback\", \"true\");\n    script.setAttribute(\"data-asset-fallback-from\", target.src || \"\");\n    script.addEventListener(\n      \"error\",\n      () => {\n        document.documentElement.classList.add(ASSET_FALLBACK_FAILED_CLASS);\n      },\n      { once: true }\n    );\n    target.insertAdjacentElement(\"afterend\", script);\n  }\n\n  function injectStylesheetFallback(target, fallbackUrl) {\n    if ((target.rel || \"\").toLowerCase() !== \"stylesheet\") {\n      return;\n    }\n\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = fallbackUrl;\n    if (target.media) {\n      link.media = target.media;\n    }\n    if (target.crossOrigin) {\n      link.crossOrigin = target.crossOrigin;\n    }\n    if (target.referrerPolicy) {\n      link.referrerPolicy = target.referrerPolicy;\n    }\n    if (target.nonce) {\n      link.nonce = target.nonce;\n    }\n    link.setAttribute(\"data-asset-fallback\", \"true\");\n    link.setAttribute(\"data-asset-fallback-from\", target.href || \"\");\n    link.addEventListener(\n      \"error\",\n      () => {\n        document.documentElement.classList.add(ASSET_FALLBACK_FAILED_CLASS);\n      },\n      { once: true }\n    );\n    target.insertAdjacentElement(\"afterend\", link);\n  }\n\n  function installAssetFallbackResilience() {\n    window.addEventListener(\n      \"error\",\n      (event) => {\n        const target = event.target;\n        if (!target || target === window) {\n          return;\n        }\n\n        if (\n          typeof HTMLScriptElement !== \"undefined\" &&\n          target instanceof HTMLScriptElement\n        ) {\n          const originalUrl = target.src || \"\";\n          const fallbackUrl = resolveAssetFallback(originalUrl);\n          if (!fallbackUrl) {\n            return;\n          }\n\n          if (!markAssetFallbackAttempt(target, originalUrl, fallbackUrl)) {\n            return;\n          }\n\n          injectScriptFallback(target, fallbackUrl);\n          return;\n        }\n\n        if (\n          typeof HTMLLinkElement !== \"undefined\" &&\n          target instanceof HTMLLinkElement\n        ) {\n          const originalUrl = target.href || \"\";\n          const fallbackUrl = resolveAssetFallback(originalUrl);\n          if (!fallbackUrl) {\n            return;\n          }\n\n          if (!markAssetFallbackAttempt(target, originalUrl, fallbackUrl)) {\n            return;\n          }\n\n          injectStylesheetFallback(target, fallbackUrl);\n        }\n      },\n      true\n    );\n  }\n\n  installNetworkResilience();\n  installAssetFallbackResilience();\n\r\n  /**\r\n   * Apply theme and sync toggle + a11y attributes.\r\n   * @param {\"dark\"|\"light\"} theme\r\n   * @param {boolean} [showToast=false]\r\n   */\r\n  function applyTheme(theme, showToast) {\r\n    const isDark = theme === \"dark\";\r\n    const shouldShowToast = !!showToast;\r\n\r\n    document.body.classList.toggle(\"dark-mode\", isDark);\r\n    document.body.classList.toggle(\"light-mode\", !isDark);\r\n\r\n    // Optional: expose theme on <html> for CSS theming\r\n    document.documentElement.setAttribute(\"data-theme\", theme);\r\n\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle) {\r\n      toggle.checked = isDark;\r\n      toggle.setAttribute(\"aria-checked\", String(isDark));\r\n    }\r\n\r\n    if (\r\n      shouldShowToast &&\r\n      typeof window.langStrings.themeChanged === \"function\"\r\n    ) {\r\n      // themeChanged(theme) → localized message\r\n      const msg = window.langStrings.themeChanged(theme);\n      if (msg) {\n        createToast(msg, {\n          id: \"theme-toast\",\n          kind: \"info\",\n          customClass: \"theme-toast\",\n          duration: 1800,\n          position: \"top\",\n        });\n      }\n    }\r\n  }\r\n\r\n  // Initial theme: stored preference > system preference\r\n  if (savedTheme === \"dark\" || savedTheme === \"light\") {\r\n    applyTheme(savedTheme);\r\n  } else {\r\n    applyTheme(prefersDark ? \"dark\" : \"light\");\r\n  }\r\n\r\n  // React to OS theme changes only if user has not explicitly chosen a theme\r\n  if (darkMediaQuery) {\n    const handleThemeSystemChange = function (e) {\n      // If user later sets a theme, this check prevents overriding it\n      if (!readStoredTheme()) {\n        applyTheme(e.matches ? \"dark\" : \"light\");\n      }\n    };\n\r\n    if (typeof darkMediaQuery.addEventListener === \"function\") {\r\n      darkMediaQuery.addEventListener(\"change\", handleThemeSystemChange);\r\n    } else if (typeof darkMediaQuery.addListener === \"function\") {\r\n      // Older browsers\r\n      darkMediaQuery.addListener(handleThemeSystemChange);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize theme toggle (can be called multiple times safely).\r\n   */\r\n  function initThemeToggle() {\n    const themeToggleInput = document.getElementById(\"theme-toggle\");\n    if (!themeToggleInput) {return;}\n\r\n    // Avoid attaching listeners multiple times on dynamic includes\r\n    if (themeToggleInput.dataset.themeToggleInit === \"true\") {\r\n      return;\r\n    }\r\n    themeToggleInput.dataset.themeToggleInit = \"true\";\n\n    const currentTheme = document.documentElement.getAttribute(\"data-theme\");\n    if (currentTheme === \"dark\" || currentTheme === \"light\") {\n      themeToggleInput.checked = currentTheme === \"dark\";\n    }\n\n    // Sync ARIA\n    themeToggleInput.setAttribute(\n      \"aria-checked\",\n      String(!!themeToggleInput.checked)\n    );\n    themeToggleInput.setAttribute(\"role\", \"switch\");\r\n\r\n    // Change by click\r\n    themeToggleInput.addEventListener(\"change\", () => {\n      const newTheme = themeToggleInput.checked ? \"dark\" : \"light\";\n      applyTheme(newTheme, true);\n      try {\n        storage?.setItem(THEME_STORAGE_KEY, newTheme);\n      } catch (err) {\n        // Ignore storage failures (e.g., private mode)\n      }\n    });\r\n\r\n    // Keyboard accessibility (Space / Enter)\r\n    themeToggleInput.addEventListener(\"keydown\", (event) => {\r\n      if (event.key === \" \" || event.key === \"Enter\") {\r\n        event.preventDefault();\r\n        themeToggleInput.checked = !themeToggleInput.checked;\n        const newTheme = themeToggleInput.checked ? \"dark\" : \"light\";\n        applyTheme(newTheme, true);\n        try {\n          storage?.setItem(THEME_STORAGE_KEY, newTheme);\n        } catch (err) {}\n      }\n    });\n  }\r\n\r\n  // Init theme toggle on first load\r\n  initThemeToggle();\r\n  // Re-init if header/footer includes loaded dynamically\r\n  document.addEventListener(\"includesLoaded\", initThemeToggle, false);\r\n\r\n  // ---- End-of-page toast logic ----\r\n\r\n  let endOfPageShown = false;\r\n  let lastScrollY = 0;\r\n  let ticking = false;\r\n\r\n  function checkPageEnd() {\r\n    const scrollPosition = window.innerHeight + lastScrollY;\r\n    const docHeight =\r\n      Math.max(\r\n        document.body.scrollHeight,\r\n        document.documentElement.scrollHeight,\r\n        document.body.offsetHeight,\r\n        document.documentElement.offsetHeight\r\n      ) || 0;\r\n\r\n    // Reset flag if user scrolls back up (more than 100px from bottom)\r\n    if (scrollPosition < docHeight - 100) {\r\n      endOfPageShown = false;\r\n    }\r\n\r\n    if (!endOfPageShown && scrollPosition >= docHeight - 50 && docHeight > 0) {\r\n      endOfPageShown = true;\r\n      if (typeof window.langStrings.endOfPage === \"string\") {\n        createToast(window.langStrings.endOfPage, {\n          id: \"end-of-page-toast\",\n          kind: \"info\",\n          customClass: \"end-of-page-toast\",\n          duration: 3200,\n        });\n      } else if (typeof window.langStrings.endOfPage === \"function\") {\n        const msg = window.langStrings.endOfPage();\n        if (msg) {\n          createToast(msg, {\n            id: \"end-of-page-toast\",\n            kind: \"info\",\n            customClass: \"end-of-page-toast\",\n            duration: 3200,\n          });\n        }\n      }\n    }\r\n    ticking = false;\r\n  }\r\n\r\n  function updateProgressBar() {\r\n    const progressBar = document.getElementById(\"scroll-progress-bar\");\r\n    if (!progressBar) {return;}\r\n\r\n    const scrollTop =\r\n      window.scrollY || document.documentElement.scrollTop || 0;\r\n    const docHeight =\r\n      document.documentElement.scrollHeight -\r\n      document.documentElement.clientHeight;\r\n\r\n    if (docHeight <= 0) {\r\n      progressBar.style.width = \"0%\";\r\n      progressBar.setAttribute(\"aria-valuenow\", \"0\");\r\n      return;\r\n    }\r\n\r\n    const scrollPercent = (scrollTop / docHeight) * 100;\r\n    const clamped = Math.max(0, Math.min(100, scrollPercent));\r\n\r\n    progressBar.style.width = clamped + \"%\";\r\n    progressBar.setAttribute(\"aria-valuenow\", Math.round(clamped));\r\n  }\r\n\r\n  window.addEventListener(\r\n    \"scroll\",\r\n    () => {\r\n      lastScrollY = window.scrollY || window.pageYOffset || 0;\r\n      if (!ticking) {\r\n        window.requestAnimationFrame(() => {\r\n          checkPageEnd();\r\n          updateProgressBar();\r\n        });\r\n        ticking = true;\r\n      }\r\n    },\r\n    { passive: true }\r\n  );\r\n\r\n  // Footer year\r\n  const yearEl =\r\n    document.getElementById(\"current-year\") ||\r\n    document.getElementById(\"footer-year\");\r\n  if (yearEl) {\r\n    yearEl.textContent = new Date().getFullYear();\r\n  }\r\n\r\n  // Back to Top Button Logic\r\n  const backToTopBtn = document.getElementById(\"back-to-top\");\r\n  if (backToTopBtn) {\r\n    window.addEventListener(\r\n      \"scroll\",\r\n      () => {\r\n        if (window.scrollY > 300) {\r\n          backToTopBtn.classList.add(\"show\");\r\n        } else {\r\n          backToTopBtn.classList.remove(\"show\");\r\n        }\r\n      },\r\n      { passive: true }\r\n    );\r\n\r\n    backToTopBtn.addEventListener(\"click\", () => {\r\n      window.scrollTo({\r\n        top: 0,\r\n        behavior: prefersReducedMotion ? \"auto\" : \"smooth\",\r\n      });\r\n    });\r\n  }\r\n\r\n  function resolveCopyToastMessage(kind, subject = \"email\") {\n    const strings = window.langStrings || {};\n    const keyOrder = {\n      success:\n        subject === \"link\"\n          ? [\"linkCopied\", \"copySuccess\"]\n          : [\"copySuccess\", \"emailCopied\"],\n      error: [\"copyError\", \"emailCopyError\"],\n      unsupported: [\"copyUnsupported\", \"clipboardUnsupported\"],\n    };\n\r\n    const keys = keyOrder[kind] || [];\r\n    for (const key of keys) {\r\n      const value = strings[key];\r\n      if (typeof value === \"function\") {\r\n        const message = value();\r\n        if (typeof message === \"string\" && message.trim()) {return message;}\r\n      } else if (typeof value === \"string\" && value.trim()) {\r\n        return value;\r\n      }\r\n    }\r\n\r\n    const isFa = (document.documentElement.lang || \"\")\r\n      .toLowerCase()\r\n      .startsWith(\"fa\");\r\n\r\n    const fallback = {\n      success: isFa\n        ? subject === \"link\"\n          ? \"\\u0644\\u06cc\\u0646\\u06a9 \\u06a9\\u067e\\u06cc \\u0634\\u062f.\"\n          : \"\\u0627\\u06cc\\u0645\\u06cc\\u0644 \\u06a9\\u067e\\u06cc \\u0634\\u062f.\"\n        : subject === \"link\"\n          ? \"Link copied.\"\n          : \"Email copied.\",\n      error: isFa\n        ? \"\\u06a9\\u067e\\u06cc \\u0628\\u0627 \\u0645\\u0634\\u06a9\\u0644 \\u0645\\u0648\\u0627\\u062c\\u0647 \\u0634\\u062f.\"\n        : \"Copy failed.\",\n      unsupported: isFa\r\n        ? \"\\u0645\\u0631\\u0648\\u0631\\u06af\\u0631 \\u0634\\u0645\\u0627 \\u0627\\u0632 \\u06a9\\u067e\\u06cc \\u062e\\u0648\\u062f\\u06a9\\u0627\\u0631 \\u067e\\u0634\\u062a\\u06cc\\u0628\\u0627\\u0646\\u06cc \\u0646\\u0645\\u06cc\\u200c\\u06a9\\u0646\\u062f.\"\r\n        : \"Your browser does not support automatic copy.\",\r\n    };\r\n\r\n    return fallback[kind] || fallback.error;\n  }\n\n  function resolveShareToastMessage(kind) {\n    const strings = window.langStrings || {};\n    const keyOrder = {\n      success: [\"shareOk\", \"shareSuccess\"],\n      error: [\"shareErr\", \"shareError\"],\n    };\n    const keys = keyOrder[kind] || [];\n\n    for (const key of keys) {\n      const value = strings[key];\n      if (typeof value === \"function\") {\n        const message = value();\n        if (typeof message === \"string\" && message.trim()) {\n          return message;\n        }\n      } else if (typeof value === \"string\" && value.trim()) {\n        return value;\n      }\n    }\n\n    const isFa = (document.documentElement.lang || \"\")\n      .toLowerCase()\n      .startsWith(\"fa\");\n    const fallback = {\n      success: isFa\n        ? \"\\u0627\\u0634\\u062a\\u0631\\u0627\\u06a9\\u200c\\u06af\\u0630\\u0627\\u0631\\u06cc \\u0645\\u0648\\u0641\\u0642 \\u0628\\u0648\\u062f.\"\n        : \"Shared successfully.\",\n      error: isFa\n        ? \"\\u0627\\u0634\\u062a\\u0631\\u0627\\u06a9\\u200c\\u06af\\u0630\\u0627\\u0631\\u06cc \\u0628\\u0627 \\u0645\\u0634\\u06a9\\u0644 \\u0645\\u0648\\u0627\\u062c\\u0647 \\u0634\\u062f.\"\n        : \"Sharing failed.\",\n    };\n\n    return fallback[kind] || fallback.error;\n  }\n\n  function copyWithExecCommand(text) {\n    if (!document.body) {\n      return false;\n    }\n\n    const probe = document.createElement(\"textarea\");\n    probe.value = text;\n    probe.setAttribute(\"readonly\", \"\");\n    probe.setAttribute(\"aria-hidden\", \"true\");\n    probe.style.position = \"absolute\";\n    probe.style.left = \"-9999px\";\n    probe.style.top = \"0\";\n    document.body.appendChild(probe);\n    probe.select();\n\n    try {\n      return !!document.execCommand(\"copy\");\n    } catch {\n      return false;\n    } finally {\n      probe.remove();\n    }\n  }\n\n  async function copyText(text, options = {}) {\n    const allowExecCommand = options.allowExecCommand === true;\n\n    if (navigator.clipboard && navigator.clipboard.writeText) {\n      try {\n        await navigator.clipboard.writeText(text);\n        return { ok: true, mode: \"clipboard\" };\n      } catch {}\n    }\n\n    if (allowExecCommand && copyWithExecCommand(text)) {\n      return { ok: true, mode: \"exec-command\" };\n    }\n\n    return {\n      ok: false,\n      mode:\n        navigator.clipboard && navigator.clipboard.writeText\n          ? \"clipboard-failed\"\n          : \"unsupported\",\n    };\n  }\n\n  function emitToast(message, options) {\n    if (!message || typeof window.createToast !== \"function\") {\n      return;\n    }\n    window.createToast(message, options);\n  }\n\n  function showCopySuccessState(btn) {\n    const originalIcon = btn.innerHTML;\n    btn.innerHTML =\n      '<i class=\"fas fa-check\" aria-hidden=\"true\"></i>';\n    btn.classList.add(\"copied\");\n\n    setTimeout(() => {\n      btn.innerHTML = originalIcon;\n      btn.classList.remove(\"copied\");\n    }, 2000);\n  }\n\n  function bindCopyButton(btn) {\n    if (!(btn instanceof HTMLButtonElement)) {\n      return;\n    }\n    if (btn.dataset.toastCopyBound === \"true\") {\n      return;\n    }\n    btn.dataset.toastCopyBound = \"true\";\n\n    btn.addEventListener(\"click\", async (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      const textToCopy = btn.getAttribute(\"data-copy\");\n      if (!textToCopy) {\n        console.warn(\"No data-copy attribute found on .copy-btn\");\n        return;\n      }\n      const subject = textToCopy.includes(\"@\") ? \"email\" : \"link\";\n\n      const result = await copyText(textToCopy, {\n        allowExecCommand: false,\n      });\n      if (result.ok) {\n        showCopySuccessState(btn);\n        emitToast(resolveCopyToastMessage(\"success\", subject), {\n          id: \"copy-success-toast\",\n          kind: \"success\",\n          duration: 1800,\n        });\n        return;\n      }\n\n      const failedKind =\n        result.mode === \"unsupported\"\n          ? \"unsupported\"\n          : \"error\";\n      emitToast(resolveCopyToastMessage(failedKind), {\n        id:\n          failedKind === \"unsupported\"\n            ? \"copy-unsupported-toast\"\n            : \"copy-error-toast\",\n        kind: failedKind === \"unsupported\" ? \"info\" : \"error\",\n        duration: failedKind === \"unsupported\" ? 3000 : 2600,\n      });\n    });\n  }\n\n  function bindShareButton(btn) {\n    if (!(btn instanceof HTMLButtonElement)) {\n      return;\n    }\n    if (btn.dataset.toastShareBound === \"true\") {\n      return;\n    }\n    btn.dataset.toastShareBound = \"true\";\n\n    btn.addEventListener(\"click\", async (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      const shareUrl = btn.getAttribute(\"data-share\") || window.location.href;\n      if (!shareUrl) {\n        return;\n      }\n\n      if (typeof navigator.share === \"function\") {\n        try {\n          await navigator.share({\n            title: document.title,\n            url: shareUrl,\n          });\n          emitToast(resolveShareToastMessage(\"success\"), {\n            id: \"share-success-toast\",\n            kind: \"success\",\n            duration: 1800,\n          });\n          return;\n        } catch (err) {\n          if (err && err.name === \"AbortError\") {\n            return;\n          }\n        }\n      }\n\n      const copied = await copyText(shareUrl, {\n        allowExecCommand: true,\n      });\n      if (copied.ok) {\n        emitToast(resolveCopyToastMessage(\"success\", \"link\"), {\n          id: \"share-copy-toast\",\n          kind: \"success\",\n          duration: 2000,\n        });\n        return;\n      }\n\n      emitToast(resolveShareToastMessage(\"error\"), {\n        id: \"share-error-toast\",\n        kind: \"error\",\n        duration: 2800,\n      });\n    });\n  }\n\n  // Copy/share interactions (global + proof cards)\n  document.querySelectorAll(\".copy-btn\").forEach((btn) => {\n    bindCopyButton(btn);\n  });\n  document.querySelectorAll(\".share-btn\").forEach((btn) => {\n    bindShareButton(btn);\n  });\n\r\n  // ---- Neurodesign Enhancements Initialization ----\r\n\r\n  // 1. Scroll Progress Bar Logic is handled by updateProgressBar() and existing HTML\r\n\r\n  // 2. Ripple Effect for Buttons\n  document.addEventListener(\"click\", function (e) {\n    const origin = e.target;\n    if (!(origin instanceof Element)) {\n      return;\n    }\n\n    const target = origin.closest(\".btn, button, .cta-button, .hero-btn\");\n    if (target) {\n      const rect = target.getBoundingClientRect();\n      const x = e.clientX - rect.left;\n      const y = e.clientY - rect.top;\n\r\n      const ripple = document.createElement(\"span\");\r\n      ripple.className = \"ripple\";\r\n      ripple.style.left = `${x}px`;\r\n      ripple.style.top = `${y}px`;\r\n\r\n      target.appendChild(ripple);\r\n\r\n      setTimeout(() => {\r\n        ripple.remove();\r\n      }, 600);\r\n    }\r\n  });\r\n\r\n  // 3. Success Trigger Helper\r\n  window.triggerSuccess = function (element) {\r\n    if (!element) {return;}\r\n    element.classList.add(\"success-trigger\");\r\n    setTimeout(() => {\r\n      element.classList.remove(\"success-trigger\");\r\n    }, 300);\r\n  };\r\n\r\n})();\r\n"]}