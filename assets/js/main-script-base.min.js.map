{"version":3,"file":"main-script-base.min.js","names":["window","langStrings","storage","testKey","localStorage","setItem","removeItem","err","getSafeStorage","ASSET_FALLBACK_FAILED_CLASS","NETWORK_EVENT_NAME","assetFallbackAttempts","Set","lastNetworkToastAt","darkMediaQuery","matchMedia","prefersDark","matches","THEME_STORAGE_KEY","LEGACY_THEME_STORAGE_KEY","isValidTheme","value","readStoredTheme","storedTheme","getItem","legacyTheme","savedTheme","reduceMotionQuery","prefersReducedMotion","TOAST_EXIT_FALLBACK_MS","TOAST_STACK_SHIFTS_BOTTOM","TOAST_STACK_SHIFTS_TOP","TOAST_STACK_SCALE_LOSS","TOAST_KIND_ICONS","success","error","info","default","toastRegistry","Map","toastState","top","position","viewport","visible","queue","bottom","toastKeyboardShortcutsInstalled","normalizeToastOptions","optionsOrType","input","kind","safeKind","String","toLowerCase","normalizeToastKind","type","durationRaw","Number","duration","isFinite","Math","round","id","trim","customClass","iconClass","iconColor","closeButton","role","ariaLive","swipeDismiss","getToastState","ensureToastViewport","state","isConnected","selector","existing","document","querySelector","HTMLElement","body","createElement","className","dataset","toastPosition","setAttribute","appendChild","isSwipeEnabled","entry","setting","settings","touchCapable","navigator","maxTouchPoints","canUseToastSwipe","syncToastStack","Array","isArray","length","shifts","slice","reverse","forEach","index","toast","shift","min","scaleLoss","style","setProperty","removeEntry","collection","indexOf","splice","pruneToastState","filter","mounted","stopToastTimers","releaseToastInteractions","dismissing","get","delete","timer","clearTimeout","progressAnimation","cancel","lifecycleStartedAt","getEntryRemainingDuration","remainingDuration","max","pauseToastLifecycle","lifecyclePaused","baseDuration","elapsed","Date","now","resumeToastLifecycle","startToastLifecycle","useRemaining","installToastInteractions","interactionsInstalled","onPointerEnter","onPointerLeave","onFocusIn","onFocusOut","event","next","relatedTarget","Node","contains","onKeyDown","key","stopPropagation","dismissToastEntry","addEventListener","interactionsCleanup","removeEventListener","stopSwipeRebound","swipe","reboundTimer","resetSwipeState","classList","remove","releaseToastSwipe","cleanup","applyToastContent","classes","push","join","toastKind","tabIndex","removeAttribute","fragment","createDocumentFragment","icon","text","textContent","message","isFaLocale","documentElement","lang","startsWith","closeBtn","innerHTML","once","progress","replaceChildren","options","durationOverride","hidden","animate","transform","easing","fill","startToastProgress","setTimeout","mountToastEntry","lastMountedAt","pointerId","active","startX","startY","startAt","lastX","lastY","lastAt","onPointerDown","isPrimary","button","target","Element","closest","clientX","clientY","add","setPointerCapture","onPointerMove","dx","dy","abs","completeSwipe","velocity","absDx","absDy","direction","targetOffset","innerWidth","onPointerCancel","installToastSwipe","requestAnimationFrame","__ruToastFeedback","flushToastQueue","finalized","finalize","createToastEntry","console","warn","has","refreshVisibleToast","targetState","set","createToast","updateNetworkState","online","notify","isOnline","toggle","detail","timestamp","dispatchEvent","CustomEvent","createEvent","initCustomEvent","emitNetworkStatusEvent","strings","keyOrder","result","getNetworkMessage","resolveAssetFallback","rawUrl","parsed","URL","location","href","origin","toSameOriginUrl","toString","path","pathname","test","replace","markAssetFallbackAttempt","originalUrl","fallbackUrl","currentCount","assetFallbackCount","applyTheme","theme","showToast","isDark","shouldShowToast","getElementById","checked","themeChanged","msg","isContentEditable","tagName","topEntry","sort","a","b","onLine","HTMLScriptElement","src","script","defer","async","crossOrigin","referrerPolicy","nonce","insertAdjacentElement","injectScriptFallback","HTMLLinkElement","rel","link","media","injectStylesheetFallback","handleThemeSystemChange","e","addListener","initThemeToggle","themeToggleInput","themeToggleInit","currentTheme","getAttribute","newTheme","preventDefault","endOfPageShown","lastScrollY","ticking","scrollY","pageYOffset","scrollPosition","innerHeight","docHeight","scrollHeight","offsetHeight","endOfPage","checkPageEnd","progressBar","scrollTop","clientHeight","width","scrollPercent","clamped","updateProgressBar","passive","yearEl","getFullYear","backToTopBtn","resolveCopyToastMessage","subject","keys","unsupported","isFa","fallback","resolveShareToastMessage","copyText","allowExecCommand","clipboard","writeText","ok","mode","probe","left","select","execCommand","copyWithExecCommand","emitToast","bindCopyButton","btn","HTMLButtonElement","toastCopyBound","textToCopy","includes","originalIcon","showCopySuccessState","failedKind","scrollTo","behavior","querySelectorAll","toastShareBound","shareUrl","share","title","url","name","bindShareButton","rect","getBoundingClientRect","x","y","ripple","triggerSuccess","element"],"sources":["main-script-base.js"],"mappings":"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","ignoreList":[],"sourcesContent":["(function () {\r\n  \"use strict\";\r\n\r\n  // Ensure language strings object exists\r\n  if (!window.langStrings) {\r\n    window.langStrings = {};\r\n  }\r\n\r\n  /**\r\n   * Safe localStorage accessor with feature / privacy mode detection\r\n   */\r\n  function getSafeStorage() {\r\n    const testKey = \"__theme_pref__\";\r\n    try {\r\n      localStorage.setItem(testKey, testKey);\r\n      localStorage.removeItem(testKey);\r\n      return localStorage;\r\n    } catch (err) {\r\n      // e.g. Safari private mode or blocked storage\r\n      return null;\r\n    }\r\n  }\r\n\r\n  const storage = getSafeStorage();\n  const ASSET_FALLBACK_CLASS = \"asset-fallback-active\";\n  const ASSET_FALLBACK_FAILED_CLASS = \"asset-fallback-failed\";\n  const NETWORK_EVENT_NAME = \"ru:network-status\";\n  const assetFallbackAttempts = new Set();\n  let lastNetworkToastAt = 0;\n\r\n  // Reuse a single MediaQueryList if available\r\n  const darkMediaQuery = window.matchMedia\n    ? window.matchMedia(\"(prefers-color-scheme: dark)\")\n    : null;\n  const prefersDark = !!(darkMediaQuery && darkMediaQuery.matches);\n  const THEME_STORAGE_KEY = \"theme\";\n  const LEGACY_THEME_STORAGE_KEY = \"app:theme\";\n\n  function isValidTheme(value) {\n    return value === \"dark\" || value === \"light\";\n  }\n\n  function readStoredTheme() {\n    if (!storage) {return null;}\n\n    const storedTheme = storage.getItem(THEME_STORAGE_KEY);\n    if (isValidTheme(storedTheme)) {\n      return storedTheme;\n    }\n\n    const legacyTheme = storage.getItem(LEGACY_THEME_STORAGE_KEY);\n    if (!isValidTheme(legacyTheme)) {\n      return null;\n    }\n\n    // One-time migration from legacy key to canonical key.\n    try {\n      storage.setItem(THEME_STORAGE_KEY, legacyTheme);\n      storage.removeItem(LEGACY_THEME_STORAGE_KEY);\n    } catch (err) {\n      // Ignore storage failures in restricted environments.\n    }\n\n    return legacyTheme;\n  }\n\n  const savedTheme = readStoredTheme();\n\r\n  // Motion preference (for smooth scroll, etc.)\r\n  const reduceMotionQuery = window.matchMedia\r\n    ? window.matchMedia(\"(prefers-reduced-motion: reduce)\")\r\n    : null;\r\n  const prefersReducedMotion = !!(reduceMotionQuery && reduceMotionQuery.matches);\r\n\r\n  const TOAST_LIMIT_PER_POSITION = 3;\n  const TOAST_DEFAULT_DURATION = 2800;\n  const TOAST_EXIT_FALLBACK_MS = prefersReducedMotion ? 60 : 260;\n  const TOAST_STACK_SHIFTS_BOTTOM = [0, -3, -6];\n  const TOAST_STACK_SHIFTS_TOP = [0, 3, 6];\n  const TOAST_STACK_SCALE_LOSS = [0, 0.005, 0.01];\n  const TOAST_SWIPE_MIN_DISTANCE = 56;\n  const TOAST_SWIPE_MAX_CROSS_AXIS = 24;\n  const TOAST_SWIPE_MIN_VELOCITY = 0.35;\n  const TOAST_SWIPE_DISMISS_OFFSET_VW = 72;\n  const TOAST_KIND_ICONS = {\n    success: \"fas fa-check-circle\",\n    error: \"fas fa-exclamation-circle\",\n    info: \"fas fa-circle-info\",\n    default: \"fas fa-bell\",\n  };\n  const toastRegistry = new Map();\n  const toastState = {\n    top: {\n      position: \"top\",\n      viewport: null,\n      visible: [],\n      queue: [],\n    },\n    bottom: {\n      position: \"bottom\",\n      viewport: null,\n      visible: [],\n      queue: [],\n    },\n  };\n  let toastKeyboardShortcutsInstalled = false;\n\n  function normalizeToastKind(kind) {\n    const safeKind = String(kind || \"default\").toLowerCase();\n    if (safeKind === \"success\" || safeKind === \"error\" || safeKind === \"info\") {\n      return safeKind;\n    }\n    return \"default\";\n  }\n\n  function normalizeToastOptions(optionsOrType) {\n    const input =\n      typeof optionsOrType === \"string\"\n        ? { kind: optionsOrType }\n        : optionsOrType && typeof optionsOrType === \"object\"\n          ? optionsOrType\n          : {};\n\n    const kind = normalizeToastKind(input.kind || input.type);\n    const durationRaw = Number(input.duration);\n    const duration =\n      Number.isFinite(durationRaw) && durationRaw >= 0\n        ? Math.round(durationRaw)\n        : TOAST_DEFAULT_DURATION;\n    const id = typeof input.id === \"string\" ? input.id.trim() : \"\";\n    const position = input.position === \"top\" ? \"top\" : \"bottom\";\n    const customClass =\n      typeof input.customClass === \"string\" ? input.customClass.trim() : \"\";\n    const iconClass =\n      typeof input.iconClass === \"string\" && input.iconClass.trim()\n        ? input.iconClass.trim()\n        : TOAST_KIND_ICONS[kind];\n    const iconColor =\n      typeof input.iconColor === \"string\" ? input.iconColor.trim() : \"\";\n    const closeButton = !!input.closeButton;\n    const role =\n      typeof input.role === \"string\" && input.role.trim()\n        ? input.role.trim()\n        : kind === \"error\"\n          ? \"alert\"\n          : \"status\";\n    const ariaLive =\n      typeof input.ariaLive === \"string\" && input.ariaLive.trim()\n        ? input.ariaLive.trim()\n        : kind === \"error\"\n          ? \"assertive\"\n          : \"polite\";\n    const swipeDismiss =\n      input.swipeDismiss === true\n        ? true\n        : input.swipeDismiss === false\n          ? false\n          : \"auto\";\n\n    return {\n      id,\n      kind,\n      duration,\n      position,\n      customClass,\n      iconClass,\n      iconColor,\n      closeButton,\n      role,\n      ariaLive,\n      swipeDismiss,\n    };\n  }\n\n  function getToastState(position) {\n    return position === \"top\" ? toastState.top : toastState.bottom;\n  }\n\n  function ensureToastViewport(position) {\n    const state = getToastState(position);\n    if (state.viewport && state.viewport.isConnected) {\n      return state.viewport;\n    }\n\n    const selector = `.toast-viewport[data-toast-position=\"${position}\"]`;\n    const existing = document.querySelector(selector);\n    if (existing instanceof HTMLElement) {\n      state.viewport = existing;\n      return state.viewport;\n    }\n\n    if (!document.body) {\n      return null;\n    }\n\n    const viewport = document.createElement(\"div\");\n    viewport.className = \"toast-viewport\";\n    viewport.dataset.toastPosition = position;\n    viewport.setAttribute(\"aria-live\", \"off\");\n    document.body.appendChild(viewport);\n    state.viewport = viewport;\n    return viewport;\n  }\n\n  function canUseToastSwipe() {\n    const touchCapable =\n      (typeof navigator.maxTouchPoints === \"number\" && navigator.maxTouchPoints > 0) ||\n      \"ontouchstart\" in window;\n\n    if (typeof window.matchMedia !== \"function\") {\n      return touchCapable;\n    }\n    try {\n      return window.matchMedia(\"(pointer: coarse)\").matches || touchCapable;\n    } catch {\n      return touchCapable;\n    }\n  }\n\n  function isSwipeEnabled(entry) {\n    const setting = entry && entry.settings ? entry.settings.swipeDismiss : \"auto\";\n    if (setting === false) {\n      return false;\n    }\n    if (setting === true) {\n      return true;\n    }\n    return canUseToastSwipe();\n  }\n\n  function syncToastStack(state) {\n    if (!state || !Array.isArray(state.visible) || state.visible.length === 0) {\n      return;\n    }\n\n    const shifts =\n      state.position === \"top\" ? TOAST_STACK_SHIFTS_TOP : TOAST_STACK_SHIFTS_BOTTOM;\n\n    // The newest visible toast gets the front-most stack values.\n    const ordered = state.visible.slice().reverse();\n    ordered.forEach((entry, index) => {\n      if (!entry || !(entry.toast instanceof HTMLElement)) {\n        return;\n      }\n\n      const shift = shifts[Math.min(index, shifts.length - 1)];\n      const scaleLoss =\n        TOAST_STACK_SCALE_LOSS[Math.min(index, TOAST_STACK_SCALE_LOSS.length - 1)];\n      entry.toast.style.setProperty(\"--toast-stack-shift\", `${shift}px`);\n      entry.toast.style.setProperty(\"--toast-stack-scale-loss\", String(scaleLoss));\n      entry.toast.style.setProperty(\"--toast-z\", String(300 - index));\n    });\n  }\n\n  function removeEntry(collection, entry) {\n    const index = collection.indexOf(entry);\n    if (index >= 0) {\n      collection.splice(index, 1);\n    }\n  }\n\n  function pruneToastState(state) {\n    state.visible = state.visible.filter((entry) => {\n      if (!entry || !(entry.toast instanceof HTMLElement)) {\n        return false;\n      }\n      if (entry.toast.isConnected && entry.mounted) {\n        return true;\n      }\n\n      stopToastTimers(entry);\n      releaseToastInteractions(entry);\n      entry.mounted = false;\n      entry.dismissing = false;\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      return false;\n    });\n\n    state.queue = state.queue.filter((entry) => !!entry && !entry.dismissing);\n  }\n\n  function stopToastTimers(entry) {\n    if (entry.timer) {\n      clearTimeout(entry.timer);\n      entry.timer = null;\n    }\n    if (entry.progressAnimation) {\n      try {\n        entry.progressAnimation.cancel();\n      } catch {}\n      entry.progressAnimation = null;\n    }\n    entry.lifecycleStartedAt = 0;\n  }\n\n  function getEntryRemainingDuration(entry) {\n    if (!entry || !entry.settings || entry.settings.duration <= 0) {\n      return 0;\n    }\n    if (!Number.isFinite(entry.remainingDuration)) {\n      return entry.settings.duration;\n    }\n    return Math.max(0, Math.round(entry.remainingDuration));\n  }\n\n  function pauseToastLifecycle(entry) {\n    if (\n      !entry ||\n      !entry.settings ||\n      entry.settings.duration <= 0 ||\n      entry.lifecyclePaused\n    ) {\n      return;\n    }\n\n    const baseDuration = getEntryRemainingDuration(entry);\n    if (entry.lifecycleStartedAt > 0) {\n      const elapsed = Math.max(0, Date.now() - entry.lifecycleStartedAt);\n      entry.remainingDuration = Math.max(0, baseDuration - elapsed);\n    } else {\n      entry.remainingDuration = baseDuration;\n    }\n\n    entry.lifecyclePaused = true;\n    stopToastTimers(entry);\n  }\n\n  function resumeToastLifecycle(entry) {\n    if (\n      !entry ||\n      !entry.settings ||\n      entry.settings.duration <= 0 ||\n      !entry.lifecyclePaused\n    ) {\n      return;\n    }\n\n    entry.lifecyclePaused = false;\n    startToastLifecycle(entry, { useRemaining: true });\n  }\n\n  function installToastInteractions(entry) {\n    if (\n      !entry ||\n      !(entry.toast instanceof HTMLElement) ||\n      entry.interactionsInstalled\n    ) {\n      return;\n    }\n\n    const toast = entry.toast;\n    const onPointerEnter = () => {\n      pauseToastLifecycle(entry);\n    };\n    const onPointerLeave = () => {\n      resumeToastLifecycle(entry);\n    };\n    const onFocusIn = () => {\n      pauseToastLifecycle(entry);\n    };\n    const onFocusOut = (event) => {\n      const next = event.relatedTarget;\n      if (next instanceof Node && toast.contains(next)) {\n        return;\n      }\n      resumeToastLifecycle(entry);\n    };\n    const onKeyDown = (event) => {\n      if (event.key !== \"Escape\") {\n        return;\n      }\n      event.stopPropagation();\n      dismissToastEntry(entry);\n    };\n\n    toast.addEventListener(\"pointerenter\", onPointerEnter);\n    toast.addEventListener(\"pointerleave\", onPointerLeave);\n    toast.addEventListener(\"focusin\", onFocusIn);\n    toast.addEventListener(\"focusout\", onFocusOut);\n    toast.addEventListener(\"keydown\", onKeyDown);\n\n    entry.interactionsInstalled = true;\n    entry.interactionsCleanup = () => {\n      toast.removeEventListener(\"pointerenter\", onPointerEnter);\n      toast.removeEventListener(\"pointerleave\", onPointerLeave);\n      toast.removeEventListener(\"focusin\", onFocusIn);\n      toast.removeEventListener(\"focusout\", onFocusOut);\n      toast.removeEventListener(\"keydown\", onKeyDown);\n      entry.interactionsInstalled = false;\n    };\n  }\n\n  function releaseToastInteractions(entry) {\n    if (!entry || typeof entry.interactionsCleanup !== \"function\") {\n      if (entry) {\n        entry.interactionsInstalled = false;\n      }\n      return;\n    }\n    entry.interactionsCleanup();\n    entry.interactionsCleanup = null;\n    entry.interactionsInstalled = false;\n  }\n\n  function getMostRecentVisibleToastEntry() {\n    const visible = [...toastState.top.visible, ...toastState.bottom.visible]\n      .filter(\n        (entry) =>\n          !!entry &&\n          !!entry.mounted &&\n          !!entry.toast &&\n          entry.toast.isConnected &&\n          !entry.dismissing\n      )\n      .sort((a, b) => (b.lastMountedAt || 0) - (a.lastMountedAt || 0));\n\n    return visible[0] || null;\n  }\n\n  function installToastKeyboardShortcuts() {\n    if (toastKeyboardShortcutsInstalled || !document) {\n      return;\n    }\n    toastKeyboardShortcutsInstalled = true;\n\n    document.addEventListener(\"keydown\", (event) => {\n      if (event.key !== \"Escape\") {\n        return;\n      }\n\n      const target = event.target;\n      if (\n        target instanceof HTMLElement &&\n        (target.isContentEditable ||\n          target.tagName === \"INPUT\" ||\n          target.tagName === \"TEXTAREA\" ||\n          target.tagName === \"SELECT\")\n      ) {\n        return;\n      }\n\n      const topEntry = getMostRecentVisibleToastEntry();\n      if (!topEntry) {\n        return;\n      }\n\n      event.stopPropagation();\n      dismissToastEntry(topEntry);\n    });\n  }\n\n  function stopSwipeRebound(entry) {\n    if (entry && entry.swipe && entry.swipe.reboundTimer) {\n      clearTimeout(entry.swipe.reboundTimer);\n      entry.swipe.reboundTimer = null;\n    }\n  }\n\n  function resetSwipeState(entry) {\n    if (!entry || !(entry.toast instanceof HTMLElement)) {\n      return;\n    }\n\n    stopSwipeRebound(entry);\n    entry.toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n    entry.toast.classList.remove(\"is-swiping\", \"swipe-dismiss\", \"swipe-rebound\");\n  }\n\n  function releaseToastSwipe(entry) {\n    if (!entry || !entry.swipe || typeof entry.swipe.cleanup !== \"function\") {\n      return;\n    }\n    entry.swipe.cleanup();\n    entry.swipe.cleanup = null;\n  }\n\n  function installToastSwipe(entry) {\n    if (\n      !entry ||\n      !(entry.toast instanceof HTMLElement) ||\n      !isSwipeEnabled(entry) ||\n      (entry.swipe && typeof entry.swipe.cleanup === \"function\")\n    ) {\n      return;\n    }\n\n    const toast = entry.toast;\n    const state = {\n      pointerId: null,\n      active: false,\n      startX: 0,\n      startY: 0,\n      startAt: 0,\n      lastX: 0,\n      lastY: 0,\n      lastAt: 0,\n      reboundTimer: null,\n      cleanup: null,\n    };\n    entry.swipe = state;\n\n    const onPointerDown = (event) => {\n      if (entry.dismissing || event.isPrimary === false || event.button > 0) {\n        return;\n      }\n      if (event.target instanceof Element && event.target.closest(\".toast-close\")) {\n        return;\n      }\n\n      state.pointerId = event.pointerId;\n      state.active = true;\n      state.startX = event.clientX;\n      state.startY = event.clientY;\n      state.startAt = Date.now();\n      state.lastX = event.clientX;\n      state.lastY = event.clientY;\n      state.lastAt = state.startAt;\n      stopSwipeRebound(entry);\n      toast.classList.add(\"is-swiping\");\n      toast.classList.remove(\"swipe-rebound\", \"swipe-dismiss\");\n      pauseToastLifecycle(entry);\n\n      if (typeof toast.setPointerCapture === \"function\") {\n        try {\n          toast.setPointerCapture(event.pointerId);\n        } catch {}\n      }\n    };\n\n    const onPointerMove = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n\n      const dx = event.clientX - state.startX;\n      const dy = event.clientY - state.startY;\n      state.lastX = event.clientX;\n      state.lastY = event.clientY;\n      state.lastAt = Date.now();\n\n      if (Math.abs(dy) > TOAST_SWIPE_MAX_CROSS_AXIS * 1.6) {\n        return;\n      }\n\n      toast.style.setProperty(\"--toast-swipe-x\", `${dx}px`);\n    };\n\n    const completeSwipe = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n\n      state.active = false;\n      const dx = state.lastX - state.startX;\n      const dy = state.lastY - state.startY;\n      const elapsed = Math.max(1, state.lastAt - state.startAt);\n      const velocity = Math.abs(dx) / elapsed;\n      const absDx = Math.abs(dx);\n      const absDy = Math.abs(dy);\n      const validSwipe =\n        absDx >= TOAST_SWIPE_MIN_DISTANCE &&\n        absDy <= TOAST_SWIPE_MAX_CROSS_AXIS &&\n        velocity >= TOAST_SWIPE_MIN_VELOCITY;\n\n      if (validSwipe) {\n        toast.classList.remove(\"is-swiping\", \"swipe-rebound\");\n        toast.classList.add(\"swipe-dismiss\");\n        const direction = dx >= 0 ? 1 : -1;\n        const targetOffset = Math.round((window.innerWidth * TOAST_SWIPE_DISMISS_OFFSET_VW) / 100);\n        toast.style.setProperty(\"--toast-swipe-x\", `${direction * targetOffset}px`);\n\n        if (prefersReducedMotion) {\n          dismissToastEntry(entry);\n          return;\n        }\n\n        setTimeout(() => {\n          dismissToastEntry(entry);\n        }, 110);\n        return;\n      }\n\n      toast.classList.remove(\"is-swiping\", \"swipe-dismiss\");\n      toast.classList.add(\"swipe-rebound\");\n      toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n      state.reboundTimer = setTimeout(() => {\n        toast.classList.remove(\"swipe-rebound\");\n        state.reboundTimer = null;\n      }, prefersReducedMotion ? 1 : 220);\n      resumeToastLifecycle(entry);\n    };\n\n    const onPointerCancel = (event) => {\n      if (!state.active || event.pointerId !== state.pointerId) {\n        return;\n      }\n      state.active = false;\n      toast.classList.remove(\"is-swiping\", \"swipe-dismiss\");\n      toast.classList.add(\"swipe-rebound\");\n      toast.style.setProperty(\"--toast-swipe-x\", \"0px\");\n      state.reboundTimer = setTimeout(() => {\n        toast.classList.remove(\"swipe-rebound\");\n        state.reboundTimer = null;\n      }, prefersReducedMotion ? 1 : 220);\n      resumeToastLifecycle(entry);\n    };\n\n    toast.addEventListener(\"pointerdown\", onPointerDown);\n    toast.addEventListener(\"pointermove\", onPointerMove);\n    toast.addEventListener(\"pointerup\", completeSwipe);\n    toast.addEventListener(\"pointercancel\", onPointerCancel);\n    toast.addEventListener(\"lostpointercapture\", onPointerCancel);\n\n    state.cleanup = () => {\n      toast.removeEventListener(\"pointerdown\", onPointerDown);\n      toast.removeEventListener(\"pointermove\", onPointerMove);\n      toast.removeEventListener(\"pointerup\", completeSwipe);\n      toast.removeEventListener(\"pointercancel\", onPointerCancel);\n      toast.removeEventListener(\"lostpointercapture\", onPointerCancel);\n      stopSwipeRebound(entry);\n      if (entry && entry.swipe) {\n        entry.swipe.active = false;\n      }\n    };\n  }\n\n  function applyToastContent(entry) {\n    const { settings, toast } = entry;\n    const classes = [\"dynamic-toast\", `toast-kind-${settings.kind}`];\n    if (settings.customClass) {\n      classes.push(settings.customClass);\n    }\n    toast.className = classes.join(\" \");\n    toast.dataset.toastKind = settings.kind;\n    toast.dataset.toastPosition = settings.position;\n    toast.setAttribute(\"role\", settings.role);\n    toast.setAttribute(\"aria-live\", settings.ariaLive);\n    toast.setAttribute(\"aria-atomic\", \"true\");\n    toast.tabIndex = -1;\n    if (settings.id) {\n      toast.id = settings.id;\n    } else {\n      toast.removeAttribute(\"id\");\n    }\n\n    const fragment = document.createDocumentFragment();\n    if (settings.iconClass) {\n      const icon = document.createElement(\"i\");\n      icon.className = `${settings.iconClass} toast-icon`.trim();\n      if (settings.iconColor) {\n        icon.dataset.iconColor = settings.iconColor;\n      }\n      icon.setAttribute(\"aria-hidden\", \"true\");\n      fragment.appendChild(icon);\n    }\n\n    const text = document.createElement(\"span\");\n    text.className = \"toast-message\";\n    text.textContent = entry.message;\n    fragment.appendChild(text);\n\n    if (settings.closeButton) {\n      const isFaLocale = (document.documentElement.lang || \"\")\n        .toLowerCase()\n        .startsWith(\"fa\");\n      const closeBtn = document.createElement(\"button\");\n      closeBtn.type = \"button\";\n      closeBtn.className = \"toast-close\";\n      closeBtn.setAttribute(\n        \"aria-label\",\n        isFaLocale ? \"بستن پیام\" : \"Close message\"\n      );\n      closeBtn.innerHTML = '<i class=\"fas fa-times\" aria-hidden=\"true\"></i>';\n      closeBtn.addEventListener(\n        \"click\",\n        () => dismissToastEntry(entry),\n        { once: true }\n      );\n      fragment.appendChild(closeBtn);\n    }\n\n    const progress = document.createElement(\"span\");\n    progress.className = \"toast-progress\";\n    progress.setAttribute(\"aria-hidden\", \"true\");\n    fragment.appendChild(progress);\n\n    toast.replaceChildren(fragment);\n  }\n\n  function startToastProgress(entry, durationOverride) {\n    const progress = entry.toast.querySelector(\".toast-progress\");\n    if (!(progress instanceof HTMLElement)) {\n      return;\n    }\n\n    const duration =\n      Number.isFinite(durationOverride) && durationOverride >= 0\n        ? Math.round(durationOverride)\n        : entry.settings.duration;\n    progress.hidden = duration <= 0;\n    if (prefersReducedMotion || duration <= 0) {\n      return;\n    }\n\n    if (typeof progress.animate !== \"function\") {\n      return;\n    }\n\n    try {\n      entry.progressAnimation = progress.animate(\n        [\n          { transform: \"scaleX(1)\" },\n          { transform: \"scaleX(0)\" },\n        ],\n        {\n          duration,\n          easing: \"linear\",\n          fill: \"forwards\",\n        }\n      );\n    } catch {}\n  }\n\n  function startToastLifecycle(entry, options = {}) {\n    const useRemaining = !!options.useRemaining;\n    stopToastTimers(entry);\n    const duration =\n      entry.settings.duration > 0\n        ? useRemaining\n          ? getEntryRemainingDuration(entry)\n          : entry.settings.duration\n        : 0;\n    entry.remainingDuration = duration;\n    entry.lifecycleStartedAt = duration > 0 ? Date.now() : 0;\n    startToastProgress(entry, duration);\n\n    if (duration > 0) {\n      entry.timer = setTimeout(() => {\n        dismissToastEntry(entry);\n      }, duration);\n    }\n  }\n\n  function refreshVisibleToast(entry) {\n    if (!entry.mounted || !entry.toast) {\n      return;\n    }\n\n    entry.dismissing = false;\n    entry.lifecyclePaused = false;\n    entry.remainingDuration = entry.settings.duration;\n    entry.lifecycleStartedAt = 0;\n    entry.lastMountedAt = Date.now();\n    resetSwipeState(entry);\n    applyToastContent(entry);\n    entry.toast.classList.add(\"show\");\n    entry.toast.classList.remove(\"is-closing\");\n    installToastInteractions(entry);\n    startToastLifecycle(entry);\n    syncToastStack(entry.state || getToastState(entry.settings.position));\n  }\n\n  function mountToastEntry(entry) {\n    const state = entry.state || getToastState(entry.settings.position);\n    const viewport = ensureToastViewport(state.position);\n    if (!viewport) {\n      return;\n    }\n\n    entry.state = state;\n    entry.mounted = true;\n    entry.dismissing = false;\n    entry.lifecyclePaused = false;\n    entry.remainingDuration = entry.settings.duration;\n    entry.lifecycleStartedAt = 0;\n    entry.lastMountedAt = Date.now();\n    resetSwipeState(entry);\n    applyToastContent(entry);\n    viewport.appendChild(entry.toast);\n    state.visible.push(entry);\n    syncToastStack(state);\n    installToastSwipe(entry);\n    installToastInteractions(entry);\n\n    requestAnimationFrame(() => {\n      if (!entry.mounted) {\n        return;\n      }\n\n      entry.toast.classList.add(\"show\");\n      startToastLifecycle(entry);\n\n      if (typeof window.__ruToastFeedback === \"function\") {\n        try {\n          window.__ruToastFeedback();\n        } catch {}\n      }\n    });\n  }\n\n  function flushToastQueue(position) {\n    const state = getToastState(position);\n    ensureToastViewport(position);\n    pruneToastState(state);\n\n    while (\n      state.visible.length < TOAST_LIMIT_PER_POSITION &&\n      state.queue.length > 0\n    ) {\n      const next = state.queue.shift();\n      if (!next) {\n        continue;\n      }\n\n      if (next.dismissing) {\n        continue;\n      }\n\n      mountToastEntry(next);\n    }\n    syncToastStack(state);\n  }\n\n  function dismissToastEntry(entry) {\n    if (!entry || entry.dismissing) {\n      return;\n    }\n\n    entry.dismissing = true;\n    stopToastTimers(entry);\n    stopSwipeRebound(entry);\n\n    if (!entry.mounted || !(entry.toast instanceof HTMLElement)) {\n      const queuedState = entry.state || getToastState(entry.settings.position);\n      removeEntry(queuedState.queue, entry);\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      releaseToastSwipe(entry);\n      releaseToastInteractions(entry);\n      entry.dismissing = false;\n      return;\n    }\n\n    const { toast } = entry;\n    toast.classList.remove(\"show\");\n    toast.classList.add(\"is-closing\");\n\n    let finalized = false;\n    const finalize = () => {\n      if (finalized) {\n        return;\n      }\n      finalized = true;\n\n      const state = entry.state || getToastState(entry.settings.position);\n      removeEntry(state.visible, entry);\n      removeEntry(state.queue, entry);\n      if (entry.settings.id && toastRegistry.get(entry.settings.id) === entry) {\n        toastRegistry.delete(entry.settings.id);\n      }\n      releaseToastSwipe(entry);\n      releaseToastInteractions(entry);\n      toast.remove();\n      entry.mounted = false;\n      entry.dismissing = false;\n      flushToastQueue(state.position);\n      syncToastStack(state);\n    };\n\n    toast.addEventListener(\n      \"transitionend\",\n      (event) => {\n        if (event.target === toast) {\n          finalize();\n        }\n      },\n      { once: true }\n    );\n    setTimeout(finalize, TOAST_EXIT_FALLBACK_MS);\n  }\n\n  function createToastEntry(message, optionsOrType) {\n    if (!message && message !== 0) {\n      return null;\n    }\n    if (!document.body) {\n      console.warn(\"Cannot show toast: document.body not ready\");\n      return null;\n    }\n\n    const settings = normalizeToastOptions(optionsOrType);\n    const text = String(message);\n\n    pruneToastState(toastState.top);\n    pruneToastState(toastState.bottom);\n\n    if (settings.id && toastRegistry.has(settings.id)) {\n      const entry = toastRegistry.get(settings.id);\n      entry.message = text;\n      entry.settings = {\n        ...entry.settings,\n        ...settings,\n        position: entry.mounted ? entry.settings.position : settings.position,\n      };\n\n      if (entry.mounted) {\n        refreshVisibleToast(entry);\n        return entry;\n      }\n\n      const targetState = getToastState(entry.settings.position);\n      removeEntry(toastState.top.queue, entry);\n      removeEntry(toastState.bottom.queue, entry);\n      entry.state = targetState;\n      targetState.queue.push(entry);\n      flushToastQueue(targetState.position);\n      return entry;\n    }\n\n    const entry = {\n      message: text,\n      settings,\n      state: getToastState(settings.position),\n      toast: document.createElement(\"div\"),\n      timer: null,\n      progressAnimation: null,\n      dismissing: false,\n      mounted: false,\n      swipe: null,\n      remainingDuration: settings.duration,\n      lifecycleStartedAt: 0,\n      lifecyclePaused: false,\n      interactionsInstalled: false,\n      interactionsCleanup: null,\n      lastMountedAt: 0,\n    };\n\n    if (settings.id) {\n      toastRegistry.set(settings.id, entry);\n    }\n\n    entry.state.queue.push(entry);\n    flushToastQueue(entry.state.position);\n    return entry;\n  }\n\n  /**\n   * Unified toast API.\n   * Backward compatible signatures:\n   *  - createToast(message, \"success\"|\"error\"|\"info\"|\"default\")\n   *  - createToast(message, options)\n   */\n  function createToast(message, optionsOrType) {\n    const entry = createToastEntry(message, optionsOrType);\n    return entry ? entry.toast : null;\n  }\n\n  // Expose the unified toast API globally.\n  window.createToast = createToast;\n  installToastKeyboardShortcuts();\n\n  function getNetworkMessage(online) {\n    const strings = window.langStrings || {};\n    const keyOrder = online\n      ? [\"backOnline\", \"online\", \"connectionRestored\"]\n      : [\"offline\", \"connectionLost\"];\n\n    for (const key of keyOrder) {\n      const value = strings[key];\n      if (typeof value === \"function\") {\n        const result = value();\n        if (typeof result === \"string\" && result.trim()) {\n          return result;\n        }\n      } else if (typeof value === \"string\" && value.trim()) {\n        return value;\n      }\n    }\n\n    return online\n      ? \"Connection restored.\"\n      : \"You are offline. Some features may be unavailable.\";\n  }\n\n  function emitNetworkStatusEvent(online) {\n    const detail = { online, timestamp: Date.now() };\n    try {\n      window.dispatchEvent(\n        new CustomEvent(NETWORK_EVENT_NAME, {\n          detail,\n        })\n      );\n    } catch (err) {\n      // CustomEvent fallback for old browsers.\n      try {\n        const event = document.createEvent(\"CustomEvent\");\n        event.initCustomEvent(NETWORK_EVENT_NAME, false, false, detail);\n        window.dispatchEvent(event);\n      } catch {}\n    }\n  }\n\n  function updateNetworkState(online, notify) {\n    const isOnline = !!online;\n\n    document.documentElement.classList.toggle(\"online\", isOnline);\n    document.documentElement.classList.toggle(\"offline\", !isOnline);\n    document.documentElement.setAttribute(\"data-network-status\", isOnline ? \"online\" : \"offline\");\n\n    if (document.body) {\n      document.body.classList.toggle(\"online\", isOnline);\n      document.body.classList.toggle(\"offline\", !isOnline);\n    }\n\n    emitNetworkStatusEvent(isOnline);\n\n    if (!notify || typeof window.createToast !== \"function\") {\n      return;\n    }\n\n    const now = Date.now();\n    if (now - lastNetworkToastAt < 1200) {\n      return;\n    }\n    lastNetworkToastAt = now;\n    window.createToast(getNetworkMessage(isOnline), {\n      id: \"network-status-toast\",\n      kind: isOnline ? \"success\" : \"info\",\n      duration: 2600,\n    });\n  }\n\n  function installNetworkResilience() {\n    const initialOnline = navigator.onLine !== false;\n    updateNetworkState(initialOnline, false);\n    window.addEventListener(\"online\", () => updateNetworkState(true, true));\n    window.addEventListener(\"offline\", () => updateNetworkState(false, true));\n  }\n\n  function toSameOriginUrl(rawUrl) {\n    if (!rawUrl) {\n      return null;\n    }\n\n    try {\n      const parsed = new URL(rawUrl, window.location.href);\n      if (parsed.origin !== window.location.origin) {\n        return null;\n      }\n      return parsed;\n    } catch {\n      return null;\n    }\n  }\n\n  function resolveAssetFallback(rawUrl) {\n    const parsed = toSameOriginUrl(rawUrl);\n    if (!parsed) {\n      return null;\n    }\n\n    const next = new URL(parsed.toString());\n    const path = next.pathname;\n\n    if (/\\.min\\.js$/i.test(path)) {\n      next.pathname = path.replace(/\\.min\\.js$/i, \".js\");\n      return next.toString();\n    }\n\n    if (/\\.min\\.css$/i.test(path)) {\n      next.pathname = path.replace(/\\.min\\.css$/i, \".css\");\n      return next.toString();\n    }\n\n    return null;\n  }\n\n  function markAssetFallbackAttempt(target, originalUrl, fallbackUrl) {\n    const key = `${originalUrl}::${fallbackUrl}`;\n    if (assetFallbackAttempts.has(key)) {\n      return false;\n    }\n\n    assetFallbackAttempts.add(key);\n    target.setAttribute(\"data-asset-failed\", \"true\");\n    document.documentElement.classList.add(ASSET_FALLBACK_CLASS);\n    const currentCount = Number(document.documentElement.dataset.assetFallbackCount || \"0\");\n    document.documentElement.dataset.assetFallbackCount = String(currentCount + 1);\n    return true;\n  }\n\n  function injectScriptFallback(target, fallbackUrl) {\n    const script = document.createElement(\"script\");\n    script.src = fallbackUrl;\n    script.defer = !!target.defer;\n    script.async = !!target.async;\n    if (target.type) {\n      script.type = target.type;\n    }\n    if (target.crossOrigin) {\n      script.crossOrigin = target.crossOrigin;\n    }\n    if (target.referrerPolicy) {\n      script.referrerPolicy = target.referrerPolicy;\n    }\n    if (target.nonce) {\n      script.nonce = target.nonce;\n    }\n    script.setAttribute(\"data-asset-fallback\", \"true\");\n    script.setAttribute(\"data-asset-fallback-from\", target.src || \"\");\n    script.addEventListener(\n      \"error\",\n      () => {\n        document.documentElement.classList.add(ASSET_FALLBACK_FAILED_CLASS);\n      },\n      { once: true }\n    );\n    target.insertAdjacentElement(\"afterend\", script);\n  }\n\n  function injectStylesheetFallback(target, fallbackUrl) {\n    if ((target.rel || \"\").toLowerCase() !== \"stylesheet\") {\n      return;\n    }\n\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = fallbackUrl;\n    if (target.media) {\n      link.media = target.media;\n    }\n    if (target.crossOrigin) {\n      link.crossOrigin = target.crossOrigin;\n    }\n    if (target.referrerPolicy) {\n      link.referrerPolicy = target.referrerPolicy;\n    }\n    if (target.nonce) {\n      link.nonce = target.nonce;\n    }\n    link.setAttribute(\"data-asset-fallback\", \"true\");\n    link.setAttribute(\"data-asset-fallback-from\", target.href || \"\");\n    link.addEventListener(\n      \"error\",\n      () => {\n        document.documentElement.classList.add(ASSET_FALLBACK_FAILED_CLASS);\n      },\n      { once: true }\n    );\n    target.insertAdjacentElement(\"afterend\", link);\n  }\n\n  function installAssetFallbackResilience() {\n    window.addEventListener(\n      \"error\",\n      (event) => {\n        const target = event.target;\n        if (!target || target === window) {\n          return;\n        }\n\n        if (\n          typeof HTMLScriptElement !== \"undefined\" &&\n          target instanceof HTMLScriptElement\n        ) {\n          const originalUrl = target.src || \"\";\n          const fallbackUrl = resolveAssetFallback(originalUrl);\n          if (!fallbackUrl) {\n            return;\n          }\n\n          if (!markAssetFallbackAttempt(target, originalUrl, fallbackUrl)) {\n            return;\n          }\n\n          injectScriptFallback(target, fallbackUrl);\n          return;\n        }\n\n        if (\n          typeof HTMLLinkElement !== \"undefined\" &&\n          target instanceof HTMLLinkElement\n        ) {\n          const originalUrl = target.href || \"\";\n          const fallbackUrl = resolveAssetFallback(originalUrl);\n          if (!fallbackUrl) {\n            return;\n          }\n\n          if (!markAssetFallbackAttempt(target, originalUrl, fallbackUrl)) {\n            return;\n          }\n\n          injectStylesheetFallback(target, fallbackUrl);\n        }\n      },\n      true\n    );\n  }\n\n  installNetworkResilience();\n  installAssetFallbackResilience();\n\r\n  /**\r\n   * Apply theme and sync toggle + a11y attributes.\r\n   * @param {\"dark\"|\"light\"} theme\r\n   * @param {boolean} [showToast=false]\r\n   */\r\n  function applyTheme(theme, showToast) {\r\n    const isDark = theme === \"dark\";\r\n    const shouldShowToast = !!showToast;\r\n\r\n    document.body.classList.toggle(\"dark-mode\", isDark);\r\n    document.body.classList.toggle(\"light-mode\", !isDark);\r\n\r\n    // Optional: expose theme on <html> for CSS theming\r\n    document.documentElement.setAttribute(\"data-theme\", theme);\r\n\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle) {\r\n      toggle.checked = isDark;\r\n      toggle.setAttribute(\"aria-checked\", String(isDark));\r\n    }\r\n\r\n    if (\r\n      shouldShowToast &&\r\n      typeof window.langStrings.themeChanged === \"function\"\r\n    ) {\r\n      // themeChanged(theme) → localized message\r\n      const msg = window.langStrings.themeChanged(theme);\n      if (msg) {\n        createToast(msg, {\n          id: \"theme-change-toast\",\n          kind: \"info\",\n          customClass: \"theme-toast\",\n          duration: 1800,\n          position: \"top\",\n        });\n      }\n    }\r\n  }\r\n\r\n  // Initial theme: stored preference > system preference\r\n  if (savedTheme === \"dark\" || savedTheme === \"light\") {\r\n    applyTheme(savedTheme);\r\n  } else {\r\n    applyTheme(prefersDark ? \"dark\" : \"light\");\r\n  }\r\n\r\n  // React to OS theme changes only if user has not explicitly chosen a theme\r\n  if (darkMediaQuery) {\n    const handleThemeSystemChange = function (e) {\n      // If user later sets a theme, this check prevents overriding it\n      if (!readStoredTheme()) {\n        applyTheme(e.matches ? \"dark\" : \"light\");\n      }\n    };\n\r\n    if (typeof darkMediaQuery.addEventListener === \"function\") {\r\n      darkMediaQuery.addEventListener(\"change\", handleThemeSystemChange);\r\n    } else if (typeof darkMediaQuery.addListener === \"function\") {\r\n      // Older browsers\r\n      darkMediaQuery.addListener(handleThemeSystemChange);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize theme toggle (can be called multiple times safely).\r\n   */\r\n  function initThemeToggle() {\n    const themeToggleInput = document.getElementById(\"theme-toggle\");\n    if (!themeToggleInput) {return;}\n\r\n    // Avoid attaching listeners multiple times on dynamic includes\r\n    if (themeToggleInput.dataset.themeToggleInit === \"true\") {\r\n      return;\r\n    }\r\n    themeToggleInput.dataset.themeToggleInit = \"true\";\n\n    const currentTheme = document.documentElement.getAttribute(\"data-theme\");\n    if (currentTheme === \"dark\" || currentTheme === \"light\") {\n      themeToggleInput.checked = currentTheme === \"dark\";\n    }\n\n    // Sync ARIA\n    themeToggleInput.setAttribute(\n      \"aria-checked\",\n      String(!!themeToggleInput.checked)\n    );\n    themeToggleInput.setAttribute(\"role\", \"switch\");\r\n\r\n    // Change by click\r\n    themeToggleInput.addEventListener(\"change\", () => {\n      const newTheme = themeToggleInput.checked ? \"dark\" : \"light\";\n      applyTheme(newTheme, true);\n      try {\n        storage?.setItem(THEME_STORAGE_KEY, newTheme);\n      } catch (err) {\n        // Ignore storage failures (e.g., private mode)\n      }\n    });\r\n\r\n    // Keyboard accessibility (Space / Enter)\r\n    themeToggleInput.addEventListener(\"keydown\", (event) => {\r\n      if (event.key === \" \" || event.key === \"Enter\") {\r\n        event.preventDefault();\r\n        themeToggleInput.checked = !themeToggleInput.checked;\n        const newTheme = themeToggleInput.checked ? \"dark\" : \"light\";\n        applyTheme(newTheme, true);\n        try {\n          storage?.setItem(THEME_STORAGE_KEY, newTheme);\n        } catch (err) {}\n      }\n    });\n  }\r\n\r\n  // Init theme toggle on first load\r\n  initThemeToggle();\r\n  // Re-init if header/footer includes loaded dynamically\r\n  document.addEventListener(\"includesLoaded\", initThemeToggle, false);\r\n\r\n  // ---- End-of-page toast logic ----\r\n\r\n  let endOfPageShown = false;\r\n  let lastScrollY = 0;\r\n  let ticking = false;\r\n\r\n  function checkPageEnd() {\r\n    const scrollPosition = window.innerHeight + lastScrollY;\r\n    const docHeight =\r\n      Math.max(\r\n        document.body.scrollHeight,\r\n        document.documentElement.scrollHeight,\r\n        document.body.offsetHeight,\r\n        document.documentElement.offsetHeight\r\n      ) || 0;\r\n\r\n    // Reset flag if user scrolls back up (more than 100px from bottom)\r\n    if (scrollPosition < docHeight - 100) {\r\n      endOfPageShown = false;\r\n    }\r\n\r\n    if (!endOfPageShown && scrollPosition >= docHeight - 50 && docHeight > 0) {\r\n      endOfPageShown = true;\r\n      if (typeof window.langStrings.endOfPage === \"string\") {\n        createToast(window.langStrings.endOfPage, {\n          id: \"end-of-page-toast\",\n          kind: \"info\",\n          customClass: \"end-of-page-toast\",\n          duration: 3200,\n        });\n      } else if (typeof window.langStrings.endOfPage === \"function\") {\n        const msg = window.langStrings.endOfPage();\n        if (msg) {\n          createToast(msg, {\n            id: \"end-of-page-toast\",\n            kind: \"info\",\n            customClass: \"end-of-page-toast\",\n            duration: 3200,\n          });\n        }\n      }\n    }\r\n    ticking = false;\r\n  }\r\n\r\n  function updateProgressBar() {\r\n    const progressBar = document.getElementById(\"scroll-progress-bar\");\r\n    if (!progressBar) {return;}\r\n\r\n    const scrollTop =\r\n      window.scrollY || document.documentElement.scrollTop || 0;\r\n    const docHeight =\r\n      document.documentElement.scrollHeight -\r\n      document.documentElement.clientHeight;\r\n\r\n    if (docHeight <= 0) {\r\n      progressBar.style.width = \"0%\";\r\n      progressBar.setAttribute(\"aria-valuenow\", \"0\");\r\n      return;\r\n    }\r\n\r\n    const scrollPercent = (scrollTop / docHeight) * 100;\r\n    const clamped = Math.max(0, Math.min(100, scrollPercent));\r\n\r\n    progressBar.style.width = clamped + \"%\";\r\n    progressBar.setAttribute(\"aria-valuenow\", Math.round(clamped));\r\n  }\r\n\r\n  window.addEventListener(\r\n    \"scroll\",\r\n    () => {\r\n      lastScrollY = window.scrollY || window.pageYOffset || 0;\r\n      if (!ticking) {\r\n        window.requestAnimationFrame(() => {\r\n          checkPageEnd();\r\n          updateProgressBar();\r\n        });\r\n        ticking = true;\r\n      }\r\n    },\r\n    { passive: true }\r\n  );\r\n\r\n  // Footer year\r\n  const yearEl =\r\n    document.getElementById(\"current-year\") ||\r\n    document.getElementById(\"footer-year\");\r\n  if (yearEl) {\r\n    yearEl.textContent = new Date().getFullYear();\r\n  }\r\n\r\n  // Back to Top Button Logic\r\n  const backToTopBtn = document.getElementById(\"back-to-top\");\r\n  if (backToTopBtn) {\r\n    window.addEventListener(\r\n      \"scroll\",\r\n      () => {\r\n        if (window.scrollY > 300) {\r\n          backToTopBtn.classList.add(\"show\");\r\n        } else {\r\n          backToTopBtn.classList.remove(\"show\");\r\n        }\r\n      },\r\n      { passive: true }\r\n    );\r\n\r\n    backToTopBtn.addEventListener(\"click\", () => {\r\n      window.scrollTo({\r\n        top: 0,\r\n        behavior: prefersReducedMotion ? \"auto\" : \"smooth\",\r\n      });\r\n    });\r\n  }\r\n\r\n  function resolveCopyToastMessage(kind, subject = \"email\") {\n    const strings = window.langStrings || {};\n    const keyOrder = {\n      success:\n        subject === \"link\"\n          ? [\"linkCopied\", \"copySuccess\"]\n          : [\"copySuccess\", \"emailCopied\"],\n      error: [\"copyError\", \"emailCopyError\"],\n      unsupported: [\"copyUnsupported\", \"clipboardUnsupported\"],\n    };\n\r\n    const keys = keyOrder[kind] || [];\r\n    for (const key of keys) {\r\n      const value = strings[key];\r\n      if (typeof value === \"function\") {\r\n        const message = value();\r\n        if (typeof message === \"string\" && message.trim()) {return message;}\r\n      } else if (typeof value === \"string\" && value.trim()) {\r\n        return value;\r\n      }\r\n    }\r\n\r\n    const isFa = (document.documentElement.lang || \"\")\r\n      .toLowerCase()\r\n      .startsWith(\"fa\");\r\n\r\n    const fallback = {\n      success: isFa\n        ? subject === \"link\"\n          ? \"\\u0644\\u06cc\\u0646\\u06a9 \\u06a9\\u067e\\u06cc \\u0634\\u062f.\"\n          : \"\\u0627\\u06cc\\u0645\\u06cc\\u0644 \\u06a9\\u067e\\u06cc \\u0634\\u062f.\"\n        : subject === \"link\"\n          ? \"Link copied.\"\n          : \"Email copied.\",\n      error: isFa\n        ? \"\\u06a9\\u067e\\u06cc \\u0628\\u0627 \\u0645\\u0634\\u06a9\\u0644 \\u0645\\u0648\\u0627\\u062c\\u0647 \\u0634\\u062f.\"\n        : \"Copy failed.\",\n      unsupported: isFa\r\n        ? \"\\u0645\\u0631\\u0648\\u0631\\u06af\\u0631 \\u0634\\u0645\\u0627 \\u0627\\u0632 \\u06a9\\u067e\\u06cc \\u062e\\u0648\\u062f\\u06a9\\u0627\\u0631 \\u067e\\u0634\\u062a\\u06cc\\u0628\\u0627\\u0646\\u06cc \\u0646\\u0645\\u06cc\\u200c\\u06a9\\u0646\\u062f.\"\r\n        : \"Your browser does not support automatic copy.\",\r\n    };\r\n\r\n    return fallback[kind] || fallback.error;\n  }\n\n  function resolveShareToastMessage(kind) {\n    const strings = window.langStrings || {};\n    const keyOrder = {\n      success: [\"shareOk\", \"shareSuccess\"],\n      error: [\"shareErr\", \"shareError\"],\n    };\n    const keys = keyOrder[kind] || [];\n\n    for (const key of keys) {\n      const value = strings[key];\n      if (typeof value === \"function\") {\n        const message = value();\n        if (typeof message === \"string\" && message.trim()) {\n          return message;\n        }\n      } else if (typeof value === \"string\" && value.trim()) {\n        return value;\n      }\n    }\n\n    const isFa = (document.documentElement.lang || \"\")\n      .toLowerCase()\n      .startsWith(\"fa\");\n    const fallback = {\n      success: isFa\n        ? \"\\u0627\\u0634\\u062a\\u0631\\u0627\\u06a9\\u200c\\u06af\\u0630\\u0627\\u0631\\u06cc \\u0645\\u0648\\u0641\\u0642 \\u0628\\u0648\\u062f.\"\n        : \"Shared successfully.\",\n      error: isFa\n        ? \"\\u0627\\u0634\\u062a\\u0631\\u0627\\u06a9\\u200c\\u06af\\u0630\\u0627\\u0631\\u06cc \\u0628\\u0627 \\u0645\\u0634\\u06a9\\u0644 \\u0645\\u0648\\u0627\\u062c\\u0647 \\u0634\\u062f.\"\n        : \"Sharing failed.\",\n    };\n\n    return fallback[kind] || fallback.error;\n  }\n\n  function copyWithExecCommand(text) {\n    if (!document.body) {\n      return false;\n    }\n\n    const probe = document.createElement(\"textarea\");\n    probe.value = text;\n    probe.setAttribute(\"readonly\", \"\");\n    probe.setAttribute(\"aria-hidden\", \"true\");\n    probe.style.position = \"absolute\";\n    probe.style.left = \"-9999px\";\n    probe.style.top = \"0\";\n    document.body.appendChild(probe);\n    probe.select();\n\n    try {\n      return !!document.execCommand(\"copy\");\n    } catch {\n      return false;\n    } finally {\n      probe.remove();\n    }\n  }\n\n  async function copyText(text, options = {}) {\n    const allowExecCommand = options.allowExecCommand === true;\n\n    if (navigator.clipboard && navigator.clipboard.writeText) {\n      try {\n        await navigator.clipboard.writeText(text);\n        return { ok: true, mode: \"clipboard\" };\n      } catch {}\n    }\n\n    if (allowExecCommand && copyWithExecCommand(text)) {\n      return { ok: true, mode: \"exec-command\" };\n    }\n\n    return {\n      ok: false,\n      mode:\n        navigator.clipboard && navigator.clipboard.writeText\n          ? \"clipboard-failed\"\n          : \"unsupported\",\n    };\n  }\n\n  function emitToast(message, options) {\n    if (!message || typeof window.createToast !== \"function\") {\n      return;\n    }\n    window.createToast(message, options);\n  }\n\n  function showCopySuccessState(btn) {\n    const originalIcon = btn.innerHTML;\n    btn.innerHTML =\n      '<i class=\"fas fa-check\" aria-hidden=\"true\"></i>';\n    btn.classList.add(\"copied\");\n\n    setTimeout(() => {\n      btn.innerHTML = originalIcon;\n      btn.classList.remove(\"copied\");\n    }, 2000);\n  }\n\n  function bindCopyButton(btn) {\n    if (!(btn instanceof HTMLButtonElement)) {\n      return;\n    }\n    if (btn.dataset.toastCopyBound === \"true\") {\n      return;\n    }\n    btn.dataset.toastCopyBound = \"true\";\n\n    btn.addEventListener(\"click\", async (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      const textToCopy = btn.getAttribute(\"data-copy\");\n      if (!textToCopy) {\n        console.warn(\"No data-copy attribute found on .copy-btn\");\n        return;\n      }\n      const subject = textToCopy.includes(\"@\") ? \"email\" : \"link\";\n\n      const result = await copyText(textToCopy, {\n        allowExecCommand: false,\n      });\n      if (result.ok) {\n        showCopySuccessState(btn);\n        emitToast(resolveCopyToastMessage(\"success\", subject), {\n          id: \"copy-success-toast\",\n          kind: \"success\",\n          duration: 1800,\n        });\n        return;\n      }\n\n      const failedKind =\n        result.mode === \"unsupported\"\n          ? \"unsupported\"\n          : \"error\";\n      emitToast(resolveCopyToastMessage(failedKind), {\n        id:\n          failedKind === \"unsupported\"\n            ? \"copy-unsupported-toast\"\n            : \"copy-error-toast\",\n        kind: failedKind === \"unsupported\" ? \"info\" : \"error\",\n        duration: failedKind === \"unsupported\" ? 3000 : 2600,\n      });\n    });\n  }\n\n  function bindShareButton(btn) {\n    if (!(btn instanceof HTMLButtonElement)) {\n      return;\n    }\n    if (btn.dataset.toastShareBound === \"true\") {\n      return;\n    }\n    btn.dataset.toastShareBound = \"true\";\n\n    btn.addEventListener(\"click\", async (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      const shareUrl = btn.getAttribute(\"data-share\") || window.location.href;\n      if (!shareUrl) {\n        return;\n      }\n\n      if (typeof navigator.share === \"function\") {\n        try {\n          await navigator.share({\n            title: document.title,\n            url: shareUrl,\n          });\n          emitToast(resolveShareToastMessage(\"success\"), {\n            id: \"share-success-toast\",\n            kind: \"success\",\n            duration: 1800,\n          });\n          return;\n        } catch (err) {\n          if (err && err.name === \"AbortError\") {\n            return;\n          }\n        }\n      }\n\n      const copied = await copyText(shareUrl, {\n        allowExecCommand: true,\n      });\n      if (copied.ok) {\n        emitToast(resolveCopyToastMessage(\"success\", \"link\"), {\n          id: \"share-copy-toast\",\n          kind: \"success\",\n          duration: 2000,\n        });\n        return;\n      }\n\n      emitToast(resolveShareToastMessage(\"error\"), {\n        id: \"share-error-toast\",\n        kind: \"error\",\n        duration: 2800,\n      });\n    });\n  }\n\n  // Copy/share interactions (global + proof cards)\n  document.querySelectorAll(\".copy-btn\").forEach((btn) => {\n    bindCopyButton(btn);\n  });\n  document.querySelectorAll(\".share-btn\").forEach((btn) => {\n    bindShareButton(btn);\n  });\n\r\n  // ---- Neurodesign Enhancements Initialization ----\r\n\r\n  // 1. Scroll Progress Bar Logic is handled by updateProgressBar() and existing HTML\r\n\r\n  // 2. Ripple Effect for Buttons\n  document.addEventListener(\"click\", function (e) {\n    const origin = e.target;\n    if (!(origin instanceof Element)) {\n      return;\n    }\n\n    const target = origin.closest(\".btn, button, .cta-button, .hero-btn\");\n    if (target) {\n      const rect = target.getBoundingClientRect();\n      const x = e.clientX - rect.left;\n      const y = e.clientY - rect.top;\n\r\n      const ripple = document.createElement(\"span\");\r\n      ripple.className = \"ripple\";\r\n      ripple.style.left = `${x}px`;\r\n      ripple.style.top = `${y}px`;\r\n\r\n      target.appendChild(ripple);\r\n\r\n      setTimeout(() => {\r\n        ripple.remove();\r\n      }, 600);\r\n    }\r\n  });\r\n\r\n  // 3. Success Trigger Helper\r\n  window.triggerSuccess = function (element) {\r\n    if (!element) {return;}\r\n    element.classList.add(\"success-trigger\");\r\n    setTimeout(() => {\r\n      element.classList.remove(\"success-trigger\");\r\n    }, 300);\r\n  };\r\n\r\n})();\r\n"]}