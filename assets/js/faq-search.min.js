!function(){"use strict";function e(){"function"!=typeof window.createToast&&(window.createToast=function(e){const t=document.createElement("div");t.className="toast-notification",t.textContent=e,t.style.cssText="\n          position: fixed;\n          bottom: 20px;\n          left: 50%;\n          transform: translateX(-50%);\n          background: rgba(0,0,0,0.8);\n          color: white;\n          padding: 10px 20px;\n          border-radius: 20px;\n          z-index: 10000;\n          opacity: 0;\n          transition: opacity 0.3s;\n          font-family: inherit;\n          font-size: 0.9rem;\n        ",document.body.appendChild(t),requestAnimationFrame(()=>t.style.opacity="1"),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>t.remove(),300)},3e3)});const e=e=>(e||"").normalize("NFC").replace(/[ي]/g,"ی").replace(/[ك]/g,"ک").replace(/[\u064B-\u065F\u0670]/g,"").replace(/‌/g,"").toLowerCase(),t=document.getElementById("faq-search"),a=document.getElementById("clear-search"),o=Array.from(document.querySelectorAll(".faq-item")),n=document.getElementById("expand-all-faq"),s=document.getElementById("collapse-all-faq");if(!t||!a||!o.length)return;t._faqSearchAbortController&&t._faqSearchAbortController.abort();const r=new AbortController;t._faqSearchAbortController=r;r.signal;let c,i=document.getElementById("faq-search-status");function l(t,a){if(!t)return;if(t.querySelectorAll(".highlight-term").forEach(e=>{const t=e.parentNode;t.replaceChild(document.createTextNode(e.textContent),e),t.normalize()}),!a)return;const o=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),n=[],s=e(a).split("").map(e=>{const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return"ی"===e?"[یي]":"ک"===e?"[کك]":t}).join("[\\u064B-\\u065F\\u0670\\u200c\\u200d]*"),r=new RegExp(`(${s})`,"i");for(;o.nextNode();){const e=o.currentNode;e.parentNode.classList.contains("highlight-term")||e.nodeValue&&r.test(e.nodeValue)&&n.push(e)}n.forEach(e=>{const t=document.createDocumentFragment();e.nodeValue.split(r).forEach((e,a)=>{if(a%2==1){const a=document.createElement("span");a.className="highlight-term",a.textContent=e,t.appendChild(a)}else e&&t.appendChild(document.createTextNode(e))}),e.parentNode.replaceChild(t,e)})}function d(n){const s=void 0!==n?n:t.value,r=e(s),c=r.length>0;let d=0;o.forEach(t=>{const a=t.querySelector(".accordion-header h3")||t.querySelector("summary"),o=t.querySelector(".accordion-content")||t.querySelector(".faq-answer"),n=!t.tagName||"details"!==t.tagName.toLowerCase(),s=a?e(a.textContent):"",i=o?e(o.textContent):"",u=e(t.dataset.keywords||"");if(!c||s.includes(r)||i.includes(r)||u.includes(r)){if(t.hidden=!1,t.style.display="",d++,a&&l(a,c?r:null),o&&l(o,c?r:null),c)if(n){if(!t.classList.contains("is-open")){t.classList.add("is-open");const e=t.querySelector(".accordion-header");e&&e.setAttribute("aria-expanded","true"),t.dataset.openedBySearch="true",o&&(o.style.maxHeight=o.scrollHeight+50+"px",o.style.opacity="1")}}else t.open||(t.open=!0,t.dataset.openedBySearch="true");if(!c&&t.dataset.openedBySearch){if(n){t.classList.remove("is-open");const e=t.querySelector(".accordion-header");e&&e.setAttribute("aria-expanded","false"),o&&(o.style.maxHeight=null,o.style.opacity="0")}else t.open=!1;delete t.dataset.openedBySearch}}else t.hidden=!0,t.style.display="none"});const u=document.getElementById("faq-no-results");u&&(u.style.display=0===d?"block":"none"),a.style.display=c?"block":"none",function(e,t){const a=o.length,n=e.trim();i.textContent=n?0===t?`نتیجه‌ای برای «${n}» یافت نشد.`:`${t} نتیجه برای «${n}» پیدا شد.`:`نمایش همه ${a} سوال.`}(r,d)}if(i||(i=document.createElement("div"),i.id="faq-search-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),i.className="faq-search-status sr-only",(t.closest("form")||t.parentNode).appendChild(i)),a.getAttribute("aria-label")||a.setAttribute("aria-label","پاک کردن جستجو"),t.addEventListener("input",function(){clearTimeout(c),c=setTimeout(()=>d(),300)},{signal:r.signal}),t.addEventListener("keydown",e=>{"Escape"===e.key&&(e.preventDefault(),t.value="",d(),t.focus())},{signal:r.signal}),a.addEventListener("click",function(){t.value="",d(),t.focus()},{signal:r.signal}),n&&n.addEventListener("click",()=>{o.forEach(e=>{if(e.hidden||"none"===e.style.display)return;if(!e.tagName||"details"!==e.tagName.toLowerCase()){e.classList.add("is-open");const t=e.querySelector(".accordion-header"),a=e.querySelector(".accordion-content");t&&t.setAttribute("aria-expanded","true"),a&&(a.style.maxHeight=a.scrollHeight+500+"px",a.style.opacity="1")}else e.open=!0}),n.setAttribute("aria-pressed","true"),s&&s.setAttribute("aria-pressed","false")},{signal:r.signal}),s&&s.addEventListener("click",()=>{o.forEach(e=>{if(e.hidden||"none"===e.style.display)return;if(!e.tagName||"details"!==e.tagName.toLowerCase()){e.classList.remove("is-open");const t=e.querySelector(".accordion-header"),a=e.querySelector(".accordion-content");t&&t.setAttribute("aria-expanded","false"),a&&(a.style.maxHeight=null,a.style.opacity="0")}else e.open=!1}),s.setAttribute("aria-pressed","true"),n&&n.setAttribute("aria-pressed","false")},{signal:r.signal}),document.querySelectorAll(".copy-faq-link").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const a=e.dataset.link;if(!a)return;const o=window.location.origin+window.location.pathname+a;navigator.clipboard.writeText(o).then(()=>{const t=e.innerHTML,a=e.className;e.innerHTML="";const o=document.createElement("i");o.className="fas fa-check",o.setAttribute("aria-hidden","true"),e.appendChild(o),e.style.color="#2ecc71",e.classList.add("copied"),window.createToast&&window.createToast("لینک کپی شد!"),setTimeout(()=>{e.innerHTML=t,e.className=a,e.style.color=""},2e3)}).catch(e=>{console.error("Failed to copy: ",e)})},{signal:r.signal})}),document.querySelectorAll(".faq-item").forEach(e=>{const t=e.id,a=localStorage.getItem(`faq-feedback-${t}`);if(a){const t=e.querySelector(`.btn-feedback.${a}`);t&&t.classList.add("active")}}),document.querySelectorAll(".btn-feedback").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const a=e.closest(".faq-feedback"),o=e.closest(".faq-item").id;a.querySelectorAll(".btn-feedback").forEach(e=>e.classList.remove("active")),e.classList.add("active");const n=e.classList.contains("up");localStorage.setItem(`faq-feedback-${o}`,n?"up":"down");const s=a.querySelector(".feedback-label");if(s){const t="آیا این پاسخ مفید بود؟";s.textContent="بازخورد شما ثبت شد. ممنون!",s.style.color="#27ae60",s.style.fontWeight="bold",setTimeout(()=>{s.textContent=t,s.style.color="",s.style.fontWeight="",e.classList.remove("active")},3e3)}const r=e.closest(".faq-item").id;console.log(`Feedback for ${r}: ${n?"Positive":"Negative"}`),window.createToast&&window.createToast("بازخورد شما ثبت شد. ممنون!")},{signal:r.signal})}),window.location.hash){const e=window.location.hash.substring(1),t=document.getElementById(e);t&&t.classList.contains("faq-item")&&setTimeout(()=>{if(!t.tagName||"details"!==t.tagName.toLowerCase()){t.classList.add("is-open");const e=t.querySelector(".accordion-header"),a=t.querySelector(".accordion-content");e&&e.setAttribute("aria-expanded","true"),a&&(a.style.maxHeight=a.scrollHeight+500+"px",a.style.opacity="1")}else t.open=!0;t.scrollIntoView({behavior:"smooth",block:"center"}),t.style.transition="background-color 0.5s";const e=t.style.backgroundColor;t.style.backgroundColor="rgba(52, 152, 219, 0.1)",setTimeout(()=>{t.style.backgroundColor=e},1500)},500)}}document.addEventListener("DOMContentLoaded",e),document.addEventListener("includesLoaded",e)}();
//# sourceMappingURL=faq-search.min.js.map
