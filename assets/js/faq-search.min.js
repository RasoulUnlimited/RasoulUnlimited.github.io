!function(){"use strict";document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("faq");if(!e)return;"function"!=typeof window.createToast&&(window.createToast=function(e){const t=document.createElement("div");t.className="toast-notification",t.textContent=e,t.style.cssText="\n          position: fixed;\n          bottom: 20px;\n          left: 50%;\n          transform: translateX(-50%);\n          background: rgba(0,0,0,0.8);\n          color: white;\n          padding: 10px 20px;\n          border-radius: 20px;\n          z-index: 10000;\n          opacity: 0;\n          transition: opacity 0.3s;\n          font-family: inherit;\n          font-size: 0.9rem;\n        ",document.body.appendChild(t),requestAnimationFrame(()=>{t.style.opacity="1"}),setTimeout(()=>{t.style.opacity="0",setTimeout(()=>{t.remove()},300)},3e3)});const t=e=>(e||"").normalize("NFC").replace(/[ي]/g,"ی").replace(/[ك]/g,"ک").replace(/[\u064B-\u065F\u0670]/g,"").replace(/[\u200c\u200d]/g,"").toLowerCase(),n=e.querySelector("#faq-search"),a=e.querySelector("#clear-search"),o=Array.from(e.querySelectorAll(".faq-item")),i=e.querySelector("#expand-all-faq"),r=e.querySelector("#collapse-all-faq"),c=e.querySelector("#faq-no-results"),s=e.querySelector("#faq-container.accordion")||e.querySelector(".faq-container.accordion");if(!n||!a||!o.length)return;s&&!s.hasAttribute("data-allow-multiple")&&s.setAttribute("data-allow-multiple","true");let l,d=e.querySelector("#faq-search-status");function u(e){return!e.hidden&&"none"!==e.style.display}function f(e){if(window.Accordion&&s&&e.id){if(window.Accordion.open(s,e.id))return}e.classList.add("is-open");const t=e.querySelector(".accordion-header");t&&t.setAttribute("aria-expanded","true")}function p(e){if(window.Accordion&&s&&e.id){if(window.Accordion.close(s,e.id))return}e.classList.remove("is-open");const t=e.querySelector(".accordion-header");t&&t.setAttribute("aria-expanded","false")}function h(e,n){if(!e)return;if(function(e){e&&e.querySelectorAll(".highlight-term").forEach(e=>{const t=e.parentNode;t&&(t.replaceChild(document.createTextNode(e.textContent||""),e),t.normalize())})}(e),!n)return;const a=t(n);if(!a)return;const o=a.split("").map(e=>{const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return"ی"===e?"[یي]":"ک"===e?"[کك]":t}).join("[\\u064B-\\u065F\\u0670\\u200c\\u200d]*"),i=new RegExp(`(${o})`,"i"),r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),c=[];for(;r.nextNode();){const e=r.currentNode,t=e.parentNode;t&&e.nodeValue&&(t.classList&&t.classList.contains("highlight-term")||i.test(e.nodeValue)&&c.push(e))}c.forEach(e=>{const t=document.createDocumentFragment();e.nodeValue.split(i).forEach((e,n)=>{if(e)if(n%2==1){const n=document.createElement("span");n.className="highlight-term",n.textContent=e,t.appendChild(n)}else t.appendChild(document.createTextNode(e))}),e.parentNode&&e.parentNode.replaceChild(t,e)})}function y(e){const i=void 0!==e?e:n.value,r=t(i),l=r.length>0;let u=0;o.forEach(e=>{const n=e.querySelector(".accordion-header .faq-question")||e.querySelector(".faq-question"),a=e.querySelector(".accordion-content")||e.querySelector(".faq-answer"),o=n?t(n.textContent):"",i=a?t(a.textContent):"",c=t(e.dataset.keywords||"");!l||o.includes(r)||i.includes(r)||c.includes(r)?(e.hidden=!1,e.style.display="",u+=1,h(n,l?r:null),h(a,l?r:null),l&&!function(e){if(window.Accordion&&s&&e.id){const t=window.Accordion.isOpen(s,e.id);if("boolean"==typeof t)return t}const t=e.querySelector(".accordion-header");return e.classList.contains("is-open")||t&&"true"===t.getAttribute("aria-expanded")}(e)&&(f(e),e.dataset.openedBySearch="true"),!l&&e.dataset.openedBySearch&&(p(e),delete e.dataset.openedBySearch)):(e.hidden=!0,e.style.display="none")}),c&&(c.style.display=0===u?"block":"none"),a.style.display=l?"block":"none",function(e,t){const n=o.length,a=(e||"").trim();d.textContent=a?0===t?`نتیجه‌ای برای «${a}» یافت نشد.`:`${t} نتیجه برای «${a}» پیدا شد.`:`نمایش همه ${n} سوال.`}(i,u)}if(d?d.classList.contains("visually-hidden")||(d.classList.add("visually-hidden"),d.classList.remove("sr-only")):(d=document.createElement("div"),d.id="faq-search-status",d.setAttribute("aria-live","polite"),d.setAttribute("aria-atomic","true"),d.className="faq-search-status visually-hidden",(n.closest("form")||n.parentNode).appendChild(d)),a.getAttribute("aria-label")||a.setAttribute("aria-label","پاک کردن جستجو"),n.addEventListener("input",function(){clearTimeout(l),l=setTimeout(()=>{y()},300)}),n.addEventListener("keydown",e=>{"Escape"===e.key&&(e.preventDefault(),n.value="",y(),n.focus())}),a.addEventListener("click",function(){n.value="",y(),n.focus()}),i&&i.addEventListener("click",()=>{o.forEach(e=>{u(e)&&(f(e),delete e.dataset.openedBySearch)}),i.setAttribute("aria-pressed","true"),r&&r.setAttribute("aria-pressed","false")}),r&&r.addEventListener("click",()=>{o.forEach(e=>{u(e)&&(p(e),delete e.dataset.openedBySearch)}),r.setAttribute("aria-pressed","true"),i&&i.setAttribute("aria-pressed","false")}),e.querySelectorAll(".copy-faq-link").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const n=e.dataset.link;if(!n)return;const a=window.location.origin+window.location.pathname+n;navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(a).then(()=>{const t=e.innerHTML;e.innerHTML='<i class="fas fa-check" aria-hidden="true"></i>',e.classList.add("copied"),window.createToast("لینک کپی شد!"),setTimeout(()=>{e.innerHTML=t,e.classList.remove("copied")},2e3)}).catch(()=>{window.createToast("کپی لینک انجام نشد.")}):window.createToast("مرورگر شما از کپی پشتیبانی نمی‌کند.")})}),e.querySelectorAll(".faq-item").forEach(e=>{const t=e.id,n=localStorage.getItem(`faq-feedback-${t}`);if(!n)return;const a=e.querySelector(`.btn-feedback.${n}`);a&&a.classList.add("active")}),e.querySelectorAll(".btn-feedback").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const n=e.closest(".faq-feedback"),a=e.closest(".faq-item");if(!n||!a)return;n.querySelectorAll(".btn-feedback").forEach(e=>{e.classList.remove("active")}),e.classList.add("active");const o=e.classList.contains("up");localStorage.setItem(`faq-feedback-${a.id}`,o?"up":"down");const i=n.querySelector(".feedback-label");if(i){const t=i.dataset.originalText||i.textContent;i.dataset.originalText=t,i.textContent="بازخورد شما ثبت شد. ممنون!",setTimeout(()=>{i.textContent=t,e.classList.remove("active")},3e3)}window.createToast("بازخورد شما ثبت شد. ممنون!")})}),window.location.hash){const t=window.location.hash.substring(1),n=window.CSS&&"function"==typeof window.CSS.escape?window.CSS.escape(t):t.replace(/([ #;?%&,.+*~\':"!^$[\]()=>|/@])/g,"\\$1"),a=e.querySelector(`#${n}`);a&&a.classList.contains("faq-item")&&setTimeout(()=>{f(a),a.scrollIntoView({behavior:"smooth",block:"center"})},400)}})}();
//# sourceMappingURL=faq-search.min.js.map
