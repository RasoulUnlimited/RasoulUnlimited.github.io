{"version":3,"file":"main-script-fa.min.js","names":["noop","on","el","evt","fn","opts","addEventListener","capture","throttle","limit","inThrottle","lastFunc","lastRan","ctx","this","args","arguments","clearTimeout","setTimeout","Date","now","apply","Math","max","ric","window","requestIdleCallback","cb","timeRemaining","didTimeout","storage","cancelIdleCallback","get","key","fallback","v","localStorage","getItem","JSON","parse","set","value","retryCount","attemptSet","setItem","stringify","e","name","oldKeys","Object","keys","filter","k","includes","length","removeItem","innerE","console","error","warn","setRaw","getRaw","remove","ENV","mq","q","matchMedia","matches","removeEventListener","mqs","reduced","dark","coarse","conn","navigator","connection","mozConnection","webkitConnection","state","saveData","lowThroughput","test","String","effectiveType","lowPowerCPU","hardwareConcurrency","listeners","notify","forEach","l","bindMQL","m","onChange","push","FLAGS","s","low","ENABLE_AOS","ENABLE_SOUNDS","ENABLE_HAPTICS","ENABLE_CONFETTI","ENABLE_IDENTITY_PINGS","STRINGS_FA","themeDark","themeLight","reachedEnd","welcomeMorning","welcomeNoon","welcomeEvening","welcomeNight","welcomeBack","emailCopied","emailCopyError","shareOk","shareErr","linkCopied","clipboardUnsupported","closeToast","scrollTop","share","themeToggle","FUN_FACTS_FA","teardown","AbortController","signal","abortSignal","audioContext","clickBuffer","toastBuffer","dynamicController","vibrate","pattern","createToneBuffer","duration","wave","sr","sampleRate","buffer","createBuffer","floor","data","getChannelData","i","dismissToast","toast","classList","once","createToast","message","options","settings","customClass","iconClass","iconColor","position","id","closeButton","existing","document","getElementById","contains","querySelectorAll","t","createElement","className","trim","role","setAttribute","tabIndex","assign","style","left","transform","top","bottom","icon","color","appendChild","text","textContent","closeBtn","type","innerHTML","body","Promise","resolve","then","add","playSound","queueIdentityPings","targets","url","aborted","fetch","mode","catch","ping","Ctx","AudioContext","webkitAudioContext","ensureAudioContext","resume","sin","PI","f","hidden","suspend","aosLoaded","setAOSDisabledCSS","disabled","documentElement","toggle","initAOS","AOS","init","startEvent","initClassName","animatedClassName","debounceDelay","throttleDelay","offset","easing","mirror","anchorPlacement","src","defer","onload","head","applyTheme","theme","showToast","checked","parent","parentElement","createSparkle","rafTasks","Set","rafPending","initScrollUI","bar","inner","prepend","innerBar","querySelector","btn","update","total","scrollHeight","innerHeight","scrolled","scrollY","progress","min","rootStyle","getComputedStyle","primary","getPropertyValue","accent","highlight","backgroundColor","round","onScrollResize","scheduleRaf","requestAnimationFrame","tasks","Array","from","clear","passive","scrollTo","behavior","exploreHint","a","href","dataset","hintAuthor","hero","obs","IntersectionObserver","entries","entry","isIntersecting","threshold","observe","disconnect","preventDefault","target","navH","offsetHeight","progH","padTop","parseFloat","paddingTop","y","offsetTop","initSkillsHover","list","li","hideTimeout","skillOwner","span","getSpan","random","opacity","async","copyToClipboard","okId","errId","okMsg","clipboard","writeText","err","createConfetti","canvas","width","innerWidth","height","pointerEvents","zIndex","celebrationEvent","getContext","colors","pieces","x","size","angle","speed","drift","start","performance","rafId","cleanup","cancelAnimationFrame","parentNode","loop","elapsed","clearRect","p","save","translate","rotate","fillStyle","fillRect","restore","observer","MutationObserver","childList","subtree","initFunFacts","idleTimeout","toastRef","reset","delay","debounce","fact","show","ev","element","sparkle","sparkleSource","toFixed","borderRadius","boxShadow","cs","animate","fill","handleDynamicContent","abort","hamburger","navLinks","links","expanded","getAttribute","link","initMobileMenu","container","items","toggleFAQ","item","open","scrollIntoView","summary","answer","maxHeight","paddingBottom","block","rect","getBoundingClientRect","scrollBy","idx","qId","questionId","faqAuthor","hasAttribute","overflow","transition","tagName","other","hash","location","it","initFAQ","emailLink","contactPerson","email","replace","initEmailCopy","lazyImages","img","decoding","loading","imageLoader","srcset","removeAttribute","onerror","unobserve","rootMargin","initLazyImages","shareBtn","onScroll","isVisible","pageUrl","title","initShareButton","sections","visited","announced","milestones","count","ceil","isFinal","arr","findIndex","sort","b","lastToastAt","cooldown","has","bio","dispatchEvent","Event","sec","initExplorationMilestones","profileOwner","closest","startsWith","txt","nextSibling","initSocialLinksCopy","ctaOwner","refresh","yearEl","getFullYear","lastUpdated","year","month","day","toLocaleDateString","setDynamicDates","hiddenInfo","display","authorFullName","orcidId","metaGenerator","content","metaAuthor","setIdentityHooks","next","initTheme","smoothAllowed","targetId","initAnchorScrolling","event","card","interactionSource","interactive","userAction","MouseEvent","bubbles","handler","initEndOfPageToast","msg","hour","getHours","showWelcomeToast"],"sources":["main-script-fa.js"],"mappings":"CAKA,WACE,aAMA,MAAMA,EAAO,OAGPC,EAAK,CAACC,EAAIC,EAAKC,EAAIC,IACvBH,GACAA,EAAGI,kBACHJ,EAAGI,iBAAiBH,EAAKC,EAAI,CAAEG,SAAS,KAAWF,GAAQ,CAAC,IAO9D,SAASG,EAASJ,EAAIK,GACpB,IAAIC,EAAYC,EAAUC,EAC1B,OAAO,WACL,MAAMC,EAAMC,KACNC,EAAOC,UACRN,GAKHO,aAAaN,GACbA,EAAWO,WAAW,WAChBC,KAAKC,MAAQR,GAAWH,IAC1BL,EAAGiB,MAAMR,EAAKE,GACdH,EAAUO,KAAKC,MAEnB,EAAGE,KAAKC,IAAI,EAAGd,GAASU,KAAKC,MAAQR,OAVrCR,EAAGiB,MAAMR,EAAKE,GACdH,EAAUO,KAAKC,MACfV,GAAa,EAUjB,CACF,CAWA,MAAMc,EACJC,OAAOC,qBACP,SAAUC,GACR,OAAOT,WACL,IAAMS,EAAG,CAAEC,cAAe,IAAM,EAAGC,YAAY,IAC/C,EAEJ,EAIIC,GAHML,OAAOM,oBAAsBd,aAGzB,CACd,GAAAe,CAAIC,EAAKC,EAAW,MAClB,IACE,MAAMC,EAAIC,aAAaC,QAAQJ,GAC/B,OAAa,OAANE,EAAaD,EAAWI,KAAKC,MAAMJ,EAC5C,CAAE,MACA,OAAOD,CACT,CACF,EACA,GAAAM,CAAIP,EAAKQ,GAEP,IAAIC,EAAa,EAEjB,MAAMC,EAAa,KACjB,IAEE,OADAP,aAAaQ,QAAQX,EAAKK,KAAKO,UAAUJ,KAClC,CACT,CAAE,MAAOK,GACP,GAAe,uBAAXA,EAAEC,MAAiCL,EARxB,EAQiD,CAC9DA,IAGA,MAAMM,EAAUC,OAAOC,KAAKd,cAAce,OAAOC,IAC9C,CAAC,QAAS,cAAcC,SAASD,IAGpC,GAAIJ,EAAQM,OAAS,EACnB,IAGE,OADAlB,aAAamB,WAAWP,EAAQ,IACzBL,GACT,CAAE,MAAOa,GAEP,OADAC,QAAQC,MAAM,6CAA6CzB,KAAQuB,IAC5D,CACT,CAEJ,KAAsB,uBAAXV,EAAEC,KACXU,QAAQE,KAAK,gDAAgD1B,qBAE7DwB,QAAQC,MAAM,mBAAmBzB,KAAQa,GAE3C,OAAO,CACT,GAGF,OAAOH,GACT,EACA,MAAAiB,CAAO3B,EAAKQ,GACV,IACEL,aAAaQ,QAAQX,EAAKQ,EAC5B,CAAE,MAAOK,GACQ,uBAAXA,EAAEC,KACJU,QAAQE,KAAK,gDAAgD1B,KAE7DwB,QAAQC,MAAM,mBAAmBzB,KAAQa,EAE7C,CACF,EACA,MAAAe,CAAO5B,EAAKC,EAAW,MACrB,IACE,MAAMC,EAAIC,aAAaC,QAAQJ,GAC/B,OAAa,OAANE,EAAaD,EAAWC,CACjC,CAAE,MACA,OAAOD,CACT,CACF,EACA,MAAA4B,CAAO7B,GACL,IACEG,aAAamB,WAAWtB,EAC1B,CAAE,MAAO,CACX,IAII8B,EAAM,MACV,MAAMC,EAAMC,GACVxC,OAAOyC,WACHzC,OAAOyC,WAAWD,GAClB,CAAEE,SAAS,EAAO7D,iBAAkBN,EAAMoE,oBAAqBpE,GAE/DqE,EAAM,CACVC,QAASN,EAAG,oCACZO,KAAMP,EAAG,gCACTQ,OAAQR,EAAG,sBAGPS,EACJC,UAAUC,YACVD,UAAUE,eACVF,UAAUG,iBAENC,EAAQ,CACZ,WAAIR,GACF,QAASD,EAAIC,QAAQH,OACvB,EACA,QAAII,GACF,QAASF,EAAIE,KAAKJ,OACpB,EACA,UAAIK,GACF,QAASH,EAAIG,OAAOL,OACtB,EACA,YAAIY,GACF,SAAUN,IAAQA,EAAKM,SACzB,EACA,iBAAIC,GACF,SAAUP,IAAQ,aAAaQ,KAAKC,OAAOT,EAAKU,eAAiB,KACnE,EACA,eAAIC,GACF,QAAOV,UAAUW,qBACbX,UAAUW,qBAAuB,CAEvC,GAGIC,EAAY,GACZC,EAAS,IAAMD,EAAUE,QAASC,GAAMA,KAExCC,EAAWC,IACXA,GAAKA,EAAErF,kBACTqF,EAAErF,iBAAiB,SAAUiF,IAYjC,OARAG,EAAQrB,EAAIC,SACZoB,EAAQrB,EAAIE,MACZmB,EAAQrB,EAAIG,QAERC,GAAQA,EAAKnE,kBACfL,EAAGwE,EAAM,SAAUc,GAGd,CAAET,QAAOc,SAAWxF,GAAOkF,EAAUO,KAAKzF,GAClD,EA1DW,GA4DN0F,EAAQ,KACZ,MAAMC,EAAIhC,EAAIe,MACRkB,EAAMD,EAAEhB,UAAYgB,EAAEf,cAC5B,MAAO,CACLiB,YAAaF,EAAEvB,SAAWuB,EAAEzB,UAAY0B,EACxCE,eAAgBH,EAAEvB,SAAWuB,EAAEzB,UAAY0B,EAC3CG,gBAAiBJ,EAAEzB,SAAWyB,EAAEvB,SAAWwB,EAC3CI,iBAAkBL,EAAEzB,UAAY0B,IAAQD,EAAEvB,OAC1C6B,uBAAuB,IAKrBC,EACI,CACNC,UAAW,+BACXC,WAAY,8BACZC,WAAY,yDACZC,eAAgB,oDAChBC,YAAa,oDACbC,eAAgB,oDAChBC,aAAc,mDACdC,YAAa,oCACbC,YAAa,kBACbC,eAAgB,6BAChBC,QAAS,6CACTC,SAAU,gCACVC,WAAapE,GAAS,QAAQA,cAC9BqE,qBAAsB,4CAfpBd,EAiBY,WAjBZA,EAkBE,CACJe,WAAY,YACZC,UAAW,uBACXC,MAAO,oBACPC,YAAa,iBAIXC,EAAe,CACnB,4BACA,0BACA,0CACA,uCACA,6DAIIC,EAAW,IAAIC,iBACbC,OAAQC,GAAgBH,EAGhC,IAaII,EAAcC,EAAaC,EAb3BC,EAAoB,IAAIN,gBAK5B,SAASO,EAAQC,EAAU,CAAC,KACrBrC,IAAQK,iBAAkBpC,EAAIe,MAAMR,SACrCI,UAAUwD,SAAUxD,UAAUwD,QAAQC,EAC5C,CAaA,SAASC,EAAiBC,EAAUC,GAClC,IAAKR,EAAe,OAAO,KAC3B,MAAMS,EAAKT,EAAaU,WAClBC,EAASX,EAAaY,aAC1B,EACApH,KAAKC,IAAI,EAAGD,KAAKqH,MAAMJ,EAAKF,IAC5BE,GAEIK,EAAOH,EAAOI,eAAe,GACnC,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAKtF,OAAQwF,IAAMF,EAAKE,GAAKR,EAAKQ,EAAGP,GACzD,OAAOE,CACT,CAmCA,SAASM,EAAaC,GACfA,IACLA,EAAMC,UAAUnF,OAAO,QACvBkF,EAAM1I,iBACJ,gBACA,IAAM0I,EAAMlF,SACZ,CAAEoF,MAAM,IAEZ,CAEA,SAASC,EAAYC,EAASC,EAAU,CAAC,GACvC,MASMC,EAAW,CARfjB,SAAU,KACVkB,YAAa,GACbC,UAAW,GACXC,UAAW,GACXC,SAAU,SACVC,GAAI,GACJC,aAAa,KAEoBP,GAEnC,GAAIC,EAASK,GAAI,CACf,MAAME,EAAWC,SAASC,eAAeT,EAASK,IAClD,GAAIE,GAAYA,EAASZ,UAAUe,SAAS,QAAU,OAAOH,CAC/D,CAEAC,SAASG,iBAAiB,kBAAkBzE,QAAS0E,IAC9CZ,EAASK,IAAMO,EAAEP,KAAOL,EAASK,KACpCO,EAAEjB,UAAUnF,OAAO,QACnBoG,EAAE5J,iBACA,gBACA,IAAM4J,EAAEpG,SACR,CAAEoF,MAAM,OAKd,MAAMF,EAAQc,SAASK,cAAc,OAqBrC,GApBAnB,EAAMoB,UAAY,iBAAiBd,EAASC,cAAcc,OAC1DrB,EAAMsB,KAAO,SACbtB,EAAMuB,aAAa,YAAa,UAChCvB,EAAMwB,UAAY,EACdlB,EAASK,KAAKX,EAAMW,GAAKL,EAASK,IAEtC1G,OAAOwH,OAAOzB,EAAM0B,MAAO,CACzBhB,SAAU,QACViB,KAAM,MACNC,UAAW,qBAGa,QAAtBtB,EAASI,UACXV,EAAM0B,MAAMG,IAAM,OAClB7B,EAAM0B,MAAMI,OAAS,SAErB9B,EAAM0B,MAAMI,OAAS,OACrB9B,EAAM0B,MAAMG,IAAM,QAGhBvB,EAASE,UAAW,CACtB,MAAMuB,EAAOjB,SAASK,cAAc,KACpCY,EAAKX,UAAYd,EAASE,UACtBF,EAASG,YAAYsB,EAAKL,MAAMM,MAAQ1B,EAASG,WACrDsB,EAAKR,aAAa,cAAe,QACjCvB,EAAMiC,YAAYF,EACpB,CAEA,MAAMG,EAAOpB,SAASK,cAAc,QAKpC,GAJAe,EAAKd,UAAY,gBACjBc,EAAKC,YAAc/B,EACnBJ,EAAMiC,YAAYC,GAEd5B,EAASM,YAAa,CACxB,MAAMwB,EAAWtB,SAASK,cAAc,UACxCiB,EAASC,KAAO,SAChBD,EAAShB,UAAY,iBACrBgB,EAASb,aAAa,aAAcjE,EAAgBe,YACpD+D,EAASE,UAAY,kDACrBrL,EAAGmL,EAAU,QAAS,IAAMrC,EAAaC,IACzCA,EAAMiC,YAAYG,EACpB,CAgBA,OAdAtB,SAASyB,KAAKN,YAAYjC,GAG1BwC,QAAQC,UAAUC,KAAK,KACrB1C,EAAMC,UAAU0C,IAAI,QAChB7F,IAAQI,eAAiB4B,GAC3B8D,UAAU,WAIVtC,EAASjB,SAAW,GACtBnH,WAAW,IAAM6H,EAAaC,GAAQM,EAASjB,UAG1CW,CACT,CAmDA,SAAS6C,IACP,IACG/F,IAAQO,uBACTtC,EAAIe,MAAMN,QACVT,EAAIe,MAAMC,SAEX,OAED,MAAM+G,EAAU,CACd,CAAE/I,KAAM,SAAUgJ,IAAK,sCACvB,CACEhJ,KAAM,WACNgJ,IAAK,gDAEP,CACEhJ,KAAM,eACNgJ,IAAK,gEAEP,CAAEhJ,KAAM,WAAYgJ,IAAK,oCACzB,CAAEhJ,KAAM,QAASgJ,IAAK,0CAKxBvK,EAAI,IACFsK,EAAQtG,QAAQ,CAAC0E,EAAGpB,IAClB5H,WAAW,KACL2G,EAAYmE,SALT,CAAC9B,IAAM+B,MAAM/B,EAAE6B,IAAK,CAAEG,KAAM,YAAaC,MAAM,SAMtDC,CAAKlC,IACA,IAAJpB,IAGT,CAvMA7I,EACE6J,SACA,cACA,MApCF,WACE,IAAKhE,IAAQI,eAAiB4B,EAAe,OAC7C,MAAMuE,EAAM5K,OAAO6K,cAAgB7K,OAAO8K,mBACtCF,IAAMvE,EAAe,IAAIuE,EAC/B,CAiCIG,GACA1E,GAAc2E,WAlBX3E,IACLC,EAAcK,EACZ,IACA,CAACU,EAAGP,IAAgD,IAAzCjH,KAAKoL,IAAI,EAAIpL,KAAKqL,GAAK,KAAO7D,EAAIP,KAE/CP,EAAcI,EAAiB,GAAK,CAACU,EAAGP,KACtC,MAAM2B,EAAIpB,EAAIP,EAERqE,EAAI,IAAsB1C,EADtB,GACM,IAChB,MAAuC,IAAhC5I,KAAKoL,IAAI,EAAIpL,KAAKqL,GAAKC,EAAI1C,GAAY5I,KAAKC,IAAI,EAAG,EAAI2I,EAFpD,QAcZ,CAAEhB,MAAM,IAGVjJ,EAAG6J,SAAU,mBAAoB,KAC3BA,SAAS+C,OAAS/E,GAAcgF,YAC9BhF,GAAc2E,aA+LtB,IAAIM,GAAY,EAEhB,SAASC,EAAkBC,GACzBnD,SAASoD,gBAAgBjE,UAAUkE,OAAO,eAAgBF,EAC5D,CAEA,SAASG,IACP,IAAKtH,IAAQG,WAEX,YADA+G,GAAkB,GAMpB,GAFAA,GAAkB,GAEdD,GAAatL,OAAO4L,KAAKC,KAc3B,YAbA7L,OAAO4L,IAAIC,KAAK,CACdC,WAAY,mBACZC,cAAe,WACfC,kBAAmB,cACnBC,cAAe,GACfC,cAAe,GACfC,OAAQ,IACRvF,SAAU,IACVwF,OAAQ,WACR3E,MAAM,EACN4E,QAAQ,EACRC,gBAAiB,eAKrB,GAAItM,OAAO4L,KAAKC,KAEd,OADAP,GAAY,EACLK,IAGT,GAAIL,EAAY,OAEhB,MAAMhH,EAAI+D,SAASK,cAAc,UACjCpE,EAAEiI,IAAM,gCACRjI,EAAEkI,OAAQ,EACVlI,EAAEmI,OAAS,KACTnB,GAAY,EACZK,KAEFtD,SAASqE,KAAKlD,YAAYlF,EAC5B,CAKA,SAASqI,EAAWC,EAAOC,GAAY,GACrCxE,SAASyB,KAAKtC,UAAUkE,OAAO,YAAuB,SAAVkB,GAC5CvE,SAASyB,KAAKtC,UAAUkE,OAAO,aAAwB,UAAVkB,GAE7C,MAAMlB,EAASrD,SAASC,eAAe,gBAGvC,GAFIoD,IAASA,EAAOoB,QAAoB,SAAVF,GAE1BC,EAAW,CAiBb,MAAME,EAASrB,GAAQsB,cACnBD,GAASE,EAAcF,GAC3BtG,EAAQ,CAAC,IACX,CACF,CA+GA,MAAMyG,EAAW,IAAIC,IACrB,IAAIC,GAAa,EAsBjB,SAASC,IACP,IAAIC,EAAMjF,SAASC,eAAe,uBAClC,IAAKgF,EAAK,CACRA,EAAMjF,SAASK,cAAc,OAC7B4E,EAAIpF,GAAK,sBACToF,EAAI3E,UAAY,mBAChB2E,EAAIzE,KAAO,cACXyE,EAAIxE,aAAa,gBAAiB,KAClCwE,EAAIxE,aAAa,gBAAiB,OAClC,MAAMyE,EAAQlF,SAASK,cAAc,OACrC6E,EAAM5E,UAAY,yBAClB2E,EAAI9D,YAAY+D,GAChBlF,SAASyB,KAAK0D,QAAQF,EACxB,CACA,MAAMG,EAAWH,EAAII,cAAc,4BAA8BJ,EAEjE,IAAIK,EAAMtF,SAASC,eAAe,iBAWlC,SAASsF,IACP,MAAMC,EAAQhO,KAAKC,IACjB,EACAuI,SAASoD,gBAAgBqC,aAAe9N,OAAO+N,aAE3CC,EAAWhO,OAAOiO,QAClBC,EAAWrO,KAAKsO,IAAI,EAAGtO,KAAKC,IAAI,EAAGkO,EAAWH,IAEpDJ,EAASxE,MAAME,UAAY,UAAU+E,KAErC,MAAME,EAAYC,iBAAiBhG,SAASoD,iBACtC6C,EACJF,EAAUG,iBAAiB,oBAAsB,OAC7CC,EACJJ,EAAUG,iBAAiB,mBAAqB,aAC5CE,EACJL,EAAUG,iBAAiB,sBAAwB,OAErDd,EAASxE,MAAMyF,gBACbR,EAAW,GAAMO,EAAYP,EAAW,GAAMM,EAASF,EAEzDhB,EAAIxE,aAAa,gBAAiBrF,OAAO5D,KAAK8O,MAAiB,IAAXT,KAEpDP,EAAInG,UAAUkE,OAAO,UAAWsC,EAAW,KAC3CL,EAAInG,UAAUkE,OAAO,SAAUsC,GAAY,IAC7C,CAnCKL,IACHA,EAAMtF,SAASK,cAAc,UAC7BiF,EAAIzF,GAAK,gBACTyF,EAAI/D,KAAO,SACX+D,EAAI9D,UAAY,qDAChB8D,EAAI7E,aAAa,aAAcjE,EAAgBgB,WAC/C8H,EAAInG,UAAU0C,IAAI,qBAAsB,SAAU,oBAClD7B,SAASyB,KAAKN,YAAYmE,IA8B5B,MAAMiB,EAAiB,KAAMC,OA1EVlQ,EA0EsBiP,EAzEzCV,EAAShD,IAAIvL,QACRyO,IACHA,GAAa,EACb0B,sBAAsB,KACpB1B,GAAa,EACb,MAAM2B,EAAQC,MAAMC,KAAK/B,GACzBA,EAASgC,QACTH,EAAMhL,QAAS0E,IACb,IACEA,GACF,CAAE,MAAO,QAXjB,IAAqB9J,GA2EnBH,EAAGwB,OAAQ,SAAU4O,EAAgB,CAAEO,SAAS,IAChD3Q,EAAGwB,OAAQ,SAAU4O,GACrBhB,IAEApP,EAAGmP,EAAK,QAAS,MAEZrL,EAAIe,MAAMR,SACX,mBAAoBwF,SAASoD,gBAAgBxC,MAClCjJ,OAAOoP,SAAS,CAAEhG,IAAK,EAAGiG,SAAU,WAC3CrP,OAAOoP,SAAS,EAAG,GACzB3I,EAAQ,CAAC,OAGX,MAAM6I,EACJjH,SAASC,eAAe,iBACxB,MACE,MAAMiH,EAAIlH,SAASK,cAAc,KAQjC,OAPA6G,EAAEC,KAAO,YACTD,EAAErH,GAAK,eACPqH,EAAE1F,UACA,+GACF0F,EAAEE,QAAQC,WAAa,0BACvBH,EAAE/H,UAAU0C,IAAI,sBAAuB,UACvC7B,SAASyB,KAAKN,YAAY+F,GACnBA,CACR,EAVD,GAYII,EAAOtH,SAASC,eAAe,QACrC,GAAIqH,EAAM,CACR,MAAMC,EAAM,IAAIC,qBACbC,IACCA,EAAQ/L,QAASgM,IACfT,EAAY9H,UAAUkE,OACpB,UACAqE,EAAMC,gBAERV,EAAY9H,UAAUkE,OACpB,kBACAqE,EAAMC,gBAERV,EAAY9H,UAAUkE,OACpB,UACCqE,EAAMC,mBAIb,CAAEC,UAAW,KAEfL,EAAIM,QAAQP,GACZnR,EACEwB,OACA,eACA,IAAM4P,EAAIO,aACV,CAAE1I,MAAM,GAEZ,CAEAjJ,EAAG8Q,EAAa,QAAUjO,IACxBA,EAAE+O,iBACFd,EAAY9H,UAAU0C,IAAI,UAC1BoF,EAAY9H,UAAUnF,OAAO,UAAW,mBAExC,MAAMgO,EAAShI,SAASqF,cAAc,aACtC,GAAI2C,EAAQ,CACV,MAAMC,EAAOjI,SAASqF,cAAc,YAAY6C,cAAgB,EAC1DC,EACJnI,SAASC,eAAe,wBAAwBiI,cAChD,EACIE,EACJC,WAAWrC,iBAAiBgC,GAAQM,aAAe,EAC/CC,EAAI/Q,KAAKC,IACb,EACAuQ,EAAOQ,UAAYJ,EAASH,EAAOE,IAErBlO,EAAIe,MAAMR,QACb7C,OAAOoP,SAAS,CAAEhG,IAAKwH,EAAGvB,SAAU,WAC3CrP,OAAOoP,SAAS,EAAGwB,EAC3B,CACAnK,EAAQ,CAAC,MAEb,CAKA,SAASqK,EAAgB3K,GACvB,MAAM4K,EAAO1I,SAASqF,cAAc,wBAC/BqD,GAELA,EAAKvI,iBAAiB,MAAMzE,QAASiN,IAInC,IAAIC,EAHJD,EAAGvB,QAAQyB,WAAa,0BACxBF,EAAGxJ,UAAU0C,IAAI,sBAcjB1L,EAAGwS,EAAI,aAAc,KACnBxR,aAAayR,GACb,MAAME,EAZR,WACE,IAAI7M,EAAI0M,EAAGtD,cAAc,wBAMzB,OALKpJ,IACHA,EAAI+D,SAASK,cAAc,QAC3BpE,EAAEqE,UAAY,sBACdqI,EAAGxH,YAAYlF,IAEVA,CACT,CAIe8M,GACRD,EAAK3J,UAAUe,SAAS,kBAC3B4I,EAAKzH,YACH1D,EAAcnG,KAAKwR,SAAWrL,EAAanE,OAAU,GACvDL,OAAOwH,OAAOmI,EAAKlI,MAAO,CACxBqI,QAAS,IACTnI,UAAW,qBAEbgI,EAAK3J,UAAU0C,IAAI,iBAErB8G,EAAGxJ,UAAU0C,IAAI,uBAChB,CAAE/D,WAEL3H,EAAGwS,EAAI,aAAc,KACnB,MAAMG,EAAOH,EAAGtD,cAAc,wBAC1ByD,IACFF,EAAcxR,WAAW,KACvB0R,EAAKlI,MAAMqI,QAAU,IACrBH,EAAKlI,MAAME,UAAY,gBACvBgI,EAAK3J,UAAUnF,OAAO,iBACrB,MAEL2O,EAAGxJ,UAAUnF,OAAO,uBACnB,CAAE8D,YAET,CAgLAoL,eAAeC,EAAgB/H,EAAMgI,EAAMC,EAAOC,GAChD,UACQ1O,UAAU2O,UAAUC,UAAUpI,GACpC/B,EAAYiK,EAAO,CACjBzJ,GAAIuJ,EACJ1J,UAAW,sBACXC,UAAW,yBACXpB,SAAU,OAEZH,EAAQ,CAAC,IACX,CAAE,MAAOqL,GACP9P,QAAQC,MAAM,mBAAoB6P,GAClCpK,EAAY7C,EAAkBc,qBAAsB,CAClDuC,GAAIwJ,EACJ3J,UAAW,8BACXC,UAAW,MACXpB,SAAU,MAEd,CACF,CA4OA,SAASmL,IACP,GAAIzP,EAAIe,MAAMR,SAAWP,EAAIe,MAAMN,OAAS,OAE5C,MAAMiP,EAAS3J,SAASK,cAAc,UACtCsJ,EAAO9J,GAAK,kBACZ8J,EAAOC,MAAQjS,OAAOkS,WACtBF,EAAOG,OAASnS,OAAO+N,YAEvBvM,OAAOwH,OAAOgJ,EAAO/I,MAAO,CAC1BhB,SAAU,QACVmB,IAAK,EACLF,KAAM,EACN+I,MAAO,QACPE,OAAQ,QACRC,cAAe,OACfC,OAAQ,OAGVL,EAAOvC,QAAQ6C,iBACb,kDAEFjK,SAASyB,KAAKN,YAAYwI,GAE1B,MAAM5S,EAAM4S,EAAOO,WAAW,MACxBC,EAAS,CACb,UACA,UACA,UACA,UACA,UACA,UACA,WAGIC,EAASzD,MAAMC,KAAK,CAAEpN,OAAQ,IAAM,KAAM,CAC9C6Q,EAAG7S,KAAKwR,SAAWW,EAAOC,MAC1BrB,GAAI/Q,KAAKwR,SAAWW,EAAOG,OAC3BQ,KAAsB,EAAhB9S,KAAKwR,SAAe,EAC1B9H,MAAOiJ,EAAQ3S,KAAKwR,SAAWmB,EAAO3Q,OAAU,GAChD+Q,MAAuB,IAAhB/S,KAAKwR,SACZwB,MAAuB,EAAhBhT,KAAKwR,SAAe,EAC3ByB,MAAuB,EAAhBjT,KAAKwR,SAAe,KAGvB0B,EAAQC,YAAYrT,MAC1B,IAAIsT,EAAQ,KAEZ,MAAMC,EAAU,KACVD,GAAQE,qBAAqBF,GAC7BjB,GAAUA,EAAOoB,YACnBpB,EAAO3P,UAILgR,EAAO,KACX,MAAMC,EAAUN,YAAYrT,MAAQoT,EACpC3T,EAAImU,UAAU,EAAG,EAAGvB,EAAOC,MAAOD,EAAOG,QAEzC,IAAK,MAAMqB,KAAKf,EACde,EAAE5C,GAAK4C,EAAEX,MACTW,EAAEd,GAAKc,EAAEV,MACTU,EAAEZ,OAAS,EAEXxT,EAAIqU,OACJrU,EAAIsU,UAAUF,EAAEd,EAAGc,EAAE5C,GACrBxR,EAAIuU,OAAQH,EAAEZ,MAAQ/S,KAAKqL,GAAM,KACjC9L,EAAIwU,UAAYJ,EAAEjK,MAClBnK,EAAIyU,UAAUL,EAAEb,KAAO,GAAIa,EAAEb,KAAO,EAAGa,EAAEb,KAAMa,EAAEb,MACjDvT,EAAI0U,UAGFR,EAAU,KACZL,EAAQnE,sBAAsBuE,GAE9BH,KAIJD,EAAQnE,sBAAsBuE,GAG9B,MAAMU,EAAW,IAAIC,iBAAiB,KAC/B3L,SAASyB,KAAKvB,SAASyJ,KAC1BkB,IACAa,EAAS5D,gBAIb4D,EAAS7D,QAAQ7H,SAASyB,KAAM,CAAEmK,WAAW,EAAMC,SAAS,GAC9D,CAKA,SAASC,IACP,GAAI7R,EAAIe,MAAMN,QAAUT,EAAIe,MAAMC,SAAW,OAE7C,IACI8Q,EADAC,EAAW,KAGf,MAaMC,EA13CR,SAAkB3V,EAAI4V,GACpB,IAAI9L,EACJ,OAAO,WACLjJ,aAAaiJ,GACbA,EAAIhJ,WAAW,IAAMd,EAAGiB,MAAMP,KAAME,WAAYgV,EAClD,CACF,CAo3CgBC,CAAS,KACrBhV,aAAa4U,GACbA,EAAc3U,WAAW,KAClB4U,GAAaA,EAAS7M,UAAUe,SAAS,SAhBrC,MACX,MAAMkM,EAAOzO,EAAcnG,KAAKwR,SAAWrL,EAAanE,OAAU,GAClEwS,EAAW3M,EAAY,GAAG7C,KAA6B4P,IAAQ,CAC7DvM,GAAI,iBACJJ,YAAa,iBACbC,UAAW,mBACXC,UAAW,uBACXC,SAAU,MACVrB,SAAU,KACVuB,aAAa,KAO2CuM,IACvD,OACF,KAES,CAAC,YAAa,UAAW,SAAU,cAC3C3Q,QAAS4Q,IAEXnW,EAAGwB,OAAQ2U,EAAIL,EADK,WAAPK,GAA0B,eAAPA,EAAsB,CAAExF,SAAS,GAAS,CAAC,KAI7EmF,IAEA9V,EAAG6J,SAAU,mBAAoB,KAC3BA,SAAS+C,OACX5L,aAAa4U,GAEbE,KAGN,CAsCA,SAASrH,EAAc2H,GACrB,IACGA,GACDtS,EAAIe,MAAMR,SACVP,EAAIe,MAAMC,UACVhB,EAAIe,MAAMM,YAEX,OAED,MAAMkR,EAAUxM,SAASK,cAAc,OACvCmM,EAAQlM,UAAY,iBACpBkM,EAAQpF,QAAQqF,cACd,iDAEF,MAAMnC,EAAuB,GAAhB9S,KAAKwR,SAAgB,EAElC7P,OAAOwH,OAAO6L,EAAQ5L,MAAO,CAC3BgJ,MAAO,GAAGU,MACVR,OAAQ,GAAGQ,MACXzJ,KAAM,IAAoB,IAAhBrJ,KAAKwR,UAAgB0D,QAAQ,MACvC3L,IAAK,IAAoB,IAAhBvJ,KAAKwR,UAAgB0D,QAAQ,MACtCrG,gBAAiB,CACf,uBACA,sBACA,0BACiB,EAAhB7O,KAAKwR,SAAgB,GACxBC,QAAS,EACTrJ,SAAU,WACV+M,aAAc,MACdC,UAAW,OAAOtC,EAAO,OAAOA,EAAO,6BACvCN,OAAQ,GACRD,cAAe,SAGjB,MAAM8C,EAAK7G,iBAAiBuG,GACvBM,EAAGjN,UAA4B,WAAhBiN,EAAGjN,WACtB2M,EAAQ3L,MAAMhB,SAAW,YAE1B2M,EAAQpL,YAAYqL,GAEpBA,EACGM,QACC,CACE,CACE7D,QAAS,EACTnI,UAAW,oBACO,IAAhBtJ,KAAKwR,UACL0D,QAAQ,UAEZ,CACEzD,QAAS,EACTnI,UAAW,oBACT,IAAsB,IAAhBtJ,KAAKwR,UACX0D,QAAQ,UAEZ,CACEzD,QAAS,EACTnI,UAAW,sBACT,IAAsB,IAAhBtJ,KAAKwR,UACX0D,QAAQ,WAGd,CAAEnO,SAAU,IAAKwF,OAAQ,WAAYgJ,KAAM,aAE5CvW,iBAAiB,SAAU,IAAMgW,EAAQxS,SAC9C,CAgFA,SAASgT,IAEP7O,EAAkB8O,QAClB9O,EAAoB,IAAIN,gBACxB,MAAMC,OAAEA,GAAWK,GA3CrB,SAAwBL,GACtB,MAAMoP,EAAYlN,SAASqF,cAAc,cACnC8H,EAAWnN,SAASqF,cAAc,cAClC+H,EAAQpN,SAASG,iBAAiB,gBAEnC+M,GAAcC,IAEnBhX,EAAG+W,EAAW,QAAS,KACrBA,EAAU/N,UAAUkE,OAAO,UAC3B8J,EAAShO,UAAUkE,OAAO,UAC1B,MAAMgK,EAAuD,SAA5CH,EAAUI,aAAa,iBACxCJ,EAAUzM,aAAa,iBAAkB4M,IACxC,CAAEvP,WAELsP,EAAM1R,QAAS6R,IACbpX,EAAGoX,EAAM,QAAS,KAChBL,EAAU/N,UAAUnF,OAAO,UAC3BmT,EAAShO,UAAUnF,OAAO,UAC1BkT,EAAUzM,aAAa,gBAAiB,UACvC,CAAE3C,aAIP3H,EAAG6J,SAAU,QAAUhH,IAElBkU,EAAUhN,SAASlH,EAAEgP,SACrBmF,EAASjN,SAASlH,EAAEgP,UACrBmF,EAAShO,UAAUe,SAAS,YAE5BgN,EAAU/N,UAAUnF,OAAO,UAC3BmT,EAAShO,UAAUnF,OAAO,UAC1BkT,EAAUzM,aAAa,gBAAiB,WAEzC,CAAE3C,WACP,CAWE0P,CAAe1P,GA9uBjB,SAAiBA,GACf,MAAM2P,EAAYzN,SAASqF,cAAc,kBACzC,IAAKoI,EAAY,OAEjBA,EAAU5N,GAAK,uBAEf,MAAM6N,EAAQ,IAAI1N,SAASG,iBAAiB,cA0C5C,SAASwN,EAAUC,EAAMC,EAAMC,GAAiB,GAC9CF,EAAKC,KAAOA,EACZ,MAAME,EAAUH,EAAKvI,cAAc,WAC7B2I,EAASJ,EAAKvI,cAAc,KAE9B0I,GACHA,EAAQtN,aAAa,gBAAiBoN,EAAO,OAAS,SAEnDG,IACFA,EAAOpN,MAAMqN,UAAYJ,EAAO,SAAW,MAC3CG,EAAOpN,MAAM0H,WAAauF,EAAO,SAAW,IAC5CG,EAAOpN,MAAMsN,cAAgBL,EAAO,SAAW,IAC/CG,EAAOpN,MAAMqI,QAAU4E,EAAO,IAAM,KAGlCC,GAAkBD,GACpBzW,WAAW,KACT,MAAM6Q,EACJjI,SAASqF,cAAc,YAAY6C,cAAgB,EACrD0F,EAAKE,eAAe,CAClB9G,SAAU/M,EAAIe,MAAMR,QAAU,OAAS,SACvC2T,MAAO,UAET/W,WAAW,KACT,MAAMgX,EAAOR,EAAKS,wBACdD,EAAKrN,IAAMkH,GACdtQ,OAAO2W,SAAS,CACfvN,IAAKqN,EAAKrN,IAAMkH,EAChBjB,SAAU/M,EAAIe,MAAMR,QAAU,OAAS,YAExC,KACF,GAEP,CAzEAkT,EAAMhS,QAAQ,CAACkS,EAAMW,KACnB,MAAMR,EAAUH,EAAKvI,cAAc,WAC7B2I,EAASJ,EAAKvI,cAAc,KAC5BmJ,EAAMZ,EAAKxG,QAAQqH,YAAc,SAASF,EAAM,IACjDR,IAELA,EAAQ3G,QAAQsH,UAAY,0BAEvBX,EAAQY,aAAa,kBACzBZ,EAAQtN,aAAa,gBAAiBmN,EAAKC,KAAO,OAAS,SAExDG,IACGA,EAAOnO,KAAKmO,EAAOnO,GAAK,cAAc2O,KACtCT,EAAQY,aAAa,kBACzBZ,EAAQtN,aAAa,gBAAiBuN,EAAOnO,IAE9C1G,OAAOwH,OAAOqN,EAAOpN,MAAO,CAC1BqN,UAAWL,EAAKC,KAAO,SAAW,MAClCe,SAAU,SACVC,WACE,0HACFvG,WAAYsF,EAAKC,KAAO,SAAW,IACnCK,cAAeN,EAAKC,KAAO,SAAW,IACtC5E,QAAS2E,EAAKC,KAAO,IAAM,OAI/B1X,EAAG4X,EAAS,QAAU/U,IACK,MAArBA,EAAEgP,OAAO8G,UACb9V,EAAE+O,iBACFnD,EAAcmJ,GAEdL,EAAMhS,QAASqT,IACTA,IAAUnB,GAAQmB,EAAMlB,MAAOF,EAAUoB,GAAO,KAGtDpB,EAAUC,GAAOA,EAAKC,QACrB,CAAE/P,cAuCP,MAAMkR,EAAOrX,OAAOsX,SAASD,KAC7B,GAAIA,EAAM,CACR,MAAMhH,EAAShI,SAASqF,cAAc2J,GAClChH,GAAUA,EAAO7I,UAAUe,SAAS,cACtCwN,EAAMhS,QACHwT,GAAOA,IAAOlH,GAAUkH,EAAGrB,MAAQF,EAAUuB,GAAI,IAEpDvB,EAAU3F,GAAQ,GAAM,GAE5B,CACF,CAipBEmH,CAAQrR,GA7mBV,SAAuBA,GACrB,MAAMsR,EAAYpP,SAASqF,cACzB,oCAEG+J,IAELA,EAAUhI,QAAQiI,cAAgB,0BAClCD,EAAUjQ,UAAU0C,IAAI,0BAExB1L,EACEiZ,EACA,QACAlG,MAAOlQ,IACLA,EAAE+O,iBACF,MAAMuH,EAAQF,EAAUjI,KAAKoI,QAAQ,UAAW,IAChD,UACQ3U,UAAU2O,UAAUC,UAAU8F,GACpCjQ,EAAY7C,EAAkBS,YAAa,CACzC4C,GAAI,mBACJH,UAAW,sBACXC,UAAW,yBACXpB,SAAU,OAEZH,EAAQ,CAAC,IACX,CAAE,MAAOqL,GACP9P,QAAQC,MAAM,mBAAoB6P,GAClCpK,EAAY7C,EAAkBU,eAAgB,CAC5C2C,GAAI,mBACJH,UAAW,8BACXC,UAAW,MACXpB,SAAU,MAEd,GAEF,CAAEuI,SAAS,EAAOhJ,WAEtB,CA0kBE0R,CAAc1R,GA1iBhB,SAAwBA,GACtB,MAAM2R,EAAazP,SAASG,iBAAiB,iBAC7C,IAAKsP,EAAWjW,OAAS,OAEzB,MAAMkS,EAAW,IAAIlE,qBACnB,CAACC,EAASF,KACRE,EAAQ/L,QAASgM,IACf,IAAKA,EAAMC,eAAiB,OAC5B,MAAM+H,EAAMhI,EAAMM,OAElB0H,EAAIC,SAAW,QACfD,EAAIE,QAAU,OACdF,EAAIvQ,UAAU0C,IAAI,cAClB6N,EAAItI,QAAQyI,YACV,6CAEFH,EAAIxL,IAAMwL,EAAItI,QAAQlD,IAClBwL,EAAItI,QAAQ0I,SAASJ,EAAII,OAASJ,EAAItI,QAAQ0I,QAElDJ,EAAItL,OAAS,KACXsL,EAAIvQ,UAAUnF,OAAO,cACrB0V,EAAIvQ,UAAU0C,IAAI,UAClB6N,EAAIK,gBAAgB,YACpBL,EAAIK,gBAAgB,gBAGtBL,EAAIM,QAAU,KACZrW,QAAQC,MAAM,wBAAyB8V,EAAIxL,KAC3CwL,EAAIvQ,UAAUnF,OAAO,cACrB0V,EAAIvQ,UAAU0C,IAAI,cAClB6N,EAAIxL,IACF,yDAGJqD,EAAI0I,UAAUP,MAGlB,CAAEQ,WAAY,oBAAqBtI,UAAW,MAGhD6H,EAAW/T,QAASgU,GAAQhE,EAAS7D,QAAQ6H,IAEzC5R,EACFA,EAAOtH,iBAAiB,QAAS,IAAMkV,EAAS5D,cAEhD3R,EACEwB,OACA,eACA,IAAM+T,EAAS5D,aACf,CAAE1I,MAAM,GAGd,CAufE+Q,CAAerS,GAlfjB,SAAyBA,GACvB,IAAIsS,EAAWpQ,SAASC,eAAe,qBAClCmQ,IACHA,EAAWpQ,SAASK,cAAc,UAClC+P,EAASvQ,GAAK,oBACduQ,EAAS7O,KAAO,SAChB6O,EAAS5O,UACP,sDACF4O,EAAS3P,aAAa,aAAcjE,EAAgBiB,OACpD2S,EAASjR,UAAU0C,IACjB,wBACA,SACA,oBAEF7B,SAASyB,KAAKN,YAAYiP,IAG5B,MAAMC,EAAW3Z,EAAS,KACxB,MAAM4Z,EAAY3Y,OAAOiO,QAAU,IACnCwK,EAASjR,UAAUkE,OAAO,UAAWiN,GACrCF,EAASjR,UAAUkE,OAAO,UAAWiN,IACpC,KAEHna,EAAGwB,OAAQ,SAAU0Y,EAAU,CAAEvJ,SAAS,EAAMhJ,WAChDuS,IAEAla,EAAGia,EAAU,QAASlH,UACpB,MAAMqH,EAAU5Y,OAAOsX,SAAS9H,KAChC,GAAIvM,UAAU6C,MACZ,UACQ7C,UAAU6C,MAAM,CAAE+S,MAAOxQ,SAASwQ,MAAOvO,IAAKsO,IACpDlR,EAAY7C,EAAkBW,QAAS,CACrC0C,GAAI,sBACJH,UAAW,sBACXC,UAAW,yBACXpB,SAAU,OAEZH,EAAQ,CAAC,IACX,CAAE,MAAOxE,GACa,eAAhBA,GAAOX,OACTU,QAAQC,MAAM,eAAgBA,GAC9ByF,EAAY7C,EAAkBY,SAAU,CACtCyC,GAAI,oBACJH,UAAW,8BACXC,UAAW,MACXpB,SAAU,OAGhB,YAEM4K,EACJoH,EACA,mBACA,oBACA/T,EAAkBa,WAAW,UAGhC,CAAES,UACP,CAybE2S,CAAgB3S,GApblB,SAAmCA,GACjC,MAAM4S,EAAW1Q,SAASG,iBAAiB,eACrCqF,EAAQkL,EAASlX,OACvB,IAAKgM,EAAQ,OAEb,MAAMmL,EAAU,IAAI7L,IAAI9M,EAAQE,IAAI,kBAAmB,KACjD0Y,EAAY,IAAI9L,IAAI9M,EAAQE,IAAI,sBAAuB,KAEvD2Y,EAAa,CACjB,CACEC,MAAOtZ,KAAKC,IAAI,EAAGD,KAAKuZ,KAAa,IAARvL,IAC7BlG,QAAS,yDACT2B,KAAM,yBAER,CACE6P,MAAOtZ,KAAKC,IACVD,KAAKuZ,KAAa,IAARvL,GAAgB,EAC1BhO,KAAKuZ,KAAa,GAARvL,IAEZlG,QACE,uEACF2B,KAAM,iBAER,CACE6P,MAAOtZ,KAAKC,IACVD,KAAKuZ,KAAa,GAARvL,GAAe,EACzBhO,KAAKuZ,KAAa,IAARvL,IAEZlG,QAAS,kDACT2B,KAAM,eAER,CACE6P,MAAOtL,EACPlG,QAAS,mBAAmBkG,6DAC5BvE,KAAM,gBACN+P,SAAS,IAGV3X,OACC,CAACwC,EAAGmD,EAAGiS,IACLpV,EAAEiV,MAAQ,GAAKG,EAAIC,UAAW7G,GAAMA,EAAEyG,QAAUjV,EAAEiV,SAAW9R,GAEhEmS,KAAK,CAACjK,EAAGkK,IAAMlK,EAAE4J,MAAQM,EAAEN,OAE9B,IAAIO,EAAc,EAClB,MAAMC,EAAWrX,EAAIe,MAAMN,OAAS,KAAQ,IAEtCgR,EAAW,IAAIlE,qBAClBC,IACC,MAAMnQ,EAAMD,KAAKC,MAEjBmQ,EAAQ/L,QAASgM,IACf,IAAKA,EAAMC,eAAiB,OAE5BgJ,EAAQ9O,IAAI6F,EAAMM,OAAOnI,IACzB7H,EAAQU,IAAI,kBAAmB,IAAIiY,IACnCjF,EAASuE,UAAUvI,EAAMM,QAEzB,MAAM8I,EAAQH,EAAQrG,KACtB,IAAK,MAAMzO,KAAKgV,EACd,GACEC,GAASjV,EAAEiV,QACVF,EAAUW,IAAI1V,EAAEiV,QACjBxZ,EAAM+Z,EAAcC,EACpB,CACAjS,EAAYxD,EAAEyD,QAAS,CACrBO,GAAI,yBAAyBhE,EAAEiV,QAC/BrR,YAAa5D,EAAEmV,QACX,4CACA,oBACJtR,UAAW7D,EAAEoF,KACbtB,UAAW9D,EAAEmV,QACT,uBACA,sBACJzS,SAAU,OAGZ,MAAMiT,EAAMxR,SAASC,eAAe,eACpCuR,GAAKC,cAAc,IAAIC,MAAM,eAE7Bd,EAAU/O,IAAIhG,EAAEiV,OAChB9Y,EAAQU,IAAI,sBAAuB,IAAIkY,IACvCS,EAAc/Z,EAEVuE,EAAEmV,SAAWhV,IAAQM,iBACxBlF,WAAWsS,EAAgB,KAC5B,KACF,KAIN,CAAE9B,UAAW,GAAKsI,WAAY,qBAGhCQ,EAAShV,QAASiW,GAAQjG,EAAS7D,QAAQ8J,IAEvC7T,EACFA,EAAOtH,iBAAiB,QAAS,IAAMkV,EAAS5D,cAEhD3R,EACEwB,OACA,eACA,IAAM+T,EAAS5D,aACf,CAAE1I,MAAM,GAGd,CA2UEwS,CAA0B9T,GA7L5B,SAA6BA,GAC3B,MAAMqQ,EAAQnO,SAASqF,cAAc,2BAChC8I,IAELA,EAAMtO,GAAK,uBACXsO,EAAM/G,QAAQyK,aAAe,0BAE7B1b,EAAGgY,EAAO,QAASjF,MAAOlQ,IACxB,MAAMuU,EAAOvU,EAAEgP,OAAO8J,UAAU,KAChC,GACEvE,GACAY,EAAMjO,SAASqN,IACfA,EAAKpG,MACLoG,EAAKpG,KAAK4K,WAAW,QACrB,CACA/Y,EAAE+O,iBACF,MAAMiK,EAAMzE,EAAKlM,aAAad,QAAUgN,EAAKpG,KACvClO,EACJsU,EAAKlI,cAAc,MAAM4M,aAAa5Q,aAAad,QACnDyR,QACI7I,EACJoE,EAAKpG,KACL,oBAAoBlO,EAAKsW,QAAQ,MAAO,MACxC,0BAA0BtW,EAAKsW,QAAQ,MAAO,MAC9C/S,EAAkBa,WAAWpE,GAEjC,GACC,CAAE6E,WACP,CAkKEoU,CAAoBpU,GAtFpBkC,SAASG,iBAAiB,oBAAoBzE,QAAS4J,IACrDA,EAAInG,UAAU0C,IAAI,mBAAoB,sBACtCyD,EAAI8B,QAAQ+K,SAAW,4BAsFzB1J,EAAgB3K,GAGZnG,OAAO4L,KAAK6O,QACdza,OAAO4L,IAAI6O,UAEX9O,GAEJ,CA9jBA3L,OAAOwR,gBAAkBA,EACzBxR,OAAO0H,YAAcA,EAmlBrBW,SAASxJ,iBAAiB,mBApB1B,YAxuCA,WACE,MAAM6b,EACJrS,SAASC,eAAe,iBACxBD,SAASC,eAAe,eACtBoS,IAASA,EAAOhR,YAAcjG,QAAO,IAAI/D,MAAOib,gBAEpD,MAAMC,EAAcvS,SAASC,eAAe,qBAC5C,GAAIsS,EAAa,CACf,MAAMhc,EAAO,CAAEic,KAAM,UAAWC,MAAO,OAAQC,IAAK,WACpDH,EAAYlR,aAAc,IAAIhK,MAAOsb,mBAAmB,QAASpc,GACjEgc,EAAY9R,aACV,uBACA,0BAEJ,CACF,CA2tCEmS,GAztCF,WACE5S,SAASyB,KAAK5B,GAAK,4BACnBG,SAASyB,KAAKtC,UAAU0C,IACtB,gBACA,kBACA,mBAGF,MAAMgR,EAAa7S,SAASK,cAAc,OAC1CwS,EAAWjS,MAAMkS,QAAU,OAC3BD,EAAWzL,QAAQ2L,eAAiB,0BACpCF,EAAWzL,QAAQ4L,QAAU,sBAC7BH,EAAWpS,aAAa,cAAe,QACvCoS,EAAWxR,YACT,uJACFrB,SAASyB,KAAKN,YAAY0R,GAE1B,MAAMI,EAAgBjT,SAASK,cAAc,QAC7C4S,EAAcha,KAAO,YACrBga,EAAcC,QACZ,mEACFlT,SAASqE,KAAKlD,YAAY8R,GAE1B,MAAME,EAAanT,SAASK,cAAc,QAC1C8S,EAAWla,KAAO,SAClBka,EAAWD,QAAU,0BACrBlT,SAASqE,KAAKlD,YAAYgS,EAC5B,CA+rCEC,GACArR,IAxkCF,WACE,MAAMsB,EAASrD,SAASC,eAAe,gBACnCoD,GAASA,EAAO5C,aAAa,aAAcjE,EAAgBkB,aAG/D4G,EADctM,EAAQ+B,OAAO,WACRE,EAAIe,MAAMP,KAAO,OAAS,UAE1C4I,IAELlN,EAAGkN,EAAQ,SAAU,KACnB,MAAMgQ,EAAOhQ,EAAOoB,QAAU,OAAS,QACvCH,EAAW+O,GAAM,GACjBrb,EAAQ8B,OAAO,QAASuZ,KAG1Bld,EAAGkN,EAAQ,UAAYrK,IACrB,GAAc,UAAVA,EAAEb,KAA6B,MAAVa,EAAEb,IAAa,CACtCa,EAAE+O,iBACF1E,EAAOoB,SAAWpB,EAAOoB,QACzB,MAAM4O,EAAOhQ,EAAOoB,QAAU,OAAS,QACvCH,EAAW+O,GAAM,GACjBrb,EAAQ8B,OAAO,QAASuZ,EAC1B,IAIFpZ,EAAI6B,SAAS,KACN9D,EAAQ+B,OAAO,UACnBuK,EAAWrK,EAAIe,MAAMP,KAAO,OAAS,WAE1C,CA2iCE6Y,GAtiCF,WACE,MAAMC,GAAiBtZ,EAAIe,MAAMR,QAEjCwF,SAASG,iBAAiB,gBAAkBzE,QAASwL,IACnD/Q,EAAG+Q,EAAG,QAAUlO,IACd,MAAMwa,EAAWtM,EAAEoG,aAAa,QAC1BlX,EAAK4J,SAASqF,cAAcmO,GAClC,IAAKpd,EAAK,OAEV4C,EAAE+O,iBAEF,MAAME,EAAOjI,SAASqF,cAAc,YAAY6C,cAAgB,EAC1DC,EACJnI,SAASC,eAAe,wBAAwBiI,cAAgB,EAC5DE,EAASC,WAAWrC,iBAAiB5P,GAAIkS,aAAe,EACxDC,EAAI/Q,KAAKC,IAAI,EAAGrB,EAAGoS,UAAYJ,EAASH,EAAOE,GAEjDoL,EACH5b,OAAOoP,SAAS,CAAEhG,IAAKwH,EAAGvB,SAAU,WAC/BrP,OAAOoP,SAAS,EAAGwB,GAEzBnK,EAAQ,CAAC,QAGf,CA+gCEqV,GAzgCAtd,EAAG6J,SAAU,QAAU0T,IACrB,MAAMC,EAAOD,EAAM1L,OAAO8J,UAAU,SAChC6B,IACFA,EAAKxU,UAAU0C,IAAI,eACnB8R,EAAKvM,QAAQwM,kBACX,0CACFxc,WAAW,IAAMuc,EAAKxU,UAAUnF,OAAO,eAAgB,KACvDoE,EAAQ,CAAC,MAGX,MAAMyV,EAAcH,EAAM1L,OAAO8J,UAC/B,sFAGA+B,GACCA,EAAY1U,UAAUe,SAAS,sBAC/B2T,EAAYxZ,QAAQ,kBAErBwZ,EAAY1U,UAAU0C,IAAI,yBAC1BgS,EAAYzM,QAAQ0M,WAClB,0EACFD,EAAYrd,iBACV,eACA,IAAMqd,EAAY1U,UAAUnF,OAAO,yBACnC,CAAEoF,MAAM,IAELyU,EAAY/B,QAAQ,cAAe1T,EAAQ,CAAC,IACjD0D,UAAU,YAId3L,EAAG6J,SAAU,UAAYhH,IACvB,GAAc,UAAVA,EAAEb,KAA6B,MAAVa,EAAEb,IAAc,OACzC,MAAMwb,EAAO3a,EAAEgP,OAAO8J,UAAU,SAC5B6B,IACF3a,EAAE+O,iBACF4L,EAAKlC,cAAc,IAAIsC,WAAW,QAAS,CAAEC,SAAS,QAu+B1DhP,IACA8G,IAlGF,WACE,IAAI8E,GAAY,EAEhB,MAAMqD,EAAUvd,EAAS,KACnBka,GAEFjZ,OAAO+N,YAAc/N,OAAOiO,SAC5B5F,SAASyB,KAAKyG,aAAe,KAE7B7I,EAAY7C,EAAkBG,WAAY,CACxCkD,GAAI,oBACJJ,YAAa,oBACbC,UAAW,wBACXC,UAAW,yBACXpB,SAAU,OAEZqS,GAAY,IAEb,KAEHza,EAAGwB,OAAQ,SAAUsc,EAAS,CAAEnN,SAAS,GAC3C,CA8EEoN,GAvqBF,WAEE,IAAIC,EAAM,GAEV,GAHmBnc,EAAQ+B,OAAO,cAGjBoa,EAAM3X,EAAkBQ,gBACpC,CACH,MAAMoX,GAAO,IAAI/c,MAAOgd,WACxBF,EACEC,GAAQ,GAAKA,EAAO,GAChB5X,EAAkBI,eAClBwX,EAAO,GACL5X,EAAkBK,YAClBuX,EAAO,GACL5X,EAAkBM,eAClBN,EAAkBO,aAC5B/E,EAAQ8B,OAAO,aAAc,OAC/B,CAEIqa,GACH9U,EAAY8U,EAAK,CAChBtU,GAAI,gBACJJ,YAAa,gBACbC,UAAW,uBACXC,UAAW,yBACXpB,SAAUtE,EAAIe,MAAMN,OAAS,KAAO,MAExC,CA8oBE4Z,GAGAtH,IAGAhN,SAASxJ,iBAAiB,iBAAkBwW,EAC9C,EAEoD,CAAE5N,MAAM,IAG5DnF,EAAI6B,SAAS,KAEXwH,MAIFnN,EAAGwB,OAAQ,WAAY,IAAMiG,EAASqP,QAAS,CAAE7N,MAAM,GACxD,CAtqDD","ignoreList":[],"sourcesContent":["/*\r\n  Mohammad Rasoul Sohrabi â€” Site UX Utilities (v2)\r\n  ORCID: 0009-0004-7177-2080\r\n*/\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  // ==========================\r\n  // Utilities & Environment\r\n  // ==========================\r\n\r\n  const noop = () => {};\r\n\r\n  // âš ï¸ Ù‚Ø¨Ù„Ø§Ù‹ Ù‡Ù…Ù‡â€ŒÚ†ÛŒ passive:true Ø¨ÙˆØ¯Ø› Ø§Ù„Ø§Ù† ÙÙ‚Ø· Ø¬Ø§ÛŒÛŒ Ú©Ù‡ Ù„Ø§Ø²Ù… Ø¯Ø§Ø±ÛŒÙ… passive:true Ù…ÛŒâ€ŒØ¯ÛŒÙ…\r\n  const on = (el, evt, fn, opts) =>\r\n    el &&\r\n    el.addEventListener &&\r\n    el.addEventListener(evt, fn, { capture: false, ...(opts || {}) });\r\n\r\n  const off = (el, evt, fn, opts) =>\r\n    el &&\r\n    el.removeEventListener &&\r\n    el.removeEventListener(evt, fn, { capture: false, ...(opts || {}) });\r\n\r\n  function throttle(fn, limit) {\r\n    let inThrottle, lastFunc, lastRan;\r\n    return function () {\r\n      const ctx = this;\r\n      const args = arguments;\r\n      if (!inThrottle) {\r\n        fn.apply(ctx, args);\r\n        lastRan = Date.now();\r\n        inThrottle = true;\r\n      } else {\r\n        clearTimeout(lastFunc);\r\n        lastFunc = setTimeout(function () {\r\n          if (Date.now() - lastRan >= limit) {\r\n            fn.apply(ctx, args);\r\n            lastRan = Date.now();\r\n          }\r\n        }, Math.max(0, limit - (Date.now() - lastRan)));\r\n      }\r\n    };\r\n  }\r\n\r\n  function debounce(fn, delay) {\r\n    let t;\r\n    return function () {\r\n      clearTimeout(t);\r\n      t = setTimeout(() => fn.apply(this, arguments), delay);\r\n    };\r\n  }\r\n\r\n  // requestIdleCallback polyfill (lightweight)\r\n  const ric =\r\n    window.requestIdleCallback ||\r\n    function (cb) {\r\n      return setTimeout(\r\n        () => cb({ timeRemaining: () => 0, didTimeout: true }),\r\n        1\r\n      );\r\n    };\r\n  const cic = window.cancelIdleCallback || clearTimeout;\r\n\r\n  // Safe localStorage access\r\n  const storage = {\r\n    get(key, fallback = null) {\r\n      try {\r\n        const v = localStorage.getItem(key);\r\n        return v === null ? fallback : JSON.parse(v);\r\n      } catch {\r\n        return fallback;\r\n      }\r\n    },\r\n    set(key, value) {\r\n      const maxRetries = 5;\r\n      let retryCount = 0;\r\n\r\n      const attemptSet = () => {\r\n        try {\r\n          localStorage.setItem(key, JSON.stringify(value));\r\n          return true;\r\n        } catch (e) {\r\n          if (e.name === \"QuotaExceededError\" && retryCount < maxRetries) {\r\n            retryCount++;\r\n\r\n            // Get sortable keys (excluding protected ones)\r\n            const oldKeys = Object.keys(localStorage).filter(k =>\r\n              ![\"theme\", \"hasVisited\"].includes(k)\r\n            );\r\n\r\n            if (oldKeys.length > 0) {\r\n              try {\r\n                // Remove oldest key first\r\n                localStorage.removeItem(oldKeys[0]);\r\n                return attemptSet(); // Recursive retry\r\n              } catch (innerE) {\r\n                console.error(`Failed to recover from quota exceeded for ${key}:`, innerE);\r\n                return false;\r\n              }\r\n            }\r\n          } else if (e.name === \"QuotaExceededError\") {\r\n            console.warn(`localStorage quota exceeded. Could not store ${key} after ${maxRetries} retries`);\r\n          } else {\r\n            console.error(`Failed to store ${key}:`, e);\r\n          }\r\n          return false;\r\n        }\r\n      };\r\n\r\n      return attemptSet();\r\n    },\r\n    setRaw(key, value) {\r\n      try {\r\n        localStorage.setItem(key, value);\r\n      } catch (e) {\r\n        if (e.name === \"QuotaExceededError\") {\r\n          console.warn(`localStorage quota exceeded. Could not store ${key}`);\r\n        } else {\r\n          console.error(`Failed to store ${key}:`, e);\r\n        }\r\n      }\r\n    },\r\n    getRaw(key, fallback = null) {\r\n      try {\r\n        const v = localStorage.getItem(key);\r\n        return v === null ? fallback : v;\r\n      } catch {\r\n        return fallback;\r\n      }\r\n    },\r\n    remove(key) {\r\n      try {\r\n        localStorage.removeItem(key);\r\n      } catch {}\r\n    },\r\n  };\r\n\r\n  // Live environment that reacts to userâ€™s system changes\r\n  const ENV = (() => {\r\n    const mq = (q) =>\r\n      window.matchMedia\r\n        ? window.matchMedia(q)\r\n        : { matches: false, addEventListener: noop, removeEventListener: noop };\r\n\r\n    const mqs = {\r\n      reduced: mq(\"(prefers-reduced-motion: reduce)\"),\r\n      dark: mq(\"(prefers-color-scheme: dark)\"),\r\n      coarse: mq(\"(pointer: coarse)\"),\r\n    };\r\n\r\n    const conn =\r\n      navigator.connection ||\r\n      navigator.mozConnection ||\r\n      navigator.webkitConnection;\r\n\r\n    const state = {\r\n      get reduced() {\r\n        return !!mqs.reduced.matches;\r\n      },\r\n      get dark() {\r\n        return !!mqs.dark.matches;\r\n      },\r\n      get coarse() {\r\n        return !!mqs.coarse.matches;\r\n      },\r\n      get saveData() {\r\n        return !!(conn && conn.saveData);\r\n      },\r\n      get lowThroughput() {\r\n        return !!(conn && /2g|slow-2g/.test(String(conn.effectiveType || \"\")));\r\n      },\r\n      get lowPowerCPU() {\r\n        return navigator.hardwareConcurrency\r\n          ? navigator.hardwareConcurrency <= 4\r\n          : false;\r\n      },\r\n    };\r\n\r\n    const listeners = [];\r\n    const notify = () => listeners.forEach((l) => l());\r\n\r\n    const bindMQL = (m) => {\r\n      if (m && m.addEventListener) {\r\n        m.addEventListener(\"change\", notify);\r\n      }\r\n    };\r\n\r\n    bindMQL(mqs.reduced);\r\n    bindMQL(mqs.dark);\r\n    bindMQL(mqs.coarse);\r\n\r\n    if (conn && conn.addEventListener) {\r\n      on(conn, \"change\", notify);\r\n    }\r\n\r\n    return { state, onChange: (fn) => listeners.push(fn) };\r\n  })();\r\n\r\n  const FLAGS = () => {\r\n    const s = ENV.state;\r\n    const low = s.saveData || s.lowThroughput;\r\n    return {\r\n      ENABLE_AOS: !s.coarse && !s.reduced && !low,\r\n      ENABLE_SOUNDS: !s.coarse && !s.reduced && !low,\r\n      ENABLE_HAPTICS: !s.reduced && s.coarse && !low,\r\n      ENABLE_CONFETTI: !s.reduced && !low && !s.coarse,\r\n      ENABLE_IDENTITY_PINGS: false,\r\n    };\r\n  };\r\n\r\n  // i18n (FA)\r\n  const STRINGS_FA = {\r\n    toasts: {\r\n      themeDark: \"ØªÙ… Ø¨Ù‡ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© ØªØºÛŒÛŒØ± ÛŒØ§ÙØª.\",\r\n      themeLight: \"ØªÙ… Ø¨Ù‡ Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù† ØªØºÛŒÛŒØ± ÛŒØ§ÙØª.\",\r\n      reachedEnd: \"Ø´Ù…Ø§ Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ø±Ø³ÛŒØ¯ÛŒØ¯. Ø§Ø² Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±Ù…. ğŸ‰\",\r\n      welcomeMorning: \"ØµØ¨Ø­ Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeNoon: \"Ø¸Ù‡Ø± Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeEvening: \"Ø¹ØµØ± Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeNight: \"Ø´Ø¨ Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeBack: \"Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø§Ø² Ø¨Ø§Ø²Ú¯Ø´Øª Ø´Ù…Ø§ Ø®Ø±Ø³Ù†Ø¯ÛŒÙ….\",\r\n      emailCopied: \"Ø§ÛŒÙ…ÛŒÙ„ Ú©Ù¾ÛŒ Ø´Ø¯. âœ…\",\r\n      emailCopyError: \"Ú©Ù¾ÛŒ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.\",\r\n      shareOk: \"Ù„ÛŒÙ†Ú© ØµÙØ­Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ú¯Ø°Ø§Ø´ØªÙ‡ Ø´Ø¯! âœ…\",\r\n      shareErr: \"Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.\",\r\n      linkCopied: (name) => `Ù„ÛŒÙ†Ú© ${name} Ú©Ù¾ÛŒ Ø´Ø¯! âœ…`,\r\n      clipboardUnsupported: \"Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.\",\r\n    },\r\n    funFactsPrefix: \"Ø¯Ø§Ù†Ø³ØªÙ†ÛŒ:\",\r\n    aria: {\r\n      closeToast: \"Ø¨Ø³ØªÙ† Ù¾ÛŒØ§Ù…\",\r\n      scrollTop: \"Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡\",\r\n      share: \"Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡\",\r\n      themeToggle: \"ØªØºÛŒÛŒØ± ØªÙ… Ø³Ø§ÛŒØª\",\r\n    },\r\n  };\r\n\r\n  const FUN_FACTS_FA = [\r\n    \"Ø¹Ø³Ù„ Ù‡ÛŒÚ†â€ŒÚ¯Ø§Ù‡ ÙØ§Ø³Ø¯ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯.\",\r\n    \"Ù‡Ø´Øªâ€ŒÙ¾Ø§ÛŒØ§Ù† Ø³Ù‡ Ù‚Ù„Ø¨ Ø¯Ø§Ø±Ù†Ø¯.\",\r\n    \"Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù† Ø­Ø¯ÙˆØ¯ Û¶Û°Ùª Ø§Ø² Ø¢Ø¨ ØªØ´Ú©ÛŒÙ„ Ø´Ø¯Ù‡ Ø§Ø³Øª.\",\r\n    \"Ù…ÙˆØ² Ø¯Ø± ÙˆØ§Ù‚Ø¹ ÛŒÚ© Ù†ÙˆØ¹ ØªÙˆØª Ù…Ø­Ø³ÙˆØ¨ Ù…ÛŒâ€ŒØ´ÙˆØ¯.\",\r\n    \"Ø¯Ù„ÙÛŒÙ†â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ø¨ ØªÙ†Ù‡Ø§ Ù†ÛŒÙ…ÛŒ Ø§Ø² Ù…ØºØ² Ø®ÙˆØ¯ Ø±Ø§ Ø®Ø§Ù…ÙˆØ´ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.\",\r\n  ];\r\n\r\n  // Abort controller for idle/async work cleanup\r\n  const teardown = new AbortController();\r\n  const { signal: abortSignal } = teardown;\r\n\r\n  // Controller for dynamic content (re-initialized on includesLoaded)\r\n  let dynamicController = new AbortController();\r\n\r\n  // ==========================\r\n  // Haptics / Vibrate\r\n  // ==========================\r\n  function vibrate(pattern = [50]) {\r\n    if (!FLAGS().ENABLE_HAPTICS || ENV.state.reduced) {return;}\r\n    if (navigator.vibrate) {navigator.vibrate(pattern);}\r\n  }\r\n\r\n  // ==========================\r\n  // Audio (click/toast) â€” lazy, mobile-safe\r\n  // ==========================\r\n  let audioContext, clickBuffer, toastBuffer;\r\n\r\n  function ensureAudioContext() {\r\n    if (!FLAGS().ENABLE_SOUNDS || audioContext) {return;}\r\n    const Ctx = window.AudioContext || window.webkitAudioContext;\r\n    if (Ctx) {audioContext = new Ctx();}\r\n  }\r\n\r\n  function createToneBuffer(duration, wave) {\r\n    if (!audioContext) {return null;}\r\n    const sr = audioContext.sampleRate;\r\n    const buffer = audioContext.createBuffer(\r\n      1,\r\n      Math.max(1, Math.floor(sr * duration)),\r\n      sr\r\n    );\r\n    const data = buffer.getChannelData(0);\r\n    for (let i = 0; i < data.length; i++) {data[i] = wave(i, sr);}\r\n    return buffer;\r\n  }\r\n\r\n  function loadSounds() {\r\n    if (!audioContext) {return;}\r\n    clickBuffer = createToneBuffer(\r\n      0.05,\r\n      (i, sr) => Math.sin(2 * Math.PI * 440 * (i / sr)) * 0.08\r\n    );\r\n    toastBuffer = createToneBuffer(0.1, (i, sr) => {\r\n      const t = i / sr;\r\n      const d = 0.1;\r\n      const f = 880 + (1200 - 880) * (t / d);\r\n      return Math.sin(2 * Math.PI * f * t) * 0.12 * Math.max(0, 1 - t / d);\r\n    });\r\n  }\r\n\r\n  on(\r\n    document,\r\n    \"pointerdown\",\r\n    () => {\r\n      ensureAudioContext();\r\n      audioContext?.resume?.();\r\n      loadSounds();\r\n    },\r\n    { once: true }\r\n  );\r\n\r\n  on(document, \"visibilitychange\", () => {\r\n    if (document.hidden) {audioContext?.suspend?.();}\r\n    else {audioContext?.resume?.();}\r\n  });\r\n\r\n  // ==========================\r\n  // Toasts (CSS-driven)\r\n  // ==========================\r\n  function dismissToast(toast) {\r\n    if (!toast) {return;}\r\n    toast.classList.remove(\"show\");\r\n    toast.addEventListener(\r\n      \"transitionend\",\r\n      () => toast.remove(),\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  function createToast(message, options = {}) {\r\n    const defaults = {\r\n      duration: 2500,\r\n      customClass: \"\",\r\n      iconClass: \"\",\r\n      iconColor: \"\",\r\n      position: \"bottom\",\r\n      id: \"\",\r\n      closeButton: false,\r\n    };\r\n    const settings = { ...defaults, ...options };\r\n\r\n    if (settings.id) {\r\n      const existing = document.getElementById(settings.id);\r\n      if (existing && existing.classList.contains(\"show\")) {return existing;}\r\n    }\r\n\r\n    document.querySelectorAll(\".dynamic-toast\").forEach((t) => {\r\n      if (!settings.id || t.id !== settings.id) {\r\n        t.classList.remove(\"show\");\r\n        t.addEventListener(\r\n          \"transitionend\",\r\n          () => t.remove(),\r\n          { once: true }\r\n        );\r\n      }\r\n    });\r\n\r\n    const toast = document.createElement(\"div\");\r\n    toast.className = `dynamic-toast ${settings.customClass}`.trim();\r\n    toast.role = \"status\";\r\n    toast.setAttribute(\"aria-live\", \"polite\");\r\n    toast.tabIndex = -1;\r\n    if (settings.id) {toast.id = settings.id;}\r\n\r\n    Object.assign(toast.style, {\r\n      position: \"fixed\",\r\n      left: \"50%\",\r\n      transform: \"translateX(-50%)\",\r\n    });\r\n\r\n    if (settings.position === \"top\") {\r\n      toast.style.top = \"20px\";\r\n      toast.style.bottom = \"auto\";\r\n    } else {\r\n      toast.style.bottom = \"20px\";\r\n      toast.style.top = \"auto\";\r\n    }\r\n\r\n    if (settings.iconClass) {\r\n      const icon = document.createElement(\"i\");\r\n      icon.className = settings.iconClass;\r\n      if (settings.iconColor) {icon.style.color = settings.iconColor;}\r\n      icon.setAttribute(\"aria-hidden\", \"true\");\r\n      toast.appendChild(icon);\r\n    }\r\n\r\n    const text = document.createElement(\"span\");\r\n    text.className = \"toast-message\";\r\n    text.textContent = message;\r\n    toast.appendChild(text);\r\n\r\n    if (settings.closeButton) {\r\n      const closeBtn = document.createElement(\"button\");\r\n      closeBtn.type = \"button\";\r\n      closeBtn.className = \"fun-fact-close\";\r\n      closeBtn.setAttribute(\"aria-label\", STRINGS_FA.aria.closeToast);\r\n      closeBtn.innerHTML = \"<i class=\\\"fas fa-times\\\" aria-hidden=\\\"true\\\"></i>\";\r\n      on(closeBtn, \"click\", () => dismissToast(toast));\r\n      toast.appendChild(closeBtn);\r\n    }\r\n\r\n    document.body.appendChild(toast);\r\n\r\n    // Use microtask to avoid frame starvation while ensuring proper timing\r\n    Promise.resolve().then(() => {\r\n      toast.classList.add(\"show\");\r\n      if (FLAGS().ENABLE_SOUNDS && audioContext) {\r\n        playSound(\"toast\");\r\n      }\r\n    });\r\n\r\n    if (settings.duration > 0) {\r\n      setTimeout(() => dismissToast(toast), settings.duration);\r\n    }\r\n\r\n    return toast;\r\n  }\r\n\r\n  // ==========================\r\n  // Dates & Identity\r\n  // ==========================\r\n  function setDynamicDates() {\r\n    const yearEl =\r\n      document.getElementById(\"current-year\") ||\r\n      document.getElementById(\"footer-year\");\r\n    if (yearEl) {yearEl.textContent = String(new Date().getFullYear());}\r\n\r\n    const lastUpdated = document.getElementById(\"last-updated-date\");\r\n    if (lastUpdated) {\r\n      const opts = { year: \"numeric\", month: \"long\", day: \"numeric\" };\r\n      lastUpdated.textContent = new Date().toLocaleDateString(\"fa-IR\", opts);\r\n      lastUpdated.setAttribute(\r\n        \"data-last-updated-by\",\r\n        \"Mohammad Rasoul Sohrabi\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function setIdentityHooks() {\r\n    document.body.id = \"sohrabi-verified-identity\";\r\n    document.body.classList.add(\r\n      \"sohrabi-orcid\",\r\n      \"github-verified\",\r\n      \"academic-entity\"\r\n    );\r\n\r\n    const hiddenInfo = document.createElement(\"div\");\r\n    hiddenInfo.style.display = \"none\";\r\n    hiddenInfo.dataset.authorFullName = \"Mohammad Rasoul Sohrabi\";\r\n    hiddenInfo.dataset.orcidId = \"0009-0004-7177-2080\";\r\n    hiddenInfo.setAttribute(\"aria-hidden\", \"true\");\r\n    hiddenInfo.textContent =\r\n      \"Mohammad Rasoul Sohrabi is a verified contributor on ORCID, Zenodo, GitHub, and Wikipedia. Known for Persian Bot and biomedical engineering content.\";\r\n    document.body.appendChild(hiddenInfo);\r\n\r\n    const metaGenerator = document.createElement(\"meta\");\r\n    metaGenerator.name = \"generator\";\r\n    metaGenerator.content =\r\n      \"Mohammad Rasoul Sohrabi - Biomedical Engineering, ORCID Verified\";\r\n    document.head.appendChild(metaGenerator);\r\n\r\n    const metaAuthor = document.createElement(\"meta\");\r\n    metaAuthor.name = \"author\";\r\n    metaAuthor.content = \"Mohammad Rasoul Sohrabi\";\r\n    document.head.appendChild(metaAuthor);\r\n  }\r\n\r\n  function queueIdentityPings() {\r\n    if (\r\n      !FLAGS().ENABLE_IDENTITY_PINGS ||\r\n      ENV.state.coarse ||\r\n      ENV.state.saveData\r\n    )\r\n    {return;}\r\n\r\n    const targets = [\r\n      { name: \"GitHub\", url: \"https://github.com/RasoulUnlimited\" },\r\n      {\r\n        name: \"LinkedIn\",\r\n        url: \"https://www.linkedin.com/in/rasoulunlimited/\",\r\n      },\r\n      {\r\n        name: \"ResearchGate\",\r\n        url: \"https://www.researchgate.net/profile/Mohammad-Rasoul-Sohrabi\",\r\n      },\r\n      { name: \"About.me\", url: \"https://about.me/rasoulunlimited\" },\r\n      { name: \"ORCID\", url: \"https://orcid.org/0009-0004-7177-2080\" },\r\n    ];\r\n\r\n    const ping = (t) => fetch(t.url, { mode: \"no-cors\" }).catch(() => {});\r\n\r\n    ric(() =>\r\n      targets.forEach((t, i) =>\r\n        setTimeout(() => {\r\n          if (abortSignal.aborted) {return;}\r\n          ping(t);\r\n        }, i * 1000)\r\n      )\r\n    );\r\n  }\r\n\r\n  // ==========================\r\n  // AOS (Animations) â€” gated\r\n  // ==========================\r\n  let aosLoaded = false;\r\n\r\n  function setAOSDisabledCSS(disabled) {\r\n    document.documentElement.classList.toggle(\"aos-disabled\", disabled);\r\n  }\r\n\r\n  function initAOS() {\r\n    if (!FLAGS().ENABLE_AOS) {\r\n      setAOSDisabledCSS(true);\r\n      return;\r\n    }\r\n\r\n    setAOSDisabledCSS(false);\r\n\r\n    if (aosLoaded && window.AOS?.init) {\r\n      window.AOS.init({\r\n        startEvent: \"DOMContentLoaded\",\r\n        initClassName: \"aos-init\",\r\n        animatedClassName: \"aos-animate\",\r\n        debounceDelay: 50,\r\n        throttleDelay: 99,\r\n        offset: 120,\r\n        duration: 500,\r\n        easing: \"ease-out\",\r\n        once: false,\r\n        mirror: false,\r\n        anchorPlacement: \"top-bottom\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (window.AOS?.init) {\r\n      aosLoaded = true;\r\n      return initAOS();\r\n    }\r\n\r\n    if (aosLoaded) {return;}\r\n\r\n    const s = document.createElement(\"script\");\r\n    s.src = \"/assets/vendor/aos/aos.min.js\";\r\n    s.defer = true;\r\n    s.onload = () => {\r\n      aosLoaded = true;\r\n      initAOS();\r\n    };\r\n    document.head.appendChild(s);\r\n  }\r\n\r\n  // ==========================\r\n  // Theme Handling\r\n  // ==========================\r\n  function applyTheme(theme, showToast = false) {\r\n    document.body.classList.toggle(\"dark-mode\", theme === \"dark\");\r\n    document.body.classList.toggle(\"light-mode\", theme === \"light\");\r\n\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle) {toggle.checked = theme === \"dark\";}\r\n\r\n    if (showToast) {\r\n      // Toast is handled by main-script-base.js to avoid duplicates\r\n      /*\r\n      createToast(\r\n        theme === \"dark\"\r\n          ? STRINGS_FA.toasts.themeDark\r\n          : STRINGS_FA.toasts.themeLight,\r\n        {\r\n          id: \"theme-change-toast\",\r\n          customClass: \"theme-toast\",\r\n          iconClass: theme === \"dark\" ? \"fas fa-moon\" : \"fas fa-sun\",\r\n          iconColor: theme === \"dark\" ? \"white\" : \"var(--highlight-color)\",\r\n          position: \"top\",\r\n          duration: 2200,\r\n        }\r\n      );\r\n      */\r\n      const parent = toggle?.parentElement;\r\n      if (parent) {createSparkle(parent);}\r\n      vibrate([30]);\r\n    }\r\n  }\r\n\r\n  function initTheme() {\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle) {toggle.setAttribute(\"aria-label\", STRINGS_FA.aria.themeToggle);}\r\n\r\n    const saved = storage.getRaw(\"theme\");\r\n    applyTheme(saved || (ENV.state.dark ? \"dark\" : \"light\"));\r\n\r\n    if (!toggle) {return;}\r\n\r\n    on(toggle, \"change\", () => {\r\n      const next = toggle.checked ? \"dark\" : \"light\";\r\n      applyTheme(next, true);\r\n      storage.setRaw(\"theme\", next);\r\n    });\r\n\r\n    on(toggle, \"keydown\", (e) => {\r\n      if (e.key === \"Enter\" || e.key === \" \") {\r\n        e.preventDefault();\r\n        toggle.checked = !toggle.checked;\r\n        const next = toggle.checked ? \"dark\" : \"light\";\r\n        applyTheme(next, true);\r\n        storage.setRaw(\"theme\", next);\r\n      }\r\n    });\r\n\r\n    // auto-switch if system theme changes and user hasn't chosen explicitly\r\n    ENV.onChange(() => {\r\n      if (!storage.getRaw(\"theme\"))\r\n      {applyTheme(ENV.state.dark ? \"dark\" : \"light\");}\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Smooth Anchor Scrolling (respects reduced motion)\r\n  // ==========================\r\n  function initAnchorScrolling() {\r\n    const smoothAllowed = !ENV.state.reduced;\r\n\r\n    document.querySelectorAll(\"a[href^=\\\"#\\\"]\").forEach((a) => {\r\n      on(a, \"click\", (e) => {\r\n        const targetId = a.getAttribute(\"href\");\r\n        const el = document.querySelector(targetId);\r\n        if (!el) {return;}\r\n\r\n        e.preventDefault();\r\n\r\n        const navH = document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n        const progH =\r\n          document.getElementById(\"scroll-progress-bar\")?.offsetHeight || 0;\r\n        const padTop = parseFloat(getComputedStyle(el).paddingTop) || 0;\r\n        const y = Math.max(0, el.offsetTop + padTop - navH - progH);\r\n\r\n        if (smoothAllowed)\r\n        {window.scrollTo({ top: y, behavior: \"smooth\" });}\r\n        else {window.scrollTo(0, y);}\r\n\r\n        vibrate([20]);\r\n      });\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Click Feedback\r\n  // ==========================\r\n  function initClickEffects() {\r\n    on(document, \"click\", (event) => {\r\n      const card = event.target.closest?.(\".card\");\r\n      if (card) {\r\n        card.classList.add(\"clicked-pop\");\r\n        card.dataset.interactionSource =\r\n          \"Mohammad Rasoul Sohrabi user engagement\";\r\n        setTimeout(() => card.classList.remove(\"clicked-pop\"), 300);\r\n        vibrate([30]);\r\n      }\r\n\r\n      const interactive = event.target.closest?.(\r\n        \"button, a:not([href^=\\\"#\\\"]), input[type=\\\"submit\\\"], [role=\\\"button\\\"], [tabindex=\\\"0\\\"]\"\r\n      );\r\n      if (\r\n        interactive &&\r\n        !interactive.classList.contains(\"no-click-feedback\") &&\r\n        !interactive.matches(\"a[href^=\\\"#\\\"]\")\r\n      ) {\r\n        interactive.classList.add(\"click-feedback-effect\");\r\n        interactive.dataset.userAction =\r\n          \"verified interaction by Mohammad Rasoul Sohrabi's website functionality\";\r\n        interactive.addEventListener(\r\n          \"animationend\",\r\n          () => interactive.classList.remove(\"click-feedback-effect\"),\r\n          { once: true }\r\n        );\r\n        if (!interactive.closest(\".faq-item\")) {vibrate([8]);}\r\n        playSound(\"click\");\r\n      }\r\n    });\r\n\r\n    on(document, \"keydown\", (e) => {\r\n      if (e.key !== \"Enter\" && e.key !== \" \") {return;}\r\n      const card = e.target.closest?.(\".card\");\r\n      if (card) {\r\n        e.preventDefault();\r\n        card.dispatchEvent(new MouseEvent(\"click\", { bubbles: true }));\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // rAF Task Queue\r\n  // ==========================\r\n  const rafTasks = new Set();\r\n  let rafPending = false;\r\n\r\n  function scheduleRaf(fn) {\r\n    rafTasks.add(fn);\r\n    if (!rafPending) {\r\n      rafPending = true;\r\n      requestAnimationFrame(() => {\r\n        rafPending = false;\r\n        const tasks = Array.from(rafTasks);\r\n        rafTasks.clear();\r\n        tasks.forEach((t) => {\r\n          try {\r\n            t();\r\n          } catch {}\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Scroll Progress + Scroll-to-top + Explore Hint\r\n  // ==========================\r\n  function initScrollUI() {\r\n    let bar = document.getElementById(\"scroll-progress-bar\");\r\n    if (!bar) {\r\n      bar = document.createElement(\"div\");\r\n      bar.id = \"scroll-progress-bar\";\r\n      bar.className = \"sohrabi-progress\";\r\n      bar.role = \"progressbar\";\r\n      bar.setAttribute(\"aria-valuemin\", \"0\");\r\n      bar.setAttribute(\"aria-valuemax\", \"100\");\r\n      const inner = document.createElement(\"div\");\r\n      inner.className = \"sohrabi-progress-inner\";\r\n      bar.appendChild(inner);\r\n      document.body.prepend(bar);\r\n    }\r\n    const innerBar = bar.querySelector(\".sohrabi-progress-inner\") || bar;\r\n\r\n    let btn = document.getElementById(\"scroll-to-top\");\r\n    if (!btn) {\r\n      btn = document.createElement(\"button\");\r\n      btn.id = \"scroll-to-top\";\r\n      btn.type = \"button\";\r\n      btn.innerHTML = \"<i class=\\\"fas fa-arrow-up\\\" aria-hidden=\\\"true\\\"></i>\";\r\n      btn.setAttribute(\"aria-label\", STRINGS_FA.aria.scrollTop);\r\n      btn.classList.add(\"sohrabi-nav-button\", \"hidden\", \"cta-pulse-effect\");\r\n      document.body.appendChild(btn);\r\n    }\r\n\r\n    function update() {\r\n      const total = Math.max(\r\n        1,\r\n        document.documentElement.scrollHeight - window.innerHeight\r\n      );\r\n      const scrolled = window.scrollY;\r\n      const progress = Math.min(1, Math.max(0, scrolled / total));\r\n\r\n      innerBar.style.transform = `scaleX(${progress})`;\r\n\r\n      const rootStyle = getComputedStyle(document.documentElement);\r\n      const primary =\r\n        rootStyle.getPropertyValue(\"--primary-color\") || \"gray\";\r\n      const accent =\r\n        rootStyle.getPropertyValue(\"--accent-color\") || \"dodgerblue\";\r\n      const highlight =\r\n        rootStyle.getPropertyValue(\"--highlight-color\") || \"gold\";\r\n\r\n      innerBar.style.backgroundColor =\r\n        progress > 0.9 ? highlight : progress > 0.5 ? accent : primary;\r\n\r\n      bar.setAttribute(\"aria-valuenow\", String(Math.round(progress * 100)));\r\n\r\n      btn.classList.toggle(\"visible\", scrolled > 300);\r\n      btn.classList.toggle(\"hidden\", scrolled <= 300);\r\n    }\r\n\r\n    const onScrollResize = () => scheduleRaf(update);\r\n    on(window, \"scroll\", onScrollResize, { passive: true });\r\n    on(window, \"resize\", onScrollResize);\r\n    update();\r\n\r\n    on(btn, \"click\", () => {\r\n      const smooth =\r\n        !ENV.state.reduced &&\r\n        \"scrollBehavior\" in document.documentElement.style;\r\n      if (smooth) {window.scrollTo({ top: 0, behavior: \"smooth\" });}\r\n      else {window.scrollTo(0, 0);}\r\n      vibrate([16]);\r\n    });\r\n\r\n    const exploreHint =\r\n      document.getElementById(\"explore-hint\") ||\r\n      (() => {\r\n        const a = document.createElement(\"a\");\r\n        a.href = \"#projects\";\r\n        a.id = \"explore-hint\";\r\n        a.innerHTML =\r\n          \"<i class=\\\"fas fa-lightbulb\\\" aria-hidden=\\\"true\\\"></i> <span class=\\\"hint-text\\\">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù† Ø±Ø§ Ú©Ø´Ù Ú©Ù†ÛŒØ¯.</span>\";\r\n        a.dataset.hintAuthor = \"Mohammad Rasoul Sohrabi\";\r\n        a.classList.add(\"sohrabi-hint-module\", \"hidden\");\r\n        document.body.appendChild(a);\r\n        return a;\r\n      })();\r\n\r\n    const hero = document.getElementById(\"hero\");\r\n    if (hero) {\r\n      const obs = new IntersectionObserver(\r\n        (entries) => {\r\n          entries.forEach((entry) => {\r\n            exploreHint.classList.toggle(\r\n              \"visible\",\r\n              entry.isIntersecting\r\n            );\r\n            exploreHint.classList.toggle(\r\n              \"pulse-animation\",\r\n              entry.isIntersecting\r\n            );\r\n            exploreHint.classList.toggle(\r\n              \"hidden\",\r\n              !entry.isIntersecting\r\n            );\r\n          });\r\n        },\r\n        { threshold: 0.5 }\r\n      );\r\n      obs.observe(hero);\r\n      on(\r\n        window,\r\n        \"beforeunload\",\r\n        () => obs.disconnect(),\r\n        { once: true }\r\n      );\r\n    }\r\n\r\n    on(exploreHint, \"click\", (e) => {\r\n      e.preventDefault();\r\n      exploreHint.classList.add(\"hidden\");\r\n      exploreHint.classList.remove(\"visible\", \"pulse-animation\");\r\n\r\n      const target = document.querySelector(\"#projects\");\r\n      if (target) {\r\n        const navH = document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n        const progH =\r\n          document.getElementById(\"scroll-progress-bar\")?.offsetHeight ||\r\n          0;\r\n        const padTop =\r\n          parseFloat(getComputedStyle(target).paddingTop) || 0;\r\n        const y = Math.max(\r\n          0,\r\n          target.offsetTop + padTop - navH - progH\r\n        );\r\n        const smooth = !ENV.state.reduced;\r\n        if (smooth) {window.scrollTo({ top: y, behavior: \"smooth\" });}\r\n        else {window.scrollTo(0, y);}\r\n      }\r\n      vibrate([16]);\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Skills hover microcopy\r\n  // ==========================\r\n  function initSkillsHover(signal) {\r\n    const list = document.querySelector(\"#skills .skills-list\");\r\n    if (!list) {return;}\r\n\r\n    list.querySelectorAll(\"li\").forEach((li) => {\r\n      li.dataset.skillOwner = \"Mohammad Rasoul Sohrabi\";\r\n      li.classList.add(\"sohrabi-skill-item\");\r\n\r\n      let hideTimeout;\r\n\r\n      function getSpan() {\r\n        let s = li.querySelector(\".skill-hover-message\");\r\n        if (!s) {\r\n          s = document.createElement(\"span\");\r\n          s.className = \"skill-hover-message\";\r\n          li.appendChild(s);\r\n        }\r\n        return s;\r\n      }\r\n\r\n      on(li, \"mouseenter\", () => {\r\n        clearTimeout(hideTimeout);\r\n        const span = getSpan();\r\n        if (!span.classList.contains(\"show-message\")) {\r\n          span.textContent =\r\n            FUN_FACTS_FA[(Math.random() * FUN_FACTS_FA.length) | 0];\r\n          Object.assign(span.style, {\r\n            opacity: \"1\",\r\n            transform: \"translateY(-5px)\",\r\n          });\r\n          span.classList.add(\"show-message\");\r\n        }\r\n        li.classList.add(\"skill-hover-effect\");\r\n      }, { signal });\r\n\r\n      on(li, \"mouseleave\", () => {\r\n        const span = li.querySelector(\".skill-hover-message\");\r\n        if (span) {\r\n          hideTimeout = setTimeout(() => {\r\n            span.style.opacity = \"0\";\r\n            span.style.transform = \"translateY(0)\";\r\n            span.classList.remove(\"show-message\");\r\n          }, 180);\r\n        }\r\n        li.classList.remove(\"skill-hover-effect\");\r\n      }, { signal });\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // FAQ Accordion (ARIA preserved)\r\n  // ==========================\r\n  function initFAQ(signal) {\r\n    const container = document.querySelector(\".faq-container\");\r\n    if (!container) {return;}\r\n\r\n    container.id = \"sohrabi-faq-verified\";\r\n\r\n    const items = [...document.querySelectorAll(\".faq-item\")];\r\n\r\n    items.forEach((item, idx) => {\r\n      const summary = item.querySelector(\"summary\");\r\n      const answer = item.querySelector(\"p\");\r\n      const qId = item.dataset.questionId || `faq-q-${idx + 1}`;\r\n      if (!summary) {return;}\r\n\r\n      summary.dataset.faqAuthor = \"Mohammad Rasoul Sohrabi\";\r\n\r\n      if (!summary.hasAttribute(\"aria-expanded\"))\r\n      {summary.setAttribute(\"aria-expanded\", item.open ? \"true\" : \"false\");}\r\n\r\n      if (answer) {\r\n        if (!answer.id) {answer.id = `faq-answer-${qId}`;}\r\n        if (!summary.hasAttribute(\"aria-controls\"))\r\n        {summary.setAttribute(\"aria-controls\", answer.id);}\r\n\r\n        Object.assign(answer.style, {\r\n          maxHeight: item.open ? \"2000px\" : \"0px\",\r\n          overflow: \"hidden\",\r\n          transition:\r\n            \"max-height .4s cubic-bezier(0.68,-0.55,0.27,1.55), padding .4s cubic-bezier(0.68,-0.55,0.27,1.55), opacity .4s ease-out\",\r\n          paddingTop: item.open ? \"1.6rem\" : \"0\",\r\n          paddingBottom: item.open ? \"2.8rem\" : \"0\",\r\n          opacity: item.open ? \"1\" : \"0\",\r\n        });\r\n      }\r\n\r\n      on(summary, \"click\", (e) => {\r\n        if (e.target.tagName === \"A\") {return;}\r\n        e.preventDefault();\r\n        createSparkle(summary);\r\n\r\n        items.forEach((other) => {\r\n          if (other !== item && other.open) {toggleFAQ(other, false);}\r\n        });\r\n\r\n        toggleFAQ(item, !item.open);\r\n      }, { signal });\r\n    });\r\n\r\n    function toggleFAQ(item, open, scrollIntoView = false) {\r\n      item.open = open;\r\n      const summary = item.querySelector(\"summary\");\r\n      const answer = item.querySelector(\"p\");\r\n\r\n      if (summary)\r\n      {summary.setAttribute(\"aria-expanded\", open ? \"true\" : \"false\");}\r\n\r\n      if (answer) {\r\n        answer.style.maxHeight = open ? \"2000px\" : \"0px\";\r\n        answer.style.paddingTop = open ? \"1.6rem\" : \"0\";\r\n        answer.style.paddingBottom = open ? \"2.8rem\" : \"0\";\r\n        answer.style.opacity = open ? \"1\" : \"0\";\r\n      }\r\n\r\n      if (scrollIntoView && open) {\r\n        setTimeout(() => {\r\n          const navH =\r\n            document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n          item.scrollIntoView({\r\n            behavior: ENV.state.reduced ? \"auto\" : \"smooth\",\r\n            block: \"start\",\r\n          });\r\n          setTimeout(() => {\r\n            const rect = item.getBoundingClientRect();\r\n            if (rect.top < navH)\r\n            {window.scrollBy({\r\n              top: rect.top - navH,\r\n              behavior: ENV.state.reduced ? \"auto\" : \"smooth\",\r\n            });}\r\n          }, 90);\r\n        }, 80);\r\n      }\r\n    }\r\n\r\n    // deep-link check\r\n    const hash = window.location.hash;\r\n    if (hash) {\r\n      const target = document.querySelector(hash);\r\n      if (target && target.classList.contains(\"faq-item\")) {\r\n        items.forEach(\r\n          (it) => it !== target && it.open && toggleFAQ(it, false)\r\n        );\r\n        toggleFAQ(target, true, true);\r\n      }\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Welcome Toast\r\n  // ==========================\r\n  function showWelcomeToast() {\r\n    const hasVisited = storage.getRaw(\"hasVisited\");\r\n    let msg = \"\";\r\n\r\n    if (hasVisited) {msg = STRINGS_FA.toasts.welcomeBack;}\r\n    else {\r\n      const hour = new Date().getHours();\r\n      msg =\r\n        hour >= 5 && hour < 10\r\n          ? STRINGS_FA.toasts.welcomeMorning\r\n          : hour < 16\r\n            ? STRINGS_FA.toasts.welcomeNoon\r\n            : hour < 20\r\n              ? STRINGS_FA.toasts.welcomeEvening\r\n              : STRINGS_FA.toasts.welcomeNight;\r\n      storage.setRaw(\"hasVisited\", \"true\");\r\n    }\r\n\r\n    if (msg)\r\n    {createToast(msg, {\r\n      id: \"welcome-toast\",\r\n      customClass: \"welcome-toast\",\r\n      iconClass: \"fas fa-hand-sparkles\",\r\n      iconColor: \"var(--highlight-color)\",\r\n      duration: ENV.state.coarse ? 2500 : 3500,\r\n    });}\r\n  }\r\n\r\n  // ==========================\r\n  // Email copy helper\r\n  // ==========================\r\n  function initEmailCopy(signal) {\r\n    const emailLink = document.querySelector(\r\n      \".contact-info a[href^=\\\"mailto:\\\"]\"\r\n    );\r\n    if (!emailLink) {return;}\r\n\r\n    emailLink.dataset.contactPerson = \"Mohammad Rasoul Sohrabi\";\r\n    emailLink.classList.add(\"sohrabi-contact-method\");\r\n\r\n    on(\r\n      emailLink,\r\n      \"click\",\r\n      async (e) => {\r\n        e.preventDefault();\r\n        const email = emailLink.href.replace(\"mailto:\", \"\");\r\n        try {\r\n          await navigator.clipboard.writeText(email);\r\n          createToast(STRINGS_FA.toasts.emailCopied, {\r\n            id: \"email-copy-toast\",\r\n            iconClass: \"fas fa-check-circle\",\r\n            iconColor: \"var(--highlight-color)\",\r\n            duration: 1600,\r\n          });\r\n          vibrate([40]);\r\n        } catch (err) {\r\n          console.error(\"Clipboard error:\", err);\r\n          createToast(STRINGS_FA.toasts.emailCopyError, {\r\n            id: \"copy-error-toast\",\r\n            iconClass: \"fas fa-exclamation-triangle\",\r\n            iconColor: \"red\",\r\n            duration: 2800,\r\n          });\r\n        }\r\n      },\r\n      { passive: false, signal }\r\n    );\r\n  }\r\n\r\n  // ==========================\r\n  // Clipboard generic\r\n  // ==========================\r\n  async function copyToClipboard(text, okId, errId, okMsg) {\r\n    try {\r\n      await navigator.clipboard.writeText(text);\r\n      createToast(okMsg, {\r\n        id: okId,\r\n        iconClass: \"fas fa-check-circle\",\r\n        iconColor: \"var(--highlight-color)\",\r\n        duration: 1600,\r\n      });\r\n      vibrate([40]);\r\n    } catch (err) {\r\n      console.error(\"Clipboard error:\", err);\r\n      createToast(STRINGS_FA.toasts.clipboardUnsupported, {\r\n        id: errId,\r\n        iconClass: \"fas fa-exclamation-triangle\",\r\n        iconColor: \"red\",\r\n        duration: 2800,\r\n      });\r\n    }\r\n  }\r\n\r\n  window.copyToClipboard = copyToClipboard;\r\n  window.createToast = createToast;\r\n\r\n  // ==========================\r\n  // Lazy Images (IO + decoding=async)\r\n  // ==========================\r\n  function initLazyImages(signal) {\r\n    const lazyImages = document.querySelectorAll(\"img[data-src]\");\r\n    if (!lazyImages.length) {return;}\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries, obs) => {\r\n        entries.forEach((entry) => {\r\n          if (!entry.isIntersecting) {return;}\r\n          const img = entry.target;\r\n\r\n          img.decoding = \"async\";\r\n          img.loading = \"lazy\";\r\n          img.classList.add(\"is-loading\");\r\n          img.dataset.imageLoader =\r\n            \"Mohammad Rasoul Sohrabi's optimized script\";\r\n\r\n          img.src = img.dataset.src;\r\n          if (img.dataset.srcset) {img.srcset = img.dataset.srcset;}\r\n\r\n          img.onload = () => {\r\n            img.classList.remove(\"is-loading\");\r\n            img.classList.add(\"loaded\");\r\n            img.removeAttribute(\"data-src\");\r\n            img.removeAttribute(\"data-srcset\");\r\n          };\r\n\r\n          img.onerror = () => {\r\n            console.error(\"Failed to load image:\", img.src);\r\n            img.classList.remove(\"is-loading\");\r\n            img.classList.add(\"load-error\");\r\n            img.src =\r\n              \"https://placehold.co/400x300/cccccc/000000?text=Error\";\r\n          };\r\n\r\n          obs.unobserve(img);\r\n        });\r\n      },\r\n      { rootMargin: \"0px 0px 180px 0px\", threshold: 0.01 }\r\n    );\r\n\r\n    lazyImages.forEach((img) => observer.observe(img));\r\n    \r\n    if (signal) {\r\n      signal.addEventListener(\"abort\", () => observer.disconnect());\r\n    } else {\r\n      on(\r\n        window,\r\n        \"beforeunload\",\r\n        () => observer.disconnect(),\r\n        { once: true }\r\n      );\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Share Button\r\n  // ==========================\r\n  function initShareButton(signal) {\r\n    let shareBtn = document.getElementById(\"share-page-button\");\r\n    if (!shareBtn) {\r\n      shareBtn = document.createElement(\"button\");\r\n      shareBtn.id = \"share-page-button\";\r\n      shareBtn.type = \"button\";\r\n      shareBtn.innerHTML =\r\n        \"<i class=\\\"fas fa-share-alt\\\" aria-hidden=\\\"true\\\"></i>\";\r\n      shareBtn.setAttribute(\"aria-label\", STRINGS_FA.aria.share);\r\n      shareBtn.classList.add(\r\n        \"sohrabi-share-feature\",\r\n        \"hidden\",\r\n        \"cta-pulse-effect\"\r\n      );\r\n      document.body.appendChild(shareBtn);\r\n    }\r\n\r\n    const onScroll = throttle(() => {\r\n      const isVisible = window.scrollY > 500;\r\n      shareBtn.classList.toggle(\"visible\", isVisible);\r\n      shareBtn.classList.toggle(\"hidden\", !isVisible);\r\n    }, 120);\r\n\r\n    on(window, \"scroll\", onScroll, { passive: true, signal });\r\n    onScroll();\r\n\r\n    on(shareBtn, \"click\", async () => {\r\n      const pageUrl = window.location.href;\r\n      if (navigator.share) {\r\n        try {\r\n          await navigator.share({ title: document.title, url: pageUrl });\r\n          createToast(STRINGS_FA.toasts.shareOk, {\r\n            id: \"share-success-toast\",\r\n            iconClass: \"fas fa-check-circle\",\r\n            iconColor: \"var(--highlight-color)\",\r\n            duration: 1800,\r\n          });\r\n          vibrate([40]);\r\n        } catch (error) {\r\n          if (error?.name !== \"AbortError\") {\r\n            console.error(\"Share error:\", error);\r\n            createToast(STRINGS_FA.toasts.shareErr, {\r\n              id: \"share-error-toast\",\r\n              iconClass: \"fas fa-exclamation-triangle\",\r\n              iconColor: \"red\",\r\n              duration: 2800,\r\n            });\r\n          }\r\n        }\r\n      } else {\r\n        await copyToClipboard(\r\n          pageUrl,\r\n          \"share-copy-toast\",\r\n          \"share-error-toast\",\r\n          STRINGS_FA.toasts.linkCopied(\"ØµÙØ­Ù‡\")\r\n        );\r\n      }\r\n    }, { signal });\r\n  }\r\n\r\n  // ==========================\r\n  // Section Milestones & Confetti\r\n  // ==========================\r\n  function initExplorationMilestones(signal) {\r\n    const sections = document.querySelectorAll(\"section[id]\");\r\n    const total = sections.length;\r\n    if (!total) {return;}\r\n\r\n    const visited = new Set(storage.get(\"sectionsVisited\", []));\r\n    const announced = new Set(storage.get(\"announcedMilestones\", []));\r\n\r\n    const milestones = [\r\n      {\r\n        count: Math.max(1, Math.ceil(total * 0.25)),\r\n        message: \"Ø´Ù…Ø§ Û²ÛµÙª Ø§Ø² Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ø¹Ø§Ù„ÛŒÙ‡! âœ¨ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯!\",\r\n        icon: \"fas fa-map-marker-alt\",\r\n      },\r\n      {\r\n        count: Math.max(\r\n          Math.ceil(total * 0.25) + 1,\r\n          Math.ceil(total * 0.5)\r\n        ),\r\n        message:\r\n          \"Ù†ØµÙ Ø±Ø§Ù‡ Ø±Ø§ Ù¾ÛŒÙ…ÙˆØ¯ÛŒØ¯! Ø´Ù…Ø§ ÛµÛ°Ùª Ø§Ø² Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡! ğŸš€\",\r\n        icon: \"fas fa-rocket\",\r\n      },\r\n      {\r\n        count: Math.max(\r\n          Math.ceil(total * 0.5) + 1,\r\n          Math.ceil(total * 0.75)\r\n        ),\r\n        message: \"Ø¨Ù‡ Û·ÛµÙª Ø±Ø³ÛŒØ¯ÛŒØ¯! Ú©Ù…â€ŒÚ©Ù… Ø¯Ø§Ø±ÛŒÙ… Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ù…ÛŒâ€ŒØ±Ø³ÛŒÙ…! ğŸŒŸ\",\r\n        icon: \"fas fa-star\",\r\n      },\r\n      {\r\n        count: total,\r\n        message: `ØªØ¨Ø±ÛŒÚ©! Ø´Ù…Ø§ ØªÙ…Ø§Ù… ${total} Ø¨Ø®Ø´ Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ø´Ù…Ø§ ÛŒÚ© Ú©Ø§ÙˆØ´Ú¯Ø± ÙˆØ§Ù‚Ø¹ÛŒ Ù‡Ø³ØªÛŒØ¯! ğŸ‰`,\r\n        icon: \"fas fa-trophy\",\r\n        isFinal: true,\r\n      },\r\n    ]\r\n      .filter(\r\n        (m, i, arr) =>\r\n          m.count > 0 && arr.findIndex((x) => x.count === m.count) === i\r\n      )\r\n      .sort((a, b) => a.count - b.count);\r\n\r\n    let lastToastAt = 0;\r\n    const cooldown = ENV.state.coarse ? 12000 : 8000;\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        const now = Date.now();\r\n\r\n        entries.forEach((entry) => {\r\n          if (!entry.isIntersecting) {return;}\r\n\r\n          visited.add(entry.target.id);\r\n          storage.set(\"sectionsVisited\", [...visited]);\r\n          observer.unobserve(entry.target);\r\n\r\n          const count = visited.size;\r\n          for (const m of milestones) {\r\n            if (\r\n              count >= m.count &&\r\n              !announced.has(m.count) &&\r\n              now - lastToastAt > cooldown\r\n            ) {\r\n              createToast(m.message, {\r\n                id: `exploration-milestone-${m.count}`,\r\n                customClass: m.isFinal\r\n                  ? \"exploration-toast final-exploration-toast\"\r\n                  : \"exploration-toast\",\r\n                iconClass: m.icon,\r\n                iconColor: m.isFinal\r\n                  ? \"var(--primary-color)\"\r\n                  : \"var(--accent-color)\",\r\n                duration: 4200,\r\n              });\r\n\r\n              const bio = document.getElementById(\"sohrabi-bio\");\r\n              bio?.dispatchEvent(new Event(\"mouseenter\"));\r\n\r\n              announced.add(m.count);\r\n              storage.set(\"announcedMilestones\", [...announced]);\r\n              lastToastAt = now;\r\n\r\n              if (m.isFinal && FLAGS().ENABLE_CONFETTI)\r\n              {setTimeout(createConfetti, 500);}\r\n              break;\r\n            }\r\n          }\r\n        });\r\n      },\r\n      { threshold: 0.3, rootMargin: \"0px 0px -10% 0px\" }\r\n    );\r\n\r\n    sections.forEach((sec) => observer.observe(sec));\r\n    \r\n    if (signal) {\r\n      signal.addEventListener(\"abort\", () => observer.disconnect());\r\n    } else {\r\n      on(\r\n        window,\r\n        \"beforeunload\",\r\n        () => observer.disconnect(),\r\n        { once: true }\r\n      );\r\n    }\r\n  }\r\n\r\n  function createConfetti() {\r\n    if (ENV.state.reduced || ENV.state.coarse) {return;}\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.id = \"confetti-canvas\";\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n\r\n    Object.assign(canvas.style, {\r\n      position: \"fixed\",\r\n      top: 0,\r\n      left: 0,\r\n      width: \"100vw\",\r\n      height: \"100vh\",\r\n      pointerEvents: \"none\",\r\n      zIndex: 9998,\r\n    });\r\n\r\n    canvas.dataset.celebrationEvent =\r\n      \"page_completion_by_Mohammad_Rasoul_Sohrabi_user\";\r\n\r\n    document.body.appendChild(canvas);\r\n\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const colors = [\r\n      \"#ffc107\",\r\n      \"#007acc\",\r\n      \"#005a9e\",\r\n      \"#f0f0f0\",\r\n      \"#e0a800\",\r\n      \"#FF4081\",\r\n      \"#64FFDA\",\r\n    ];\r\n\r\n    const pieces = Array.from({ length: 48 }, () => ({\r\n      x: Math.random() * canvas.width,\r\n      y: -Math.random() * canvas.height,\r\n      size: Math.random() * 8 + 4,\r\n      color: colors[(Math.random() * colors.length) | 0],\r\n      angle: Math.random() * 360,\r\n      speed: Math.random() * 2 + 1,\r\n      drift: Math.random() * 2 - 1,\r\n    }));\r\n\r\n    const start = performance.now();\r\n    let rafId = null;\r\n\r\n    const cleanup = () => {\r\n      if (rafId) {cancelAnimationFrame(rafId);}\r\n      if (canvas && canvas.parentNode) {\r\n        canvas.remove();\r\n      }\r\n    };\r\n\r\n    const loop = () => {\r\n      const elapsed = performance.now() - start;\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n      for (const p of pieces) {\r\n        p.y += p.speed;\r\n        p.x += p.drift;\r\n        p.angle += 2;\r\n\r\n        ctx.save();\r\n        ctx.translate(p.x, p.y);\r\n        ctx.rotate((p.angle * Math.PI) / 180);\r\n        ctx.fillStyle = p.color;\r\n        ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);\r\n        ctx.restore();\r\n      }\r\n\r\n      if (elapsed < 3400) {\r\n        rafId = requestAnimationFrame(loop);\r\n      } else {\r\n        cleanup();\r\n      }\r\n    };\r\n\r\n    rafId = requestAnimationFrame(loop);\r\n\r\n    // Cleanup observer for early canvas removal\r\n    const observer = new MutationObserver(() => {\r\n      if (!document.body.contains(canvas)) {\r\n        cleanup();\r\n        observer.disconnect();\r\n      }\r\n    });\r\n\r\n    observer.observe(document.body, { childList: true, subtree: true });\r\n  }\r\n\r\n  // ==========================\r\n  // Fun Fact idle toast\r\n  // ==========================\r\n  function initFunFacts() {\r\n    if (ENV.state.coarse || ENV.state.saveData) {return;} // disable on phones / save-data\r\n\r\n    let toastRef = null;\r\n    let idleTimeout;\r\n\r\n    const show = () => {\r\n      const fact = FUN_FACTS_FA[(Math.random() * FUN_FACTS_FA.length) | 0];\r\n      toastRef = createToast(`${STRINGS_FA.funFactsPrefix} ${fact}`, {\r\n        id: \"fun-fact-toast\",\r\n        customClass: \"fun-fact-toast\",\r\n        iconClass: \"fas fa-lightbulb\",\r\n        iconColor: \"var(--primary-color)\",\r\n        position: \"top\",\r\n        duration: 5200,\r\n        closeButton: true,\r\n      });\r\n    };\r\n\r\n    const reset = debounce(() => {\r\n      clearTimeout(idleTimeout);\r\n      idleTimeout = setTimeout(() => {\r\n        if (!toastRef || !toastRef.classList.contains(\"show\")) {show();}\r\n      }, 24000);\r\n    }, 600);\r\n\r\n    const evs = [\"mousemove\", \"keydown\", \"scroll\", \"touchstart\"];\r\n    evs.forEach((ev) => {\r\n      const opts = ev === \"scroll\" || ev === \"touchstart\" ? { passive: true } : {};\r\n      on(window, ev, reset, opts);\r\n    });\r\n\r\n    reset();\r\n\r\n    on(document, \"visibilitychange\", () => {\r\n      if (document.hidden) {\r\n        clearTimeout(idleTimeout);\r\n      } else {\r\n        reset();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Social Links Copy\r\n  // ==========================\r\n  function initSocialLinksCopy(signal) {\r\n    const block = document.querySelector(\".connect-links-block ul\");\r\n    if (!block) {return;}\r\n\r\n    block.id = \"sohrabi-social-links\";\r\n    block.dataset.profileOwner = \"Mohammad Rasoul Sohrabi\";\r\n\r\n    on(block, \"click\", async (e) => {\r\n      const link = e.target.closest?.(\"a\");\r\n      if (\r\n        link &&\r\n        block.contains(link) &&\r\n        link.href &&\r\n        link.href.startsWith(\"http\")\r\n      ) {\r\n        e.preventDefault();\r\n        const txt = link.textContent?.trim() || link.href;\r\n        const name =\r\n          link.querySelector(\"i\")?.nextSibling?.textContent?.trim() ||\r\n          txt;\r\n        await copyToClipboard(\r\n          link.href,\r\n          `social-link-copy-${name.replace(/\\s/g, \"\")}`,\r\n          `social-link-copy-error-${name.replace(/\\s/g, \"\")}`,\r\n          STRINGS_FA.toasts.linkCopied(name)\r\n        );\r\n      }\r\n    }, { signal });\r\n  }\r\n\r\n  // ==========================\r\n  // Sparkle Effect\r\n  // ==========================\r\n  function createSparkle(element) {\r\n    if (\r\n      !element ||\r\n      ENV.state.reduced ||\r\n      ENV.state.saveData ||\r\n      ENV.state.lowPowerCPU\r\n    )\r\n    {return;}\r\n\r\n    const sparkle = document.createElement(\"div\");\r\n    sparkle.className = \"sparkle-effect\";\r\n    sparkle.dataset.sparkleSource =\r\n      \"Mohammad Rasoul Sohrabi's interactive elements\";\r\n\r\n    const size = Math.random() * 10 + 5;\r\n\r\n    Object.assign(sparkle.style, {\r\n      width: `${size}px`,\r\n      height: `${size}px`,\r\n      left: `${(Math.random() * 100).toFixed(2)}%`,\r\n      top: `${(Math.random() * 100).toFixed(2)}%`,\r\n      backgroundColor: [\r\n        \"var(--primary-color)\",\r\n        \"var(--accent-color)\",\r\n        \"var(--highlight-color)\",\r\n      ][(Math.random() * 3) | 0],\r\n      opacity: 0,\r\n      position: \"absolute\",\r\n      borderRadius: \"50%\",\r\n      boxShadow: `0 0 ${size / 2}px ${size / 4}px var(--highlight-color)`,\r\n      zIndex: 10,\r\n      pointerEvents: \"none\",\r\n    });\r\n\r\n    const cs = getComputedStyle(element);\r\n    if (!cs.position || cs.position === \"static\")\r\n    {element.style.position = \"relative\";}\r\n\r\n    element.appendChild(sparkle);\r\n\r\n    sparkle\r\n      .animate(\r\n        [\r\n          {\r\n            opacity: 0,\r\n            transform: `scale(0) rotate(${(\r\n              Math.random() * 360\r\n            ).toFixed(1)}deg)`,\r\n          },\r\n          {\r\n            opacity: 1,\r\n            transform: `scale(1) rotate(${(\r\n              360 + Math.random() * 360\r\n            ).toFixed(1)}deg)`,\r\n          },\r\n          {\r\n            opacity: 0,\r\n            transform: `scale(0.5) rotate(${(\r\n              720 + Math.random() * 360\r\n            ).toFixed(1)}deg)`,\r\n          },\r\n        ],\r\n        { duration: 650, easing: \"ease-out\", fill: \"forwards\" }\r\n      )\r\n      .addEventListener(\"finish\", () => sparkle.remove());\r\n  }\r\n\r\n  // ==========================\r\n  // CTA Buttons cosmetics\r\n  // ==========================\r\n  function initCTAs() {\r\n    document.querySelectorAll(\".main-cta-button\").forEach((btn) => {\r\n      btn.classList.add(\"cta-pulse-effect\", \"sohrabi-cta-action\");\r\n      btn.dataset.ctaOwner = \"Mohammad Rasoul Sohrabi\";\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // End-of-page toast (once per session)\r\n  // ==========================\r\n  function initEndOfPageToast() {\r\n    let announced = false;\r\n\r\n    const handler = throttle(() => {\r\n      if (announced) {return;}\r\n      const nearBottom =\r\n        window.innerHeight + window.scrollY >=\r\n        document.body.offsetHeight - 50;\r\n      if (nearBottom) {\r\n        createToast(STRINGS_FA.toasts.reachedEnd, {\r\n          id: \"end-of-page-toast\",\r\n          customClass: \"end-of-page-toast\",\r\n          iconClass: \"fas fa-flag-checkered\",\r\n          iconColor: \"var(--highlight-color)\",\r\n          duration: 3600,\r\n        });\r\n        announced = true;\r\n      }\r\n    }, 140);\r\n\r\n    on(window, \"scroll\", handler, { passive: true });\r\n  }\r\n\r\n  // ==========================\r\n  // Mobile Menu\r\n  // ==========================\r\n  function initMobileMenu(signal) {\r\n    const hamburger = document.querySelector(\".hamburger\");\r\n    const navLinks = document.querySelector(\".nav-links\");\r\n    const links = document.querySelectorAll(\".nav-links a\");\r\n\r\n    if (!hamburger || !navLinks) return;\r\n\r\n    on(hamburger, \"click\", () => {\r\n      hamburger.classList.toggle(\"active\");\r\n      navLinks.classList.toggle(\"active\");\r\n      const expanded = hamburger.getAttribute(\"aria-expanded\") === \"true\";\r\n      hamburger.setAttribute(\"aria-expanded\", !expanded);\r\n    }, { signal });\r\n\r\n    links.forEach((link) => {\r\n      on(link, \"click\", () => {\r\n        hamburger.classList.remove(\"active\");\r\n        navLinks.classList.remove(\"active\");\r\n        hamburger.setAttribute(\"aria-expanded\", \"false\");\r\n      }, { signal });\r\n    });\r\n\r\n    // Close menu when clicking outside\r\n    on(document, \"click\", (e) => {\r\n      if (\r\n        !hamburger.contains(e.target) &&\r\n        !navLinks.contains(e.target) &&\r\n        navLinks.classList.contains(\"active\")\r\n      ) {\r\n        hamburger.classList.remove(\"active\");\r\n        navLinks.classList.remove(\"active\");\r\n        hamburger.setAttribute(\"aria-expanded\", \"false\");\r\n      }\r\n    }, { signal });\r\n  }\r\n\r\n  // ==========================\r\n  // Boot & Live Updates\r\n  // ==========================\r\n  function handleDynamicContent() {\r\n    // Abort previous dynamic listeners\r\n    dynamicController.abort();\r\n    dynamicController = new AbortController();\r\n    const { signal } = dynamicController;\r\n\r\n    initMobileMenu(signal);\r\n    initFAQ(signal);\r\n    initEmailCopy(signal);\r\n    initLazyImages(signal);\r\n    initShareButton(signal);\r\n    initExplorationMilestones(signal);\r\n    initSocialLinksCopy(signal);\r\n    initCTAs(signal);\r\n    initSkillsHover(signal);\r\n\r\n    // Refresh AOS if available\r\n    if (window.AOS?.refresh) {\r\n      window.AOS.refresh();\r\n    } else {\r\n      initAOS();\r\n    }\r\n  }\r\n\r\n  function boot() {\r\n    // Static inits (run once)\r\n    setDynamicDates();\r\n    setIdentityHooks();\r\n    queueIdentityPings();\r\n    initTheme();\r\n    initAnchorScrolling();\r\n    initClickEffects();\r\n    initScrollUI();\r\n    initFunFacts();\r\n    initEndOfPageToast();\r\n    showWelcomeToast();\r\n\r\n    // Dynamic inits\r\n    handleDynamicContent();\r\n\r\n    // Listen for dynamic content updates\r\n    document.addEventListener(\"includesLoaded\", handleDynamicContent);\r\n  }\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", boot, { once: true });\r\n\r\n  // Re-evaluate dynamic flags on env change (e.g., user toggles reduced motion or system theme)\r\n  ENV.onChange(() => {\r\n    // Refresh only the pieces that depend on flags\r\n    initAOS();\r\n  });\r\n\r\n  // Teardown on page hide/unload\r\n  on(window, \"pagehide\", () => teardown.abort(), { once: true });\r\n})();\r\n"]}