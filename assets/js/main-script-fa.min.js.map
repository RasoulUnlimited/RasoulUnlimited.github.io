{"version":3,"file":"main-script-fa.min.js","names":["noop","on","el","evt","fn","opts","addEventListener","wrapped","result","apply","this","arguments","then","catch","err","reportRuntimeError","capture","RUNTIME_ERRORS_KEY","RUNTIME_ERRORS_MAX","pushRuntimeError","scope","payload","Error","name","message","stack","JSON","stringify","String","serializeRuntimeError","entry","ts","Date","toISOString","raw","sessionStorage","getItem","prev","parse","next","Array","isArray","concat","slice","setItem","document","documentElement","dataset","runtimeErrorCount","length","window","dispatchEvent","CustomEvent","detail","classList","add","console","error","safeRun","throttle","limit","inThrottle","lastFunc","lastRan","ctx","args","clearTimeout","setTimeout","now","Math","max","ric","requestIdleCallback","cb","timeRemaining","didTimeout","storage","cancelIdleCallback","get","key","fallback","v","localStorage","set","value","retryCount","attemptSet","e","oldKeys","Object","keys","filter","k","includes","removeItem","innerE","warn","setRaw","getRaw","remove","ENV","mq","q","matchMedia","matches","removeEventListener","addListener","removeListener","mqs","reduced","dark","coarse","conn","navigator","connection","mozConnection","webkitConnection","state","saveData","lowThroughput","test","effectiveType","lowPowerCPU","hardwareConcurrency","listeners","notify","forEach","l","bindMQL","m","onChange","push","FLAGS","s","low","ENABLE_AOS","ENABLE_SOUNDS","ENABLE_HAPTICS","ENABLE_CONFETTI","ENABLE_IDENTITY_PINGS","loadStylesheetWithTimeout","href","timeoutMs","Promise","resolve","reject","link","createElement","rel","crossOrigin","done","timer","onload","onerror","head","appendChild","hasFontAwesome","fonts","check","probe","className","style","position","width","height","overflow","opacity","body","family","getComputedStyle","fontFamily","async","waitForFontAwesome","maxWaitMs","start","initCriticalStyleFallbacks","fallbacks","delayMs","scheduleFontAwesomeRecoveryCheck","run","STRINGS_FA","themeDark","themeLight","reachedEnd","welcomeMorning","welcomeNoon","welcomeEvening","welcomeNight","welcomeBack","emailCopied","emailCopyError","shareOk","shareErr","linkCopied","clipboardUnsupported","closeToast","scrollTop","share","themeToggle","FUN_FACTS_FA","teardown","AbortController","signal","abortSignal","vibrate","pattern","audioContext","clickBuffer","toastBuffer","createToneBuffer","duration","wave","sr","sampleRate","buffer","createBuffer","floor","data","getChannelData","i","playSound","kind","src","createBufferSource","connect","destination","dismissToast","toast","once","createToast","options","settings","customClass","iconClass","iconColor","id","closeButton","existing","getElementById","contains","querySelectorAll","t","trim","role","setAttribute","tabIndex","toastPosition","icon","text","textContent","closeBtn","type","innerHTML","setDynamicDates","yearEl","getFullYear","lastUpdated","year","month","day","toLocaleDateString","setIdentityHooks","hiddenInfo","upsertMeta","content","meta","querySelector","authorFullName","orcidId","queueIdentityPings","fetch","targets","url","aborted","mode","ping","Ctx","AudioContext","webkitAudioContext","ensureAudioContext","resume","sin","PI","f","hidden","suspend","aosLoaded","aosScriptRequested","setAOSDisabledCSS","disabled","toggle","initAOS","AOS","init","startEvent","initClassName","animatedClassName","debounceDelay","throttleDelay","offset","easing","mirror","anchorPlacement","defer","applyTheme","theme","showToast","checked","parent","parentElement","createSparkle","initTheme","preventDefault","initAnchorScrolling","smoothAllowed","a","targetId","getAttribute","navH","offsetHeight","progH","padTop","parseFloat","paddingTop","y","offsetTop","isSkipLink","scrollTo","top","behavior","location","hash","history","replaceState","syncHash","target","HTMLElement","hadTabindex","hasAttribute","focus","preventScroll","removeAttribute","focusTargetForSkipLink","initClickEffects","event","card","closest","interactionSource","interactive","userAction","MouseEvent","bubbles","rafTasks","Set","rafPending","initScrollUI","bar","inner","prepend","btn","update","total","scrollHeight","innerHeight","scrolled","scrollY","progress","min","setProperty","progressTone","round","onScrollResize","scheduleRaf","requestAnimationFrame","tasks","from","clear","passive","exploreHint","hintAuthor","hero","obs","IntersectionObserver","entries","vis","isIntersecting","threshold","observe","disconnect","initSkillsHover","list","li","hideTimeout","skillOwner","span","getSpan","random","initFAQ","items","toggleFAQ","item","open","scrollIntoView","summary","block","rect","getBoundingClientRect","scrollBy","idx","answer","qId","questionId","faqAuthor","tagName","other","it","showWelcomeToast","msg","hour","getHours","copyToClipboard","okId","errId","okMsg","clipboard","writeText","initEmailCopy","emailLink","contactPerson","email","replace","initLazyImages","lazyImages","loadImg","img","decoding","loading","imageLoader","srcset","observer","unobserve","rootMargin","initShareButton","shareBtn","onScroll","isVisible","pageUrl","title","initTimelineMicroInteractions","section","children","node","markVisible","index","targetTimer","focusHashTarget","abs","ticking","updateParallax","viewH","centerDelta","ratio","toFixed","requestParallaxUpdate","removeProperty","initExplorationMilestones","sections","visited","announced","milestones","count","ceil","isFinal","arr","findIndex","x","sort","b","lastToastAt","cooldown","size","has","bio","Event","createConfetti","sec","canvas","innerWidth","celebrationEvent","getContext","colors","pieces","color","angle","speed","drift","performance","rafId","cleanup","cancelAnimationFrame","parentNode","loop","elapsed","clearRect","p","save","translate","rotate","fillStyle","fillRect","restore","MutationObserver","childList","subtree","initFunFacts","idleTimeout","toastRef","reset","delay","debounce","fact","show","ev","initSocialLinksCopy","profileOwner","startsWith","txt","nextSibling","safeName","element","sparkle","sparkleSource","sparkleColor","animation","animate","transform","fill","initCTAs","ctaOwner","initEndOfPageToast","handler","initMobileMenu","hamburger","navLinks","links","expanded","booted","boot","hydrateRuntimeErrorState","reason","readyState","abort"],"sources":["main-script-fa.js"],"mappings":"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","ignoreList":[],"sourcesContent":["/*\r\n  Mohammad Rasoul Sohrabi â€” Site UX Utilities (v2)\r\n  ORCID: 0009-0004-7177-2080\r\n*/\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  // ==========================\r\n  // Utilities & Environment\r\n  // ==========================\r\n\r\n  const noop = () => {};\r\n\r\n  const on = (el, evt, fn, opts) => {\n    if (!el || !el.addEventListener || typeof fn !== \"function\") {return null;}\n\n    const wrapped = function () {\n      try {\n        const result = fn.apply(this, arguments);\n        if (result && typeof result.then === \"function\") {\n          return result.catch((err) => {\n            reportRuntimeError(`event:${evt}`, err);\n            return undefined;\n          });\n        }\n        return result;\n      } catch (err) {\n        reportRuntimeError(`event:${evt}`, err);\n        return undefined;\n      }\n    };\n\n    el.addEventListener(evt, wrapped, { capture: false, ...(opts || {}) });\n    return wrapped;\n  };\n\r\n  const off = (el, evt, fn, opts) =>\n    el &&\n    el.removeEventListener &&\n    el.removeEventListener(evt, fn, { capture: false, ...(opts || {}) });\n\n  const RUNTIME_ERRORS_KEY = \"runtimeErrors\";\n  const RUNTIME_ERRORS_MAX = 30;\n\n  function serializeRuntimeError(err) {\n    if (!err) {\n      return { name: \"UnknownError\", message: \"Unknown runtime error\", stack: \"\" };\n    }\n    if (err instanceof Error) {\n      return {\n        name: err.name || \"Error\",\n        message: err.message || \"Error\",\n        stack: err.stack || \"\",\n      };\n    }\n    if (typeof err === \"string\") {\n      return { name: \"Error\", message: err, stack: \"\" };\n    }\n    return {\n      name: \"ErrorObject\",\n      message: (() => {\n        try {\n          return JSON.stringify(err);\n        } catch {\n          return String(err);\n        }\n      })(),\n      stack: \"\",\n    };\n  }\n\n  function pushRuntimeError(scope, err) {\n    const payload = serializeRuntimeError(err);\n    const entry = {\n      scope,\n      name: payload.name,\n      message: payload.message,\n      stack: payload.stack,\n      ts: new Date().toISOString(),\n    };\n\n    try {\n      const raw = sessionStorage.getItem(RUNTIME_ERRORS_KEY);\n      const prev = raw ? JSON.parse(raw) : [];\n      const next = (Array.isArray(prev) ? prev : []).concat(entry).slice(\n        -RUNTIME_ERRORS_MAX\n      );\n      sessionStorage.setItem(RUNTIME_ERRORS_KEY, JSON.stringify(next));\n      document.documentElement.dataset.runtimeErrorCount = String(next.length);\n    } catch {}\n\n    try {\n      window.dispatchEvent(new CustomEvent(\"app-runtime-error\", { detail: entry }));\n    } catch {}\n  }\n\n  function reportRuntimeError(scope, err) {\n    try {\n      document.documentElement.classList.add(\"runtime-degraded\");\n    } catch {}\n    pushRuntimeError(scope, err);\n    console.error(`[runtime:${scope}]`, err);\n  }\n\n  function hydrateRuntimeErrorState() {\n    try {\n      const raw = sessionStorage.getItem(RUNTIME_ERRORS_KEY);\n      const list = raw ? JSON.parse(raw) : [];\n      const count = Array.isArray(list) ? list.length : 0;\n      if (count > 0) {\n        document.documentElement.dataset.runtimeErrorCount = String(count);\n      }\n    } catch {}\n  }\n\n  function safeRun(scope, fn) {\n    try {\n      return fn();\n    } catch (err) {\n      reportRuntimeError(scope, err);\n      return undefined;\n    }\n  }\n\r\n  function throttle(fn, limit) {\r\n    let inThrottle, lastFunc, lastRan;\r\n    return function () {\r\n      const ctx = this;\r\n      const args = arguments;\r\n      if (!inThrottle) {\r\n        fn.apply(ctx, args);\r\n        lastRan = Date.now();\r\n        inThrottle = true;\r\n      } else {\r\n        clearTimeout(lastFunc);\r\n        lastFunc = setTimeout(function () {\r\n          if (Date.now() - lastRan >= limit) {\r\n            fn.apply(ctx, args);\r\n            lastRan = Date.now();\r\n          }\r\n        }, Math.max(0, limit - (Date.now() - lastRan)));\r\n      }\r\n    };\r\n  }\r\n\r\n  function debounce(fn, delay) {\r\n    let t;\r\n    return function () {\r\n      clearTimeout(t);\r\n      t = setTimeout(() => fn.apply(this, arguments), delay);\r\n    };\r\n  }\r\n\r\n  // requestIdleCallback polyfill (lightweight)\r\n  const ric =\r\n    window.requestIdleCallback ||\r\n    function (cb) {\r\n      return setTimeout(\r\n        () => cb({ timeRemaining: () => 0, didTimeout: true }),\r\n        1\r\n      );\r\n    };\r\n  const cic = window.cancelIdleCallback || clearTimeout;\r\n\r\n  // Safe localStorage access\r\n  const storage = {\r\n    get(key, fallback = null) {\r\n      try {\r\n        const v = localStorage.getItem(key);\r\n        return v === null ? fallback : JSON.parse(v);\r\n      } catch {\r\n        return fallback;\r\n      }\r\n    },\r\n    set(key, value) {\r\n      const maxRetries = 5;\r\n      let retryCount = 0;\r\n\r\n      const attemptSet = () => {\r\n        try {\r\n          localStorage.setItem(key, JSON.stringify(value));\r\n          return true;\r\n        } catch (e) {\r\n          if (e.name === \"QuotaExceededError\" && retryCount < maxRetries) {\r\n            retryCount++;\r\n\r\n            // Get sortable keys (excluding protected ones)\r\n            const oldKeys = Object.keys(localStorage).filter(\r\n              (k) => ![\"theme\", \"hasVisited\"].includes(k)\r\n            );\r\n\r\n            if (oldKeys.length > 0) {\r\n              try {\r\n                // Remove oldest key first\r\n                localStorage.removeItem(oldKeys[0]);\r\n                return attemptSet(); // Recursive retry\r\n              } catch (innerE) {\r\n                console.error(\r\n                  `Failed to recover from quota exceeded for ${key}:`,\r\n                  innerE\r\n                );\r\n                return false;\r\n              }\r\n            }\r\n          } else if (e.name === \"QuotaExceededError\") {\r\n            console.warn(\r\n              `localStorage quota exceeded. Could not store ${key} after ${maxRetries} retries`\r\n            );\r\n          } else {\r\n            console.error(`Failed to store ${key}:`, e);\r\n          }\r\n          return false;\r\n        }\r\n      };\r\n\r\n      return attemptSet();\r\n    },\r\n    setRaw(key, value) {\r\n      try {\r\n        localStorage.setItem(key, value);\r\n      } catch (e) {\r\n        if (e.name === \"QuotaExceededError\") {\r\n          console.warn(`localStorage quota exceeded. Could not store ${key}`);\r\n        } else {\r\n          console.error(`Failed to store ${key}:`, e);\r\n        }\r\n      }\r\n    },\r\n    getRaw(key, fallback = null) {\r\n      try {\r\n        const v = localStorage.getItem(key);\r\n        return v === null ? fallback : v;\r\n      } catch {\r\n        return fallback;\r\n      }\r\n    },\r\n    remove(key) {\r\n      try {\r\n        localStorage.removeItem(key);\r\n      } catch {}\r\n    },\r\n  };\r\n\r\n  // Live environment that reacts to userâ€™s system changes\r\n  const ENV = (() => {\r\n    const mq = (q) =>\r\n      window.matchMedia\r\n        ? window.matchMedia(q)\r\n        : {\r\n          matches: false,\r\n          addEventListener: noop,\r\n          removeEventListener: noop,\r\n          addListener: noop,\r\n          removeListener: noop,\r\n        };\r\n\r\n    const mqs = {\r\n      reduced: mq(\"(prefers-reduced-motion: reduce)\"),\r\n      dark: mq(\"(prefers-color-scheme: dark)\"),\r\n      coarse: mq(\"(pointer: coarse)\"),\r\n    };\r\n\r\n    const conn =\r\n      navigator.connection ||\r\n      navigator.mozConnection ||\r\n      navigator.webkitConnection;\r\n\r\n    const state = {\r\n      get reduced() {\r\n        return !!mqs.reduced.matches;\r\n      },\r\n      get dark() {\r\n        return !!mqs.dark.matches;\r\n      },\r\n      get coarse() {\r\n        return !!mqs.coarse.matches;\r\n      },\r\n      get saveData() {\r\n        return !!(conn && conn.saveData);\r\n      },\r\n      get lowThroughput() {\r\n        return !!(conn && /2g|slow-2g/.test(String(conn.effectiveType || \"\")));\r\n      },\r\n      get lowPowerCPU() {\r\n        return navigator.hardwareConcurrency\r\n          ? navigator.hardwareConcurrency <= 4\r\n          : false;\r\n      },\r\n    };\r\n\r\n    const listeners = [];\n    const notify = () => {\n      listeners.forEach((l) => {\n        try {\n          l();\n        } catch (err) {\n          reportRuntimeError(\"env.change\", err);\n        }\n      });\n    };\n\n    const bindMQL = (m) => {\n      if (!m) {return;}\n      if (typeof m.addEventListener === \"function\") {\n        on(m, \"change\", notify);\n      } else if (typeof m.addListener === \"function\") {\n        m.addListener(notify);\n      }\n    };\n\r\n    bindMQL(mqs.reduced);\r\n    bindMQL(mqs.dark);\r\n    bindMQL(mqs.coarse);\r\n\r\n    if (conn) {\r\n      if (conn.addEventListener) {\r\n        on(conn, \"change\", notify);\r\n      } else if (typeof conn.addListener === \"function\") {\r\n        conn.addListener(notify);\r\n      }\r\n    }\r\n\r\n    return {\r\n      state,\r\n      onChange: (fn) => {\r\n        if (typeof fn === \"function\") {listeners.push(fn);}\r\n      },\r\n    };\r\n  })();\r\n\r\n  const FLAGS = () => {\n    const s = ENV.state;\n    const low = s.saveData || s.lowThroughput;\n    return {\r\n      ENABLE_AOS: !s.coarse && !s.reduced && !low,\r\n      ENABLE_SOUNDS: !s.coarse && !s.reduced && !low,\r\n      ENABLE_HAPTICS: !s.reduced && s.coarse && !low,\r\n      ENABLE_CONFETTI: !s.reduced && !low && !s.coarse,\r\n      ENABLE_IDENTITY_PINGS: false,\n    };\n  };\n\n  function loadStylesheetWithTimeout(href, timeoutMs = 3000) {\n    return new Promise((resolve, reject) => {\n      const link = document.createElement(\"link\");\n      link.rel = \"stylesheet\";\n      link.href = href;\n      link.crossOrigin = \"anonymous\";\n\n      let done = false;\n      const timer = setTimeout(() => {\n        if (done) {return;}\n        done = true;\n        try {\n          link.remove();\n        } catch {}\n        reject(new Error(`stylesheet timeout: ${href}`));\n      }, timeoutMs);\n\n      link.onload = () => {\n        if (done) {return;}\n        done = true;\n        clearTimeout(timer);\n        resolve(true);\n      };\n\n      link.onerror = () => {\n        if (done) {return;}\n        done = true;\n        clearTimeout(timer);\n        try {\n          link.remove();\n        } catch {}\n        reject(new Error(`stylesheet load failed: ${href}`));\n      };\n\n      document.head.appendChild(link);\n    });\n  }\n\n  function hasFontAwesome() {\n    try {\n      if (\n        document.fonts &&\n        typeof document.fonts.check === \"function\" &&\n        document.fonts.check('1em \"Font Awesome 6 Free\"')\n      ) {\n        return true;\n      }\n    } catch {}\n\n    try {\n      const probe = document.createElement(\"i\");\n      probe.className = \"fas fa-circle\";\n      probe.style.position = \"absolute\";\n      probe.style.width = \"0\";\n      probe.style.height = \"0\";\n      probe.style.overflow = \"hidden\";\n      probe.style.opacity = \"0\";\n      document.body.appendChild(probe);\n      const family = getComputedStyle(probe).fontFamily || \"\";\n      probe.remove();\n      return /font awesome/i.test(family);\n    } catch {\n      return false;\n    }\n  }\n\n  async function waitForFontAwesome(maxWaitMs = 1500) {\n    const start = Date.now();\n    while (Date.now() - start < maxWaitMs) {\n      if (hasFontAwesome()) {return true;}\n      await new Promise((resolve) => setTimeout(resolve, 120));\n    }\n    return hasFontAwesome();\n  }\n\n  function scheduleFontAwesomeRecoveryCheck(delayMs = 6500) {\n    setTimeout(async () => {\n      if (await waitForFontAwesome(1200)) {\n        document.documentElement.classList.remove(\"icons-degraded\");\n      }\n    }, delayMs);\n  }\n\n  function initCriticalStyleFallbacks() {\n    const run = async () => {\n      const ready = await waitForFontAwesome(1500);\n      if (ready) {\n        document.documentElement.classList.remove(\"icons-degraded\");\n        return;\n      }\n\n      const fallbacks = [\n        \"https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css\",\n        \"https://use.fontawesome.com/releases/v6.0.0/css/all.css\",\n      ];\n\n      for (const href of fallbacks) {\n        try {\n          await loadStylesheetWithTimeout(href, 2800);\n          if (await waitForFontAwesome(1200)) {\n            document.documentElement.classList.remove(\"icons-degraded\");\n            return;\n          }\n        } catch (err) {\n          console.warn(\"[fontawesome.fallback]\", err);\n        }\n      }\n\n      document.documentElement.classList.add(\"icons-degraded\");\n      scheduleFontAwesomeRecoveryCheck();\n    };\n\n    run().catch((err) => reportRuntimeError(\"fontawesome.bootstrap\", err));\n  }\n\r\n  // i18n (FA)\r\n  const STRINGS_FA = {\r\n    toasts: {\r\n      themeDark: \"ØªÙ… Ø¨Ù‡ Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© ØªØºÛŒÛŒØ± ÛŒØ§ÙØª.\",\r\n      themeLight: \"ØªÙ… Ø¨Ù‡ Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù† ØªØºÛŒÛŒØ± ÛŒØ§ÙØª.\",\r\n      reachedEnd: \"Ø´Ù…Ø§ Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ø±Ø³ÛŒØ¯ÛŒØ¯. Ø§Ø² Ø¨Ø§Ø²Ø¯ÛŒØ¯ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±Ù…. ğŸ‰\",\r\n      welcomeMorning: \"ØµØ¨Ø­ Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeNoon: \"Ø¸Ù‡Ø± Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeEvening: \"Ø¹ØµØ± Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeNight: \"Ø´Ø¨ Ø¨Ø®ÛŒØ±! Ø¨Ù‡ ÙˆØ¨Ø³Ø§ÛŒØª Ø±Ø³Ù…ÛŒ Ø±Ø³ÙˆÙ„ Ø¢Ù†Ù„ÛŒÙ…ÛŒØªØ¯ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.\",\r\n      welcomeBack: \"Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯! Ø§Ø² Ø¨Ø§Ø²Ú¯Ø´Øª Ø´Ù…Ø§ Ø®Ø±Ø³Ù†Ø¯ÛŒÙ….\",\r\n      emailCopied: \"Ø§ÛŒÙ…ÛŒÙ„ Ú©Ù¾ÛŒ Ø´Ø¯. âœ…\",\r\n      emailCopyError: \"Ú©Ù¾ÛŒ Ø§ÛŒÙ…ÛŒÙ„ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.\",\r\n      shareOk: \"Ù„ÛŒÙ†Ú© ØµÙØ­Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Ø§Ø´ØªØ±Ø§Ú© Ú¯Ø°Ø§Ø´ØªÙ‡ Ø´Ø¯! âœ…\",\r\n      shareErr: \"Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´Ø¯.\",\r\n      linkCopied: (name) => `Ù„ÛŒÙ†Ú© ${name} Ú©Ù¾ÛŒ Ø´Ø¯! âœ…`,\r\n      clipboardUnsupported: \"Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.\",\r\n    },\r\n    funFactsPrefix: \"Ø¯Ø§Ù†Ø³ØªÙ†ÛŒ:\",\r\n    aria: {\r\n      closeToast: \"Ø¨Ø³ØªÙ† Ù¾ÛŒØ§Ù…\",\r\n      scrollTop: \"Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡\",\r\n      share: \"Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡\",\r\n      themeToggle: \"ØªØºÛŒÛŒØ± ØªÙ… Ø³Ø§ÛŒØª\",\r\n    },\r\n  };\r\n\r\n  const FUN_FACTS_FA = [\r\n    \"Ø¹Ø³Ù„ Ù‡ÛŒÚ†â€ŒÚ¯Ø§Ù‡ ÙØ§Ø³Ø¯ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯.\",\r\n    \"Ù‡Ø´Øªâ€ŒÙ¾Ø§ÛŒØ§Ù† Ø³Ù‡ Ù‚Ù„Ø¨ Ø¯Ø§Ø±Ù†Ø¯.\",\r\n    \"Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù† Ø­Ø¯ÙˆØ¯ Û¶Û°Ùª Ø§Ø² Ø¢Ø¨ ØªØ´Ú©ÛŒÙ„ Ø´Ø¯Ù‡ Ø§Ø³Øª.\",\r\n    \"Ù…ÙˆØ² Ø¯Ø± ÙˆØ§Ù‚Ø¹ ÛŒÚ© Ù†ÙˆØ¹ ØªÙˆØª Ù…Ø­Ø³ÙˆØ¨ Ù…ÛŒâ€ŒØ´ÙˆØ¯.\",\r\n    \"Ø¯Ù„ÙÛŒÙ†â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ø¨ ØªÙ†Ù‡Ø§ Ù†ÛŒÙ…ÛŒ Ø§Ø² Ù…ØºØ² Ø®ÙˆØ¯ Ø±Ø§ Ø®Ø§Ù…ÙˆØ´ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯.\",\r\n  ];\r\n\r\n  // Abort controller for idle/async work cleanup\r\n  const teardown = new AbortController();\r\n  const { signal: abortSignal } = teardown;\r\n\r\n  // ==========================\r\n  // Haptics / Vibrate\r\n  // ==========================\r\n  function vibrate(pattern = [50]) {\r\n    if (!FLAGS().ENABLE_HAPTICS || ENV.state.reduced) {return;}\r\n    if (navigator.vibrate) {navigator.vibrate(pattern);}\r\n  }\r\n\r\n  // ==========================\r\n  // Audio (click/toast) â€” lazy, mobile-safe\r\n  // ==========================\r\n  let audioContext, clickBuffer, toastBuffer;\r\n\r\n  function ensureAudioContext() {\r\n    if (!FLAGS().ENABLE_SOUNDS || audioContext) {return;}\r\n    const Ctx = window.AudioContext || window.webkitAudioContext;\r\n    if (Ctx) {audioContext = new Ctx();}\r\n  }\r\n\r\n  function createToneBuffer(duration, wave) {\r\n    if (!audioContext) {return null;}\r\n    const sr = audioContext.sampleRate;\r\n    const buffer = audioContext.createBuffer(\r\n      1,\r\n      Math.max(1, Math.floor(sr * duration)),\r\n      sr\r\n    );\r\n    const data = buffer.getChannelData(0);\r\n    for (let i = 0; i < data.length; i++) {data[i] = wave(i, sr);}\r\n    return buffer;\r\n  }\r\n\r\n  function loadSounds() {\r\n    if (!audioContext) {return;}\r\n    clickBuffer = createToneBuffer(\r\n      0.05,\r\n      (i, sr) => Math.sin(2 * Math.PI * 440 * (i / sr)) * 0.08\r\n    );\r\n    toastBuffer = createToneBuffer(0.1, (i, sr) => {\r\n      const t = i / sr;\r\n      const d = 0.1;\r\n      const f = 880 + (1200 - 880) * (t / d);\r\n      return (\r\n        Math.sin(2 * Math.PI * f * t) *\r\n        0.12 *\r\n        Math.max(0, 1 - t / d)\r\n      );\r\n    });\r\n  }\r\n\r\n  // ğŸ”Š BUG FIX: playSound implementation\r\n  function playSound(kind) {\r\n    if (!FLAGS().ENABLE_SOUNDS || !audioContext) {return;}\r\n\r\n    const buffer =\r\n      kind === \"toast\" ? toastBuffer : kind === \"click\" ? clickBuffer : null;\r\n    if (!buffer) {return;}\r\n\r\n    try {\r\n      const src = audioContext.createBufferSource();\r\n      src.buffer = buffer;\r\n      src.connect(audioContext.destination);\r\n      src.start(0);\r\n    } catch (err) {\r\n      console.warn(\"Audio playback failed:\", err);\r\n    }\r\n  }\r\n\r\n  on(\r\n    document,\r\n    \"pointerdown\",\r\n    () => {\r\n      ensureAudioContext();\r\n      audioContext?.resume?.();\r\n      loadSounds();\r\n    },\r\n    { once: true }\r\n  );\r\n\r\n  on(document, \"visibilitychange\", () => {\r\n    if (document.hidden) {audioContext?.suspend?.();}\r\n    else {audioContext?.resume?.();}\r\n  });\r\n\r\n  // ==========================\r\n  // Toasts (CSS-driven)\r\n  // ==========================\r\n  function dismissToast(toast) {\n    if (!toast) {return;}\n    toast.classList.remove(\"show\");\n    on(\n      toast,\n      \"transitionend\",\n      () => toast.remove(),\n      { once: true }\n    );\n  }\n\r\n  function createToast(message, options = {}) {\r\n    const defaults = {\r\n      duration: 2500,\r\n      customClass: \"\",\r\n      iconClass: \"\",\r\n      iconColor: \"\",\r\n      position: \"bottom\",\r\n      id: \"\",\r\n      closeButton: false,\r\n    };\r\n    const settings = { ...defaults, ...options };\r\n\r\n    if (settings.id) {\r\n      const existing = document.getElementById(settings.id);\r\n      if (existing && existing.classList.contains(\"show\")) {return existing;}\r\n    }\r\n\r\n    document.querySelectorAll(\".dynamic-toast\").forEach((t) => {\n      if (!settings.id || t.id !== settings.id) {\n        t.classList.remove(\"show\");\n        on(\n          t,\n          \"transitionend\",\n          () => t.remove(),\n          { once: true }\n        );\n      }\n    });\r\n\r\n    const toast = document.createElement(\"div\");\r\n    toast.className = `dynamic-toast ${settings.customClass}`.trim();\r\n    toast.role = \"status\";\r\n    toast.setAttribute(\"aria-live\", \"polite\");\r\n    toast.tabIndex = -1;\r\n    if (settings.id) {toast.id = settings.id;}\r\n\r\n    // CSP-safe positioning (no style attribute mutations)\r\n    toast.classList.add(\"toast-fixed\");\r\n    toast.dataset.toastPosition = settings.position === \"top\" ? \"top\" : \"bottom\";\r\n\r\n    if (settings.iconClass) {\r\n      const icon = document.createElement(\"i\");\r\n      icon.className = settings.iconClass;\r\n      // CSP-safe icon color: use CSS var via inline? no. We'll map known vars or fallback.\r\n      if (settings.iconColor) {\r\n        icon.dataset.iconColor = settings.iconColor;\r\n      }\r\n      icon.setAttribute(\"aria-hidden\", \"true\");\r\n      toast.appendChild(icon);\r\n    }\r\n\r\n    const text = document.createElement(\"span\");\r\n    text.className = \"toast-message\";\r\n    text.textContent = message;\r\n    toast.appendChild(text);\r\n\r\n    if (settings.closeButton) {\r\n      const closeBtn = document.createElement(\"button\");\r\n      closeBtn.type = \"button\";\r\n      closeBtn.className = \"fun-fact-close\";\r\n      closeBtn.setAttribute(\"aria-label\", STRINGS_FA.aria.closeToast);\r\n      closeBtn.innerHTML =\r\n        '<i class=\"fas fa-times\" aria-hidden=\"true\"></i>';\r\n      on(closeBtn, \"click\", () => dismissToast(toast));\r\n      toast.appendChild(closeBtn);\r\n    }\r\n\r\n    document.body.appendChild(toast);\r\n\r\n    Promise.resolve().then(() => {\r\n      toast.classList.add(\"show\");\r\n      if (FLAGS().ENABLE_SOUNDS && audioContext) {\r\n        playSound(\"toast\");\r\n      }\r\n    });\r\n\r\n    if (settings.duration > 0) {\r\n      setTimeout(() => dismissToast(toast), settings.duration);\r\n    }\r\n\r\n    return toast;\r\n  }\r\n\r\n  // ==========================\r\n  // Dates & Identity\r\n  // ==========================\r\n  function setDynamicDates() {\r\n    const yearEl =\r\n      document.getElementById(\"current-year\") ||\r\n      document.getElementById(\"footer-year\");\r\n    if (yearEl) {yearEl.textContent = String(new Date().getFullYear());}\r\n\r\n    const lastUpdated = document.getElementById(\"last-updated-date\");\r\n    if (lastUpdated) {\r\n      const opts = { year: \"numeric\", month: \"long\", day: \"numeric\" };\r\n      lastUpdated.textContent = new Date().toLocaleDateString(\r\n        \"fa-IR\",\r\n        opts\r\n      );\r\n      lastUpdated.setAttribute(\r\n        \"data-last-updated-by\",\r\n        \"Mohammad Rasoul Sohrabi\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function setIdentityHooks() {\n    document.body.id = \"sohrabi-verified-identity\";\n    document.body.classList.add(\n      \"sohrabi-orcid\",\n      \"github-verified\",\n      \"academic-entity\"\n    );\n\r\n    const hiddenInfo = document.createElement(\"div\");\r\n    hiddenInfo.classList.add(\"visually-hidden\");\r\n    hiddenInfo.dataset.authorFullName = \"Mohammad Rasoul Sohrabi\";\r\n    hiddenInfo.dataset.orcidId = \"0009-0004-7177-2080\";\r\n    hiddenInfo.setAttribute(\"aria-hidden\", \"true\");\r\n    hiddenInfo.textContent =\n      \"Mohammad Rasoul Sohrabi is a verified contributor on ORCID, Zenodo, GitHub, and Wikipedia. Known for Persian Bot and biomedical engineering content.\";\n    document.body.appendChild(hiddenInfo);\n\n    function upsertMeta(name, content) {\n      let meta = document.head.querySelector(`meta[name=\"${name}\"]`);\n      if (!meta) {\n        meta = document.createElement(\"meta\");\n        meta.name = name;\n        document.head.appendChild(meta);\n      }\n      meta.content = content;\n    }\n\n    upsertMeta(\n      \"generator\",\n      \"Mohammad Rasoul Sohrabi - Biomedical Engineering, ORCID Verified\"\n    );\n    upsertMeta(\"author\", \"Mohammad Rasoul Sohrabi\");\n  }\n\r\n  function queueIdentityPings() {\r\n    if (\r\n      !FLAGS().ENABLE_IDENTITY_PINGS ||\r\n      ENV.state.coarse ||\r\n      ENV.state.saveData ||\r\n      typeof fetch !== \"function\"\r\n    )\r\n    {return;}\r\n\r\n    const targets = [\r\n      { name: \"GitHub\", url: \"https://github.com/RasoulUnlimited\" },\r\n      {\r\n        name: \"LinkedIn\",\r\n        url: \"https://www.linkedin.com/in/rasoulunlimited/\",\r\n      },\r\n      {\r\n        name: \"ResearchGate\",\r\n        url: \"https://www.researchgate.net/profile/Mohammad-Rasoul-Sohrabi\",\r\n      },\r\n      { name: \"About.me\", url: \"https://about.me/rasoulunlimited\" },\r\n      { name: \"ORCID\", url: \"https://orcid.org/0009-0004-7177-2080\" },\r\n    ];\r\n\r\n    const ping = (t) =>\r\n      fetch(t.url, { mode: \"no-cors\" }).catch(() => {});\r\n\r\n    ric(() =>\r\n      targets.forEach((t, i) =>\r\n        setTimeout(() => {\r\n          if (abortSignal.aborted) {return;}\r\n          ping(t);\r\n        }, i * 1000)\r\n      )\r\n    );\r\n  }\r\n\r\n  // ==========================\r\n  // AOS (Animations) â€” gated\r\n  // ==========================\r\n  let aosLoaded = false;\n  let aosScriptRequested = false;\n\r\n  function setAOSDisabledCSS(disabled) {\r\n    document.documentElement.classList.toggle(\"aos-disabled\", disabled);\r\n  }\r\n\r\n  function initAOS() {\n    // Keep content visible by default; only disable this fallback after\n    // a successful AOS initialization.\n    setAOSDisabledCSS(true);\n\n    if (!FLAGS().ENABLE_AOS) {return;}\n\n    if (window.AOS?.init) {\n      try {\n        window.AOS.init({\n          startEvent: \"DOMContentLoaded\",\n          initClassName: \"aos-init\",\n          animatedClassName: \"aos-animate\",\n          debounceDelay: 50,\n          throttleDelay: 99,\n          offset: 120,\n          duration: 500,\n          easing: \"ease-out\",\n          once: false,\n          mirror: false,\n          anchorPlacement: \"top-bottom\",\n        });\n        aosLoaded = true;\n        setAOSDisabledCSS(false);\n      } catch {\n        setAOSDisabledCSS(true);\n      }\n      return;\n    }\n\n    if (aosLoaded || aosScriptRequested) {return;}\n    aosScriptRequested = true;\n\n    const s = document.createElement(\"script\");\n    s.src = \"/assets/vendor/aos/aos.min.js\";\n    s.defer = true;\n    s.onload = () => {\n      aosLoaded = true;\n      initAOS();\n    };\n    s.onerror = () => {\n      aosScriptRequested = false;\n      setAOSDisabledCSS(true);\n    };\n    document.head.appendChild(s);\n  }\n\r\n  // ==========================\r\n  // Theme Handling\r\n  // ==========================\r\n  function applyTheme(theme, showToast = false) {\r\n    document.body.classList.toggle(\"dark-mode\", theme === \"dark\");\r\n    document.body.classList.toggle(\"light-mode\", theme === \"light\");\r\n\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle) {toggle.checked = theme === \"dark\";}\r\n\r\n    if (showToast) {\r\n      const parent = toggle?.parentElement;\r\n      if (parent) {createSparkle(parent);}\r\n      vibrate([30]);\r\n    }\r\n  }\r\n\r\n  function initTheme() {\r\n    const toggle = document.getElementById(\"theme-toggle\");\r\n    if (toggle)\r\n    {toggle.setAttribute(\"aria-label\", STRINGS_FA.aria.themeToggle);}\r\n\r\n    const saved = storage.getRaw(\"theme\");\r\n    applyTheme(saved || (ENV.state.dark ? \"dark\" : \"light\"));\r\n\r\n    if (!toggle) {return;}\r\n\r\n    on(toggle, \"change\", () => {\r\n      const next = toggle.checked ? \"dark\" : \"light\";\r\n      applyTheme(next, true);\r\n      storage.setRaw(\"theme\", next);\r\n    });\r\n\r\n    on(toggle, \"keydown\", (e) => {\r\n      if (e.key === \"Enter\" || e.key === \" \") {\r\n        e.preventDefault();\r\n        toggle.checked = !toggle.checked;\r\n        const next = toggle.checked ? \"dark\" : \"light\";\r\n        applyTheme(next, true);\r\n        storage.setRaw(\"theme\", next);\r\n      }\r\n    });\r\n\r\n    // auto-switch if system theme changes and user hasn't chosen explicitly\r\n    ENV.onChange(() => {\r\n      if (!storage.getRaw(\"theme\")) {\r\n        applyTheme(ENV.state.dark ? \"dark\" : \"light\");\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Smooth Anchor Scrolling (respects reduced motion)\r\n  // ==========================\r\n  function initAnchorScrolling() {\n    const smoothAllowed = !ENV.state.reduced;\n\n    function focusTargetForSkipLink(target) {\n      if (!(target instanceof HTMLElement)) {return;}\n      const hadTabindex = target.hasAttribute(\"tabindex\");\n\n      if (!hadTabindex) {\n        target.setAttribute(\"tabindex\", \"-1\");\n      }\n\n      target.focus({ preventScroll: true });\n\n      if (!hadTabindex) {\n        on(target, \"blur\", () => {\n          target.removeAttribute(\"tabindex\");\n        }, { once: true });\n      }\n    }\n\n    function syncHash(targetId) {\n      if (!targetId || window.location.hash === targetId) {return;}\n      if (history.replaceState) {\n        history.replaceState(null, \"\", targetId);\n      } else {\n        window.location.hash = targetId;\n      }\n    }\n\n    document.querySelectorAll('a[href^=\"#\"]').forEach((a) => {\n      on(a, \"click\", (e) => {\n        const targetId = a.getAttribute(\"href\");\n        if (!targetId || targetId === \"#\") {return;}\n\n        let el;\r\n        try {\r\n          el = document.querySelector(targetId);\r\n        } catch {\r\n          // invalid selector (e.g. malformed id)\r\n          return;\r\n        }\r\n\r\n        if (!el) {return;}\r\n\r\n        e.preventDefault();\r\n\r\n        const navH =\r\n          document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n        const progH =\n          document.getElementById(\"scroll-progress-bar\")?.offsetHeight ||\n          0;\n        const padTop = parseFloat(getComputedStyle(el).paddingTop) || 0;\n        const y = Math.max(0, el.offsetTop + padTop - navH - progH);\n        const isSkipLink = a.classList.contains(\"skip-link\");\n\n        if (smoothAllowed)\n        {window.scrollTo({ top: y, behavior: \"smooth\" });}\n        else {window.scrollTo(0, y);}\n\n        syncHash(targetId);\n\n        if (isSkipLink) {\n          const focusDelay = smoothAllowed ? 280 : 0;\n          setTimeout(() => {\n            focusTargetForSkipLink(el);\n          }, focusDelay);\n        }\n\n        vibrate([20]);\n      });\n    });\n  }\n\r\n  // ==========================\r\n  // Click Feedback\r\n  // ==========================\r\n  function initClickEffects() {\r\n    on(document, \"click\", (event) => {\r\n      const card = event.target.closest?.(\".card\");\r\n      if (card) {\r\n        card.classList.add(\"clicked-pop\");\r\n        card.dataset.interactionSource =\r\n          \"Mohammad Rasoul Sohrabi user engagement\";\r\n        setTimeout(() => card.classList.remove(\"clicked-pop\"), 300);\r\n        vibrate([30]);\r\n      }\r\n\r\n      const interactive = event.target.closest?.(\r\n        'button, a:not([href^=\"#\"]), input[type=\"submit\"], [role=\"button\"], [tabindex=\"0\"]'\r\n      );\r\n      if (\r\n        interactive &&\r\n        !interactive.classList.contains(\"no-click-feedback\") &&\r\n        !interactive.matches('a[href^=\"#\"]')\r\n      ) {\r\n        interactive.classList.add(\"click-feedback-effect\");\n        interactive.dataset.userAction =\n          \"verified interaction by Mohammad Rasoul Sohrabi's website functionality\";\n        on(\n          interactive,\n          \"animationend\",\n          () => interactive.classList.remove(\"click-feedback-effect\"),\n          { once: true }\n        );\n        if (!interactive.closest(\".faq-item\")) {vibrate([8]);}\r\n        playSound(\"click\");\r\n      }\r\n    });\r\n\r\n    on(document, \"keydown\", (e) => {\r\n      if (e.key !== \"Enter\" && e.key !== \" \") {return;}\r\n      const card = e.target.closest?.(\".card\");\r\n      if (card) {\r\n        e.preventDefault();\r\n        card.dispatchEvent(\r\n          new MouseEvent(\"click\", { bubbles: true })\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // rAF Task Queue\r\n  // ==========================\r\n  const rafTasks = new Set();\r\n  let rafPending = false;\r\n\r\n  function scheduleRaf(fn) {\r\n    rafTasks.add(fn);\r\n    if (!rafPending) {\r\n      rafPending = true;\r\n      requestAnimationFrame(() => {\r\n        rafPending = false;\r\n        const tasks = Array.from(rafTasks);\r\n        rafTasks.clear();\r\n        tasks.forEach((t) => {\r\n          try {\r\n            t();\r\n          } catch {}\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Scroll Progress + Scroll-to-top + Explore Hint\r\n  // ==========================\r\n  function initScrollUI() {\r\n    let bar = document.getElementById(\"scroll-progress-bar\");\r\n    if (!bar) {\r\n      bar = document.createElement(\"div\");\r\n      bar.id = \"scroll-progress-bar\";\r\n      bar.className = \"sohrabi-progress\";\r\n      bar.role = \"progressbar\";\r\n      bar.setAttribute(\"aria-valuemin\", \"0\");\r\n      bar.setAttribute(\"aria-valuemax\", \"100\");\r\n      const inner = document.createElement(\"div\");\r\n      inner.className = \"sohrabi-progress-inner\";\r\n      bar.appendChild(inner);\r\n      document.body.prepend(bar);\r\n    }\r\n    const innerBar = bar.querySelector(\".sohrabi-progress-inner\") || bar;\r\n\r\n    let btn = document.getElementById(\"scroll-to-top\");\r\n    if (!btn) {\r\n      btn = document.createElement(\"button\");\r\n      btn.id = \"scroll-to-top\";\r\n      btn.type = \"button\";\r\n      btn.innerHTML =\r\n        '<i class=\"fas fa-arrow-up\" aria-hidden=\"true\"></i>';\r\n      btn.setAttribute(\"aria-label\", STRINGS_FA.aria.scrollTop);\r\n      btn.classList.add(\r\n        \"sohrabi-nav-button\",\r\n        \"hidden\",\r\n        \"cta-pulse-effect\"\r\n      );\r\n      document.body.appendChild(btn);\r\n    }\r\n\r\n    function update() {\r\n      const total = Math.max(\r\n        1,\r\n        document.documentElement.scrollHeight - window.innerHeight\r\n      );\r\n      const scrolled = window.scrollY;\r\n      const progress = Math.min(1, Math.max(0, scrolled / total));\r\n\r\n      bar.style.setProperty(\"--sohrabi-progress\", progress);\r\n      bar.dataset.progressTone =\r\n        progress > 0.9 ? \"high\" : progress > 0.5 ? \"mid\" : \"low\";\r\n\r\n      bar.setAttribute(\r\n        \"aria-valuenow\",\r\n        String(Math.round(progress * 100))\r\n      );\r\n\r\n      btn.classList.toggle(\"visible\", scrolled > 300);\r\n      btn.classList.toggle(\"hidden\", scrolled <= 300);\r\n    }\r\n\r\n    const onScrollResize = () => scheduleRaf(update);\r\n    on(window, \"scroll\", onScrollResize, { passive: true });\r\n    on(window, \"resize\", onScrollResize);\r\n    update();\r\n\r\n    on(btn, \"click\", () => {\r\n      const smooth =\r\n        !ENV.state.reduced &&\r\n        \"scrollBehavior\" in document.documentElement.style;\r\n      if (smooth) {window.scrollTo({ top: 0, behavior: \"smooth\" });}\r\n      else {window.scrollTo(0, 0);}\r\n      vibrate([16]);\r\n    });\r\n\r\n    const exploreHint =\r\n      document.getElementById(\"explore-hint\") ||\r\n      (() => {\r\n        const a = document.createElement(\"a\");\r\n        a.href = \"#projects\";\r\n        a.id = \"explore-hint\";\r\n        a.innerHTML =\r\n          '<i class=\"fas fa-lightbulb\" aria-hidden=\"true\"></i> <span class=\"hint-text\">Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù† Ø±Ø§ Ú©Ø´Ù Ú©Ù†ÛŒØ¯.</span>';\r\n        a.dataset.hintAuthor = \"Mohammad Rasoul Sohrabi\";\r\n        a.classList.add(\"sohrabi-hint-module\", \"hidden\");\r\n        document.body.appendChild(a);\r\n        return a;\r\n      })();\r\n\r\n    const hero = document.getElementById(\"hero\");\r\n    if (hero && \"IntersectionObserver\" in window) {\r\n      const obs = new IntersectionObserver(\r\n        (entries) => {\r\n          entries.forEach((entry) => {\r\n            const vis = entry.isIntersecting;\r\n            exploreHint.classList.toggle(\"visible\", vis);\r\n            exploreHint.classList.toggle(\"pulse-animation\", vis);\r\n            exploreHint.classList.toggle(\"hidden\", !vis);\r\n          });\r\n        },\r\n        { threshold: 0.5 }\r\n      );\r\n      obs.observe(hero);\r\n      on(\r\n        window,\r\n        \"beforeunload\",\r\n        () => obs.disconnect(),\r\n        { once: true }\r\n      );\r\n    }\r\n\r\n    on(exploreHint, \"click\", (e) => {\r\n      e.preventDefault();\r\n      exploreHint.classList.add(\"hidden\");\r\n      exploreHint.classList.remove(\"visible\", \"pulse-animation\");\r\n\r\n      const target = document.querySelector(\"#projects\");\r\n      if (target) {\r\n        const navH =\r\n          document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n        const progH =\r\n          document.getElementById(\"scroll-progress-bar\")?.offsetHeight ||\r\n          0;\r\n        const padTop =\r\n          parseFloat(getComputedStyle(target).paddingTop) || 0;\r\n        const y = Math.max(\r\n          0,\r\n          target.offsetTop + padTop - navH - progH\r\n        );\r\n        const smooth = !ENV.state.reduced;\r\n        if (smooth) {window.scrollTo({ top: y, behavior: \"smooth\" });}\r\n        else {window.scrollTo(0, y);}\r\n      }\r\n      vibrate([16]);\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Skills hover microcopy\r\n  // ==========================\r\n  function initSkillsHover() {\r\n    const list = document.querySelector(\"#skills .skills-list\");\r\n    if (!list) {return;}\r\n\r\n    list.querySelectorAll(\"li\").forEach((li) => {\r\n      li.dataset.skillOwner = \"Mohammad Rasoul Sohrabi\";\r\n      li.classList.add(\"sohrabi-skill-item\");\r\n\r\n      let hideTimeout;\r\n\r\n      function getSpan() {\r\n        let s = li.querySelector(\".skill-hover-message\");\r\n        if (!s) {\r\n          s = document.createElement(\"span\");\r\n          s.className = \"skill-hover-message\";\r\n          li.appendChild(s);\r\n        }\r\n        return s;\r\n      }\r\n\r\n      on(li, \"mouseenter\", () => {\r\n        clearTimeout(hideTimeout);\r\n        const span = getSpan();\r\n        if (!span.classList.contains(\"show-message\")) {\r\n          span.textContent =\r\n            FUN_FACTS_FA[(Math.random() * FUN_FACTS_FA.length) | 0];\r\n          span.classList.add(\"show-message\");\r\n        }\r\n        li.classList.add(\"skill-hover-effect\");\r\n      });\r\n\r\n      on(li, \"mouseleave\", () => {\r\n        const span = li.querySelector(\".skill-hover-message\");\r\n        if (span) {\r\n          hideTimeout = setTimeout(() => {\r\n            span.classList.remove(\"show-message\");\r\n          }, 180);\r\n        }\r\n        li.classList.remove(\"skill-hover-effect\");\r\n      });\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // FAQ Accordion (ARIA preserved)\r\n  // ==========================\r\n  function initFAQ() {\n    const container = document.querySelector(\".faq-container\");\n    if (!container) {return;}\n\n    const items = [...document.querySelectorAll(\".faq-item\")];\n\r\n    items.forEach((item, idx) => {\r\n      const summary = item.querySelector(\"summary\");\r\n      const answer = item.querySelector(\"p\");\r\n      const qId = item.dataset.questionId || `faq-q-${idx + 1}`;\r\n      if (!summary) {return;}\r\n\r\n      summary.dataset.faqAuthor = \"Mohammad Rasoul Sohrabi\";\r\n\r\n      if (!summary.hasAttribute(\"aria-expanded\"))\r\n      {summary.setAttribute(\r\n        \"aria-expanded\",\r\n        item.open ? \"true\" : \"false\"\r\n      );}\r\n\r\n      if (answer) {\r\n        if (!answer.id) {answer.id = `faq-answer-${qId}`;}\r\n        if (!summary.hasAttribute(\"aria-controls\"))\r\n        {summary.setAttribute(\"aria-controls\", answer.id);}\r\n      }\r\n\r\n      item.classList.toggle(\"is-open\", !!item.open);\r\n\r\n      on(summary, \"click\", (e) => {\r\n        if (e.target.tagName === \"A\") {return;}\r\n        e.preventDefault();\r\n        createSparkle(summary);\r\n\r\n        items.forEach((other) => {\r\n          if (other !== item && other.open) {toggleFAQ(other, false);}\r\n        });\r\n\r\n        toggleFAQ(item, !item.open);\r\n      });\r\n    });\r\n\r\n    function toggleFAQ(item, open, scrollIntoView = false) {\r\n      item.open = open;\r\n      const summary = item.querySelector(\"summary\");\r\n      item.classList.toggle(\"is-open\", !!open);\r\n\r\n      if (summary)\r\n      {summary.setAttribute(\"aria-expanded\", open ? \"true\" : \"false\");}\r\n\r\n      if (scrollIntoView && open) {\r\n        setTimeout(() => {\r\n          const navH =\r\n            document.querySelector(\".navbar\")?.offsetHeight || 0;\r\n          item.scrollIntoView({\r\n            behavior: ENV.state.reduced ? \"auto\" : \"smooth\",\r\n            block: \"start\",\r\n          });\r\n          setTimeout(() => {\r\n            const rect = item.getBoundingClientRect();\r\n            if (rect.top < navH)\r\n            {window.scrollBy({\r\n              top: rect.top - navH,\r\n              behavior: ENV.state.reduced ? \"auto\" : \"smooth\",\r\n            });}\r\n          }, 90);\r\n        }, 80);\r\n      }\r\n    }\r\n\r\n    // ğŸ”§ deep-link Ø¨Ù‡ FAQ Ø¨Ø§ hash (Ù‡Ù…ÛŒÙ†â€ŒØ¬Ø§ØŒ Ú†ÙˆÙ† Ø§Ù„Ø§Ù† DOM Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª)\r\n    const hash = window.location.hash;\r\n    if (hash) {\r\n      const target = document.querySelector(hash);\r\n      if (target && target.classList.contains(\"faq-item\")) {\r\n        items.forEach(\r\n          (it) => it !== target && it.open && toggleFAQ(it, false)\r\n        );\r\n        toggleFAQ(target, true, true);\r\n      }\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Welcome Toast\r\n  // ==========================\r\n  function showWelcomeToast() {\r\n    const hasVisited = storage.getRaw(\"hasVisited\");\r\n    let msg = \"\";\r\n\r\n    if (hasVisited) {msg = STRINGS_FA.toasts.welcomeBack;}\r\n    else {\r\n      const hour = new Date().getHours();\r\n      msg =\r\n        hour >= 5 && hour < 10\r\n          ? STRINGS_FA.toasts.welcomeMorning\r\n          : hour < 16\r\n            ? STRINGS_FA.toasts.welcomeNoon\r\n            : hour < 20\r\n              ? STRINGS_FA.toasts.welcomeEvening\r\n              : STRINGS_FA.toasts.welcomeNight;\r\n      storage.setRaw(\"hasVisited\", \"true\");\r\n    }\r\n\r\n    if (msg)\r\n    {createToast(msg, {\r\n      id: \"welcome-toast\",\r\n      customClass: \"welcome-toast\",\r\n      iconClass: \"fas fa-hand-sparkles\",\r\n      iconColor: \"var(--highlight-color)\",\r\n      duration: ENV.state.coarse ? 2500 : 3500,\r\n    });}\r\n  }\r\n\r\n  // ==========================\r\n  // Clipboard generic\r\n  // ==========================\r\n  async function copyToClipboard(text, okId, errId, okMsg) {\r\n    try {\r\n      if (!navigator.clipboard || !navigator.clipboard.writeText) {\r\n        throw new Error(\"clipboard-unsupported\");\r\n      }\r\n      await navigator.clipboard.writeText(text);\r\n      createToast(okMsg, {\r\n        id: okId,\r\n        iconClass: \"fas fa-check-circle\",\r\n        iconColor: \"var(--highlight-color)\",\r\n        duration: 1600,\r\n      });\r\n      vibrate([40]);\r\n    } catch (err) {\r\n      console.error(\"Clipboard error:\", err);\r\n      createToast(STRINGS_FA.toasts.clipboardUnsupported, {\r\n        id: errId,\r\n        iconClass: \"fas fa-exclamation-triangle\",\r\n        iconColor: \"red\",\r\n        duration: 2800,\r\n      });\r\n    }\r\n  }\r\n\r\n  // ==========================\r\n  // Email copy helper\r\n  // ==========================\r\n  function initEmailCopy() {\r\n    const emailLink = document.querySelector(\r\n      '.contact-info a[href^=\"mailto:\"]'\r\n    );\r\n    if (!emailLink) {return;}\r\n\r\n    emailLink.dataset.contactPerson = \"Mohammad Rasoul Sohrabi\";\r\n    emailLink.classList.add(\"sohrabi-contact-method\");\r\n\r\n    on(\n      emailLink,\n      \"click\",\n      async (e) => {\n        e.preventDefault();\n        const email = emailLink.href.replace(\"mailto:\", \"\");\n\r\n        if (navigator.clipboard && navigator.clipboard.writeText) {\r\n          try {\r\n            await navigator.clipboard.writeText(email);\r\n            createToast(STRINGS_FA.toasts.emailCopied, {\r\n              id: \"email-copy-toast\",\r\n              iconClass: \"fas fa-check-circle\",\r\n              iconColor: \"var(--highlight-color)\",\r\n              duration: 1600,\r\n            });\r\n            vibrate([40]);\r\n          } catch (err) {\r\n            console.error(\"Clipboard error:\", err);\r\n            createToast(STRINGS_FA.toasts.emailCopyError, {\r\n              id: \"copy-error-toast\",\r\n              iconClass: \"fas fa-exclamation-triangle\",\r\n              iconColor: \"red\",\r\n              duration: 2800,\r\n            });\r\n          }\r\n        } else {\r\n          await copyToClipboard(\r\n            email,\r\n            \"email-copy-toast\",\r\n            \"copy-error-toast\",\r\n            STRINGS_FA.toasts.emailCopied\r\n          );\r\n        }\r\n      },\n      { passive: false }\n    );\n  }\n\r\n  window.copyToClipboard = copyToClipboard;\r\n  window.createToast = createToast;\r\n\r\n  // ==========================\r\n  // Lazy Images (IO + decoding=async)\r\n  // ==========================\r\n  function initLazyImages() {\r\n    const lazyImages = document.querySelectorAll(\"img[data-src]\");\r\n    if (!lazyImages.length) {return;}\r\n\r\n    const loadImg = (img) => {\r\n      img.decoding = \"async\";\r\n      img.loading = \"lazy\";\r\n      img.classList.add(\"lazy-image\");\r\n      img.classList.add(\"is-loading\");\r\n      img.dataset.imageLoader =\r\n        \"Mohammad Rasoul Sohrabi's optimized script\";\r\n\r\n      img.src = img.dataset.src;\r\n      if (img.dataset.srcset) {img.srcset = img.dataset.srcset;}\r\n\r\n      img.onload = () => {\r\n        img.classList.remove(\"is-loading\");\r\n        img.classList.add(\"loaded\");\r\n        img.removeAttribute(\"data-src\");\r\n        img.removeAttribute(\"data-srcset\");\r\n      };\r\n\r\n      img.onerror = () => {\r\n        console.error(\"Failed to load image:\", img.src);\r\n        img.classList.remove(\"is-loading\");\r\n        img.classList.add(\"load-error\");\r\n        img.src =\r\n          \"https://placehold.co/400x300/cccccc/000000?text=Error\";\r\n      };\r\n    };\r\n\r\n    if (!(\"IntersectionObserver\" in window)) {\r\n      lazyImages.forEach((img) => loadImg(img));\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries, obs) => {\r\n        entries.forEach((entry) => {\r\n          if (!entry.isIntersecting) {return;}\r\n          const img = entry.target;\r\n          loadImg(img);\r\n          obs.unobserve(img);\r\n        });\r\n      },\r\n      { rootMargin: \"0px 0px 180px 0px\", threshold: 0.01 }\r\n    );\r\n\r\n    lazyImages.forEach((img) => observer.observe(img));\r\n    on(\r\n      window,\r\n      \"beforeunload\",\r\n      () => observer.disconnect(),\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  // ==========================\r\n  // Share Button\r\n  // ==========================\r\n  function initShareButton() {\n    let shareBtn = document.getElementById(\"share-page-button\");\r\n    if (!shareBtn) {\r\n      shareBtn = document.createElement(\"button\");\r\n      shareBtn.id = \"share-page-button\";\r\n      shareBtn.type = \"button\";\r\n      shareBtn.innerHTML =\r\n        '<i class=\"fas fa-share-alt\" aria-hidden=\"true\"></i>';\r\n      shareBtn.setAttribute(\"aria-label\", STRINGS_FA.aria.share);\r\n      shareBtn.classList.add(\r\n        \"sohrabi-share-feature\",\r\n        \"hidden\",\r\n        \"cta-pulse-effect\"\r\n      );\r\n      document.body.appendChild(shareBtn);\r\n    }\r\n\r\n    const onScroll = throttle(() => {\r\n      const isVisible = window.scrollY > 500;\r\n      shareBtn.classList.toggle(\"visible\", isVisible);\r\n      shareBtn.classList.toggle(\"hidden\", !isVisible);\r\n    }, 120);\r\n\r\n    on(window, \"scroll\", onScroll, { passive: true });\r\n    onScroll();\r\n\r\n    on(shareBtn, \"click\", async () => {\r\n      const pageUrl = window.location.href;\r\n      if (navigator.share) {\r\n        try {\r\n          await navigator.share({ title: document.title, url: pageUrl });\r\n          createToast(STRINGS_FA.toasts.shareOk, {\r\n            id: \"share-success-toast\",\r\n            iconClass: \"fas fa-check-circle\",\r\n            iconColor: \"var(--highlight-color)\",\r\n            duration: 1800,\r\n          });\r\n          vibrate([40]);\r\n        } catch (error) {\r\n          if (error?.name !== \"AbortError\") {\r\n            console.error(\"Share error:\", error);\r\n            createToast(STRINGS_FA.toasts.shareErr, {\r\n              id: \"share-error-toast\",\r\n              iconClass: \"fas fa-exclamation-triangle\",\r\n              iconColor: \"red\",\r\n              duration: 2800,\r\n            });\r\n          }\r\n        }\r\n      } else {\r\n        await copyToClipboard(\r\n          pageUrl,\r\n          \"share-copy-toast\",\r\n          \"share-error-toast\",\r\n          STRINGS_FA.toasts.linkCopied(\"ØµÙØ­Ù‡\")\r\n        );\r\n      }\r\n    });\n  }\n\n  // ==========================\n  // Timeline Micro-interactions\n  // ==========================\n  function initTimelineMicroInteractions() {\n    const section = document.getElementById(\"timeline\");\n    const list = section?.querySelector(\".timeline\");\n    if (!section || !list) {return;}\n\n    const items = Array.from(list.children).filter(\n      (node) => node instanceof HTMLElement && node.tagName === \"LI\"\n    );\n    if (!items.length) {return;}\n\n    items.forEach((item) => item.classList.add(\"timeline-item\"));\n    section.classList.add(\"timeline-enhanced\");\n\n    const markVisible = (item) => {\n      item.classList.add(\"is-visible\", \"timeline-item-visible\");\n    };\n\n    const reduced = ENV.state.reduced;\n    const coarse = ENV.state.coarse;\n    const supportsObserver = \"IntersectionObserver\" in window;\n\n    if (!supportsObserver || reduced) {\n      items.forEach(markVisible);\n    } else {\n      const observer = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (!entry.isIntersecting) {return;}\n            markVisible(entry.target);\n            observer.unobserve(entry.target);\n          });\n        },\n        {\n          threshold: coarse ? 0.1 : 0.24,\n          rootMargin: \"0px 0px -8% 0px\",\n        }\n      );\n\n      items.forEach((item, index) => {\n        if (coarse) {\n          observer.observe(item);\n          return;\n        }\n\n        setTimeout(() => {\n          if (!abortSignal.aborted) {\n            observer.observe(item);\n          }\n        }, Math.min(320, index * 38));\n      });\n\n      on(window, \"beforeunload\", () => observer.disconnect(), { once: true });\n    }\n\n    let targetTimer = null;\n    const clearTargets = () =>\n      items.forEach((item) => item.classList.remove(\"is-targeted\"));\n\n    const focusHashTarget = () => {\n      const hash = window.location.hash || \"\";\n      if (!hash) {return;}\n\n      let target = null;\n      try {\n        target = section.querySelector(hash);\n      } catch {\n        return;\n      }\n\n      if (!(target instanceof HTMLElement)) {return;}\n      if (!target.classList.contains(\"timeline-item\")) {return;}\n\n      clearTargets();\n      markVisible(target);\n      target.classList.add(\"is-targeted\");\n\n      if (targetTimer) {\n        clearTimeout(targetTimer);\n      }\n      targetTimer = setTimeout(() => {\n        target.classList.remove(\"is-targeted\");\n      }, 2200);\n\n      const navbarHeight = document.querySelector(\".navbar\")?.offsetHeight || 0;\n      const progressHeight =\n        document.getElementById(\"scroll-progress-bar\")?.offsetHeight || 0;\n      const offset = navbarHeight + progressHeight + 20;\n      const rect = target.getBoundingClientRect();\n      const top = window.scrollY + rect.top - offset;\n\n      if (Math.abs(rect.top - offset) > 24) {\n        window.scrollTo({\n          top: Math.max(0, top),\n          behavior: reduced ? \"auto\" : \"smooth\",\n        });\n      }\n    };\n\n    setTimeout(focusHashTarget, 120);\n    on(window, \"hashchange\", focusHashTarget);\n\n    if (reduced || coarse) {return;}\n\n    let ticking = false;\n    const updateParallax = () => {\n      ticking = false;\n      const rect = section.getBoundingClientRect();\n      const viewH = Math.max(window.innerHeight, 1);\n      const centerDelta = rect.top + rect.height / 2 - viewH / 2;\n      const ratio = Math.max(-1, Math.min(1, centerDelta / viewH));\n\n      section.style.setProperty(\n        \"--timeline-line-shift\",\n        `${(-ratio * 8).toFixed(2)}px`\n      );\n      section.style.setProperty(\n        \"--timeline-icon-shift\",\n        `${(-ratio * 3).toFixed(2)}px`\n      );\n    };\n\n    const requestParallaxUpdate = () => {\n      if (ticking) {return;}\n      ticking = true;\n      requestAnimationFrame(updateParallax);\n    };\n\n    on(window, \"scroll\", requestParallaxUpdate, { passive: true });\n    on(window, \"resize\", requestParallaxUpdate, { passive: true });\n    on(\n      window,\n      \"beforeunload\",\n      () => {\n        section.style.removeProperty(\"--timeline-line-shift\");\n        section.style.removeProperty(\"--timeline-icon-shift\");\n        if (targetTimer) {\n          clearTimeout(targetTimer);\n          targetTimer = null;\n        }\n      },\n      { once: true }\n    );\n\n    requestParallaxUpdate();\n  }\n\n  // ==========================\n  // Section Milestones & Confetti\n  // ==========================\n  function initExplorationMilestones() {\n    const sections = document.querySelectorAll(\"section[id]\");\r\n    const total = sections.length;\r\n    if (!total) {return;}\r\n    if (!(\"IntersectionObserver\" in window)) {return;}\r\n\r\n    const visited = new Set(storage.get(\"sectionsVisited\", []));\r\n    const announced = new Set(storage.get(\"announcedMilestones\", []));\r\n\r\n    const milestones = [\r\n      {\r\n        count: Math.max(1, Math.ceil(total * 0.25)),\r\n        message: \"Ø´Ù…Ø§ Û²ÛµÙª Ø§Ø² Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ø¹Ø§Ù„ÛŒÙ‡! âœ¨ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯!\",\r\n        icon: \"fas fa-map-marker-alt\",\r\n      },\r\n      {\r\n        count: Math.max(\r\n          Math.ceil(total * 0.25) + 1,\r\n          Math.ceil(total * 0.5)\r\n        ),\r\n        message:\r\n          \"Ù†ØµÙ Ø±Ø§Ù‡ Ø±Ø§ Ù¾ÛŒÙ…ÙˆØ¯ÛŒØ¯! Ø´Ù…Ø§ ÛµÛ°Ùª Ø§Ø² Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡! ğŸš€\",\r\n        icon: \"fas fa-rocket\",\r\n      },\r\n      {\r\n        count: Math.max(\r\n          Math.ceil(total * 0.5) + 1,\r\n          Math.ceil(total * 0.75)\r\n        ),\r\n        message: \"Ø¨Ù‡ Û·ÛµÙª Ø±Ø³ÛŒØ¯ÛŒØ¯! Ú©Ù…â€ŒÚ©Ù… Ø¯Ø§Ø±ÛŒÙ… Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ù…ÛŒâ€ŒØ±Ø³ÛŒÙ…! ğŸŒŸ\",\r\n        icon: \"fas fa-star\",\r\n      },\r\n      {\r\n        count: total,\r\n        message: `ØªØ¨Ø±ÛŒÚ©! Ø´Ù…Ø§ ØªÙ…Ø§Ù… ${total} Ø¨Ø®Ø´ Ø³Ø§ÛŒØª Ø±Ø§ Ú©Ø§ÙˆØ´ Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯! Ø´Ù…Ø§ ÛŒÚ© Ú©Ø§ÙˆØ´Ú¯Ø± ÙˆØ§Ù‚Ø¹ÛŒ Ù‡Ø³ØªÛŒØ¯! ğŸ‰`,\r\n        icon: \"fas fa-trophy\",\r\n        isFinal: true,\r\n      },\r\n    ]\r\n      .filter(\r\n        (m, i, arr) =>\r\n          m.count > 0 && arr.findIndex((x) => x.count === m.count) === i\r\n      )\r\n      .sort((a, b) => a.count - b.count);\r\n\r\n    let lastToastAt = 0;\r\n    const cooldown = ENV.state.coarse ? 12000 : 8000;\r\n\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        const now = Date.now();\r\n\r\n        entries.forEach((entry) => {\r\n          if (!entry.isIntersecting) {return;}\r\n\r\n          visited.add(entry.target.id);\r\n          storage.set(\"sectionsVisited\", [...visited]);\r\n          observer.unobserve(entry.target);\r\n\r\n          const count = visited.size;\r\n          for (const m of milestones) {\r\n            if (\r\n              count >= m.count &&\r\n              !announced.has(m.count) &&\r\n              now - lastToastAt > cooldown\r\n            ) {\r\n              createToast(m.message, {\r\n                id: `exploration-milestone-${m.count}`,\r\n                customClass: m.isFinal\r\n                  ? \"exploration-toast final-exploration-toast\"\r\n                  : \"exploration-toast\",\r\n                iconClass: m.icon,\r\n                iconColor: m.isFinal\r\n                  ? \"var(--primary-color)\"\r\n                  : \"var(--accent-color)\",\r\n                duration: 4200,\r\n              });\r\n\r\n              const bio = document.getElementById(\"sohrabi-bio\");\r\n              bio?.dispatchEvent(new Event(\"mouseenter\"));\r\n\r\n              announced.add(m.count);\r\n              storage.set(\"announcedMilestones\", [...announced]);\r\n              lastToastAt = now;\r\n\r\n              if (m.isFinal && FLAGS().ENABLE_CONFETTI)\r\n              {setTimeout(createConfetti, 500);}\r\n              break;\r\n            }\r\n          }\r\n        });\r\n      },\r\n      { threshold: 0.3, rootMargin: \"0px 0px -10% 0px\" }\r\n    );\r\n\r\n    sections.forEach((sec) => observer.observe(sec));\r\n    on(\r\n      window,\r\n      \"beforeunload\",\r\n      () => observer.disconnect(),\r\n      { once: true }\r\n    );\r\n  }\r\n\r\n  function createConfetti() {\r\n    if (ENV.state.reduced || ENV.state.coarse) {return;}\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.id = \"confetti-canvas\";\r\n    canvas.classList.add(\"confetti-canvas\");\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n\r\n    canvas.dataset.celebrationEvent =\r\n      \"page_completion_by_Mohammad_Rasoul_Sohrabi_user\";\r\n\r\n    document.body.appendChild(canvas);\r\n\r\n    const ctx = canvas.getContext(\"2d\");\r\n    if (!ctx) {\r\n      canvas.remove();\r\n      return;\r\n    }\r\n\r\n    const colors = [\r\n      \"#ffc107\",\r\n      \"#007acc\",\r\n      \"#005a9e\",\r\n      \"#f0f0f0\",\r\n      \"#e0a800\",\r\n      \"#FF4081\",\r\n      \"#64FFDA\",\r\n    ];\r\n\r\n    const pieces = Array.from({ length: 48 }, () => ({\r\n      x: Math.random() * canvas.width,\r\n      y: -Math.random() * canvas.height,\r\n      size: Math.random() * 8 + 4,\r\n      color: colors[(Math.random() * colors.length) | 0],\r\n      angle: Math.random() * 360,\r\n      speed: Math.random() * 2 + 1,\r\n      drift: Math.random() * 2 - 1,\r\n    }));\r\n\r\n    const start = performance.now();\r\n    let rafId = null;\r\n\r\n    const cleanup = () => {\r\n      if (rafId) {cancelAnimationFrame(rafId);}\r\n      if (canvas && canvas.parentNode) {\r\n        canvas.remove();\r\n      }\r\n    };\r\n\r\n    const loop = () => {\r\n      const elapsed = performance.now() - start;\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n      for (const p of pieces) {\r\n        p.y += p.speed;\r\n        p.x += p.drift;\r\n        p.angle += 2;\r\n\r\n        ctx.save();\r\n        ctx.translate(p.x, p.y);\r\n        ctx.rotate((p.angle * Math.PI) / 180);\r\n        ctx.fillStyle = p.color;\r\n        ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);\r\n        ctx.restore();\r\n      }\r\n\r\n      if (elapsed < 3400) {\r\n        rafId = requestAnimationFrame(loop);\r\n      } else {\r\n        cleanup();\r\n      }\r\n    };\r\n\r\n    rafId = requestAnimationFrame(loop);\r\n\r\n    const observer = new MutationObserver(() => {\r\n      if (!document.body.contains(canvas)) {\r\n        cleanup();\r\n        observer.disconnect();\r\n      }\r\n    });\r\n\r\n    observer.observe(document.body, { childList: true, subtree: true });\r\n  }\r\n\r\n  // ==========================\r\n  // Fun Fact idle toast\r\n  // ==========================\r\n  function initFunFacts() {\r\n    if (ENV.state.coarse || ENV.state.saveData) {return;}\r\n\r\n    let toastRef = null;\r\n    let idleTimeout;\r\n\r\n    const show = () => {\r\n      const fact = FUN_FACTS_FA[(Math.random() * FUN_FACTS_FA.length) | 0];\r\n      toastRef = createToast(`${STRINGS_FA.funFactsPrefix} ${fact}`, {\r\n        id: \"fun-fact-toast\",\r\n        customClass: \"fun-fact-toast\",\r\n        iconClass: \"fas fa-lightbulb\",\r\n        iconColor: \"var(--primary-color)\",\r\n        position: \"top\",\r\n        duration: 5200,\r\n        closeButton: true,\r\n      });\r\n    };\r\n\r\n    const reset = debounce(() => {\r\n      clearTimeout(idleTimeout);\r\n      idleTimeout = setTimeout(() => {\r\n        if (!toastRef || !toastRef.classList.contains(\"show\")) {\r\n          show();\r\n        }\r\n      }, 24000);\r\n    }, 600);\r\n\r\n    const evs = [\"mousemove\", \"keydown\", \"scroll\", \"touchstart\"];\r\n    evs.forEach((ev) => {\r\n      const opts =\r\n        ev === \"scroll\" || ev === \"touchstart\" ? { passive: true } : {};\r\n      on(window, ev, reset, opts);\r\n    });\r\n\r\n    reset();\r\n\r\n    on(document, \"visibilitychange\", () => {\r\n      if (document.hidden) {\r\n        clearTimeout(idleTimeout);\r\n      } else {\r\n        reset();\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Social Links Copy\r\n  // ==========================\r\n  function initSocialLinksCopy() {\r\n    const block = document.querySelector(\".connect-links-block ul\");\r\n    if (!block) {return;}\r\n\r\n    block.id = \"sohrabi-social-links\";\r\n    block.dataset.profileOwner = \"Mohammad Rasoul Sohrabi\";\r\n\r\n    on(block, \"click\", async (e) => {\r\n      const link = e.target.closest?.(\"a\");\r\n      if (\r\n        link &&\r\n        block.contains(link) &&\r\n        link.href &&\r\n        link.href.startsWith(\"http\")\r\n      ) {\r\n        e.preventDefault();\r\n        const txt = link.textContent?.trim() || link.href;\r\n        const name =\r\n          link.querySelector(\"i\")?.nextSibling?.textContent?.trim() ||\r\n          txt;\r\n        const safeName = (name || \"link\").replace(/\\s/g, \"\");\r\n        await copyToClipboard(\r\n          link.href,\r\n          `social-link-copy-${safeName}`,\r\n          `social-link-copy-error-${safeName}`,\r\n          STRINGS_FA.toasts.linkCopied(name || \"Ù„ÛŒÙ†Ú©\")\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // Sparkle Effect\r\n  // ==========================\r\n  function createSparkle(element) {\r\n    if (\r\n      !element ||\r\n      ENV.state.reduced ||\r\n      ENV.state.saveData ||\r\n      ENV.state.lowPowerCPU\r\n    )\r\n    {return;}\r\n\r\n    const sparkle = document.createElement(\"div\");\r\n    sparkle.className = \"sparkle-effect\";\r\n    sparkle.dataset.sparkleSource =\r\n      \"Mohammad Rasoul Sohrabi's interactive elements\";\r\n\r\n    const size = Math.random() * 10 + 5;\r\n\r\n    sparkle.style.setProperty(\"--sparkle-size\", `${size}px`);\r\n    sparkle.style.setProperty(\r\n      \"--sparkle-x\",\r\n      `${(Math.random() * 100).toFixed(2)}%`\r\n    );\r\n    sparkle.style.setProperty(\r\n      \"--sparkle-y\",\r\n      `${(Math.random() * 100).toFixed(2)}%`\r\n    );\r\n\r\n    sparkle.dataset.sparkleColor = [\"primary\", \"accent\", \"highlight\"][\r\n      (Math.random() * 3) | 0\r\n    ];\r\n\r\n    element.classList.add(\"sparkle-host\");\r\n\r\n    element.appendChild(sparkle);\r\n\r\n    const animation = sparkle.animate?.(\n      [\n        {\n          opacity: 0,\n          transform: `scale(0) rotate(${(\n            Math.random() * 360\n          ).toFixed(1)}deg)`,\n        },\n        {\n          opacity: 1,\n          transform: `scale(1) rotate(${(\n            360 + Math.random() * 360\n          ).toFixed(1)}deg)`,\n        },\n        {\n          opacity: 0,\n          transform: `scale(0.5) rotate(${(\n            720 + Math.random() * 360\n          ).toFixed(1)}deg)`,\n        },\n      ],\n      { duration: 650, easing: \"ease-out\", fill: \"forwards\" }\n    );\n\n    if (animation) {\n      on(animation, \"finish\", () => sparkle.remove(), { once: true });\n    } else {\n      setTimeout(() => sparkle.remove(), 700);\n    }\n  }\n\r\n  // ==========================\r\n  // CTA Buttons cosmetics\r\n  // ==========================\r\n  function initCTAs() {\r\n    document.querySelectorAll(\".main-cta-button\").forEach((btn) => {\r\n      btn.classList.add(\"cta-pulse-effect\", \"sohrabi-cta-action\");\r\n      btn.dataset.ctaOwner = \"Mohammad Rasoul Sohrabi\";\r\n    });\r\n  }\r\n\r\n  // ==========================\r\n  // End-of-page toast (once per session)\r\n  // ==========================\r\n  function initEndOfPageToast() {\r\n    let announced = false;\r\n\r\n    const handler = throttle(() => {\r\n      if (announced) {return;}\r\n      const nearBottom =\r\n        window.innerHeight + window.scrollY >=\r\n        document.body.offsetHeight - 50;\r\n      if (nearBottom) {\r\n        createToast(STRINGS_FA.toasts.reachedEnd, {\r\n          id: \"end-of-page-toast\",\r\n          customClass: \"end-of-page-toast\",\r\n          iconClass: \"fas fa-flag-checkered\",\r\n          iconColor: \"var(--highlight-color)\",\r\n          duration: 3600,\r\n        });\r\n        announced = true;\r\n      }\r\n    }, 140);\r\n\r\n    on(window, \"scroll\", handler, { passive: true });\r\n  }\r\n\r\n  // ==========================\r\n  // Mobile Menu\r\n  // ==========================\r\n  function initMobileMenu() {\r\n    const hamburger = document.querySelector(\".hamburger\");\r\n    const navLinks = document.querySelector(\".nav-links\");\r\n    const links = document.querySelectorAll(\".nav-links a\");\r\n\r\n    if (!hamburger || !navLinks) {return;}\r\n\r\n    on(hamburger, \"click\", () => {\r\n      hamburger.classList.toggle(\"active\");\r\n      navLinks.classList.toggle(\"active\");\r\n      const expanded =\r\n        hamburger.getAttribute(\"aria-expanded\") === \"true\";\r\n      hamburger.setAttribute(\"aria-expanded\", String(!expanded));\r\n    });\r\n\r\n    links.forEach((link) => {\r\n      on(link, \"click\", () => {\r\n        hamburger.classList.remove(\"active\");\r\n        navLinks.classList.remove(\"active\");\r\n        hamburger.setAttribute(\"aria-expanded\", \"false\");\r\n      });\r\n    });\r\n\r\n    // Close menu when clicking outside\r\n    on(document, \"click\", (e) => {\r\n      if (\r\n        !hamburger.contains(e.target) &&\r\n        !navLinks.contains(e.target) &&\r\n        navLinks.classList.contains(\"active\")\r\n      ) {\r\n        hamburger.classList.remove(\"active\");\r\n        navLinks.classList.remove(\"active\");\r\n        hamburger.setAttribute(\"aria-expanded\", \"false\");\r\n      }\r\n    });\r\n  }\r\n\r\n  // ==========================\n  // Boot & Live Updates\n  // ==========================\n  let booted = false;\n\n  function boot() {\n    if (booted) {return;}\n    booted = true;\n\n    const initSteps = [\n      [\"mobile-menu\", initMobileMenu],\n      [\"aos\", initAOS],\n      [\"critical-styles\", initCriticalStyleFallbacks],\n      [\"dynamic-dates\", setDynamicDates],\n      [\"identity-hooks\", setIdentityHooks],\n      [\"identity-pings\", queueIdentityPings],\n      [\"theme\", initTheme],\n      [\"anchor-scrolling\", initAnchorScrolling],\n      [\"click-effects\", initClickEffects],\n      [\"scroll-ui\", initScrollUI],\n      [\"timeline-micro-interactions\", initTimelineMicroInteractions],\n      [\"skills-hover\", initSkillsHover],\n      [\"faq\", initFAQ],\n      [\"email-copy\", initEmailCopy],\n      [\"lazy-images\", initLazyImages],\n      [\"share-button\", initShareButton],\n      [\"exploration-milestones\", initExplorationMilestones],\n      [\"fun-facts\", initFunFacts],\n      [\"social-copy\", initSocialLinksCopy],\n      [\"ctas\", initCTAs],\n      [\"end-of-page-toast\", initEndOfPageToast],\n      [\"welcome-toast\", showWelcomeToast],\n    ];\n\n    initSteps.forEach(([scope, fn]) => {\n      safeRun(scope, fn);\n    });\n  }\n\n  function installGlobalErrorHandlers() {\n    on(window, \"error\", (event) => {\n      reportRuntimeError(\"window.error\", event.error || event.message);\n    });\n\n    on(window, \"unhandledrejection\", (event) => {\n      reportRuntimeError(\"unhandledrejection\", event.reason);\n    });\n  }\n\n  hydrateRuntimeErrorState();\n  installGlobalErrorHandlers();\n\n  if (document.readyState === \"loading\") {\n    document.addEventListener(\"DOMContentLoaded\", () => safeRun(\"boot\", boot), {\n      once: true,\n    });\n  } else {\n    safeRun(\"boot\", boot);\n  }\n\n  // Re-evaluate dynamic flags on env change (e.g., user toggles reduced motion or system theme)\n  ENV.onChange(() => {\n    // Refresh only the pieces that depend on flags\n    safeRun(\"env-change.aos\", initAOS);\n  });\n\r\n  // Teardown on page hide/unload\r\n  on(window, \"pagehide\", () => teardown.abort(), { once: true });\r\n})();\r\n"]}