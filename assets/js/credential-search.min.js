!function(){"use strict";"undefined"!=typeof window&&"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("credential-search"),t=document.getElementById("clear-credential-search"),n=document.getElementById("voice-search-btn"),r=document.getElementById("results-info"),a=document.querySelectorAll(".credential-card"),o=r&&r.dataset.lang||document.documentElement.lang||"en";if(!e||!t||!a.length)return;const s=o.toLowerCase().startsWith("fa"),c="credentialSearchTerm";r&&(r.setAttribute("aria-live","polite"),r.setAttribute("aria-atomic","true"));const i=function(){const e="__credential_search__";try{return localStorage.setItem(e,e),localStorage.removeItem(e),localStorage}catch{return null}}();function l(e,t){if(e&&"function"==typeof window.createToast)try{return window.createToast(e,t)}catch{try{return window.createToast(e)}catch{}}}const d=e=>(e||"").normalize("NFC").replace(/[ي]/g,"ی").replace(/[ك]/g,"ک").replace(/[\u064B-\u065F\u0670]/g,"").replace(/‌/g,"").toLowerCase(),u=(e,t)=>{if(!e)return;if(e.querySelectorAll("mark.search-highlight").forEach(e=>{const t=e.parentNode;t&&(t.replaceChild(document.createTextNode(e.textContent||""),e),t.normalize())}),!t)return;const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),r=[],a=d(t).split("").map(e=>{const t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return"ی"===e?"[یي]":"ک"===e?"[کك]":t}).join("[\\u064B-\\u065F\\u0670\\u200c\\u200d]*");if(!a)return;const o=new RegExp(`(${a})`,"gi");for(;n.nextNode();){const e=n.currentNode;!e.nodeValue||e.parentNode&&e.parentNode.classList&&e.parentNode.classList.contains("search-highlight")||(o.lastIndex=0,o.test(e.nodeValue)&&r.push(e))}r.forEach(e=>{if(!e.parentNode)return;const t=document.createDocumentFragment();o.lastIndex=0;e.nodeValue.split(o).forEach((e,n)=>{if(n%2==1){const n=document.createElement("mark");n.className="search-highlight",n.textContent=e,t.appendChild(n)}else e&&t.appendChild(document.createTextNode(e))}),e.parentNode.replaceChild(t,e)})},m=[];let p;a.forEach(e=>{const t=e.querySelector("h3"),n=e.querySelector(".credential-summary");t&&!t.dataset.original&&(t.dataset.original=t.textContent||""),n&&!n.dataset.original&&(n.dataset.original=n.textContent||"");const r=[t?.dataset.original?d(t.dataset.original):"",n?.dataset.original?d(n.dataset.original):"",d(e.dataset.keywords||"")].filter(Boolean).join(" ");e.dataset.searchIndex=r,m.push({card:e,nameEl:t||null,summaryEl:n||null,searchIndex:r})});const h=e=>{if(i)try{e?i.setItem(c,e):i.removeItem(c)}catch{}},y=t=>{const n=void 0!==t?t:e.value.trim()||"",a=d(n);let o=0;m.forEach(e=>{const{card:t,nameEl:r,summaryEl:s,searchIndex:c}=e;!a||c.includes(a)?(t.style.display="grid",u(r,n),u(s,n),o++):(t.style.display="none",u(r,""),u(s,""))}),(e=>{if(r)if(s)r.textContent=0===e?"موردی یافت نشد":`${e} نتیجه یافت شد`;else{const t=1===e?"result":"results";r.textContent=0===e?"No results found":`${e} ${t} found`}})(o)},f=()=>{e.value="",t.style.display="none",clearTimeout(p),h(""),y(""),e.focus()};let g=null;const v=[];(()=>{const n=i?.getItem(c)||"";n&&(e.value=n,t.style.display="block"),y(n)})(),e.addEventListener("input",()=>{const n=e.value.trim();t.style.display=n?"block":"none",h(n),clearTimeout(p),p=setTimeout(()=>y(n),200)}),t.addEventListener("click",f),e.addEventListener("keydown",e=>{"Escape"===e.key&&(e.preventDefault(),f())}),(()=>{if(!n)return;const r=window.SpeechRecognition||window.webkitSpeechRecognition;if(!r)return n.style.display="none",void l(s?"مرورگر شما از جستجوی صوتی پشتیبانی نمی‌کند.":"Voice search isn't supported.");g=new r,g.lang=s?"fa-IR":"en-US",g.interimResults=!1;const a=()=>{try{g.start()}catch{}},o=()=>{n.classList.add("listening"),n.setAttribute("aria-pressed","true")},c=()=>{n.classList.remove("listening"),n.setAttribute("aria-pressed","false")},i=n=>{const r=(n.results[0][0].transcript||"").trim();e.value=r,t.style.display=r?"block":"none",h(r),clearTimeout(p),y(r)},d=e=>{(!e||"no-speech"!==e.error&&"aborted"!==e.error)&&l(s?"امکان دریافت صدا نیست.":"Voice recognition unavailable.")};n.addEventListener("click",a),g.addEventListener("start",o),g.addEventListener("end",c),g.addEventListener("result",i),g.addEventListener("error",d),v.push(()=>{try{g.abort()}catch{}n.removeEventListener("click",a),g.removeEventListener("start",o),g.removeEventListener("end",c),g.removeEventListener("result",i),g.removeEventListener("error",d)})})(),(()=>{const t=t=>{const n=document.activeElement;if(("/"===t.key||"k"===t.key.toLowerCase()&&(t.ctrlKey||t.metaKey))&&!(e=>{if(!e)return!1;const t=e.tagName;return"INPUT"===t||"TEXTAREA"===t||!0===e.isContentEditable})(n)&&n!==e)return t.preventDefault(),void e.focus();"Escape"===t.key&&n===e&&(t.preventDefault(),f())};document.addEventListener("keydown",t),v.push(()=>{document.removeEventListener("keydown",t)})})(),window.addEventListener("beforeunload",()=>{clearTimeout(p),v.forEach(e=>{try{e()}catch{}})})})}();
//# sourceMappingURL=credential-search.min.js.map
