document.addEventListener("DOMContentLoaded",function(){let i=document.documentElement.lang||"en",a={success:i.startsWith("fa")?"کپی شد! ✅":"Copied! ✅",fail:i.startsWith("fa")?"عملیات کپی ناموفق بود.":"Failed to copy.",unsupported:i.startsWith("fa")?"مرورگر از کپی پشتیبانی نمی‌کند.":"Your browser does not support copying."};function t(e){var e=e.currentTarget;let t=e.dataset.copyText||"";(t=!t&&(e=e.dataset.copyTarget,e=document.getElementById(e))?e.textContent.trim():t)&&(navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(()=>{"function"==typeof createToast&&createToast(a.success)}).catch(e=>{console.error("Copy failed:",e),"function"==typeof createToast&&createToast(a.fail)}):"function"==typeof createToast&&createToast(a.unsupported))}document.querySelectorAll(".copy-button").forEach(e=>{e.addEventListener("click",t)});let o=document.getElementById("security-timeline-list");function n(){var e=document.querySelectorAll(".timeline li");if("IntersectionObserver"in window){let t=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("timeline-item-visible"),t.unobserve(e.target))})},{threshold:.3});e.forEach(e=>t.observe(e))}else e.forEach(e=>e.classList.add("timeline-item-visible"));let n=document.getElementById("policy-expiration");n&&fetch("/.well-known/security.txt").then(e=>e.text()).then(e=>{var t,a,e=e.match(/^Expires:\s*(.+)$/m);e?(e=new Date(e[1].trim()),a=i.startsWith("fa")?"fa-IR":"en-US",t={year:"numeric",month:"long",day:"numeric"},a=i.startsWith("fa")?"اعتبار سیاست تا "+e.toLocaleDateString(a,t):"Policy valid until "+e.toLocaleDateString(a,t),n.textContent=a,e<=new Date&&n.classList.add("expired")):n.textContent=i.startsWith("fa")?"تاریخ اعتبار در دسترس نیست.":"Expiration date unavailable."}).catch(()=>{n.textContent=i.startsWith("fa")?"خطا در دریافت تاریخ اعتبار.":"Failed to load expiration date."});e=document.getElementById("scope-domain");e&&(e.innerHTML=`<code>${location.hostname}</code>`)}o?fetch("/assets/data/security-timeline.json").then(e=>e.json()).then(e=>{e.forEach(e=>{var t=document.createElement("li"),a=(t.dataset.aos="fade-up",document.createElement("div")),n=(a.className="timeline-content",document.createElement("div")),n=(n.className="timeline-icon",n.innerHTML=`<i class="fas ${e.icon}" aria-hidden="true"></i>`,a.appendChild(n),document.createElement("h3")),n=(n.className="date",n.innerHTML=`<time datetime="${e.date}">${e.date}</time>`,a.appendChild(n),document.createElement("h3")),n=(n.textContent=i.startsWith("fa")?e.title_fa:e.title_en,a.appendChild(n),document.createElement("p"));n.textContent=i.startsWith("fa")?e.desc_fa:e.desc_en,a.appendChild(n),t.appendChild(a),o.appendChild(t)}),n()}).catch(()=>n()):n()});