{"version":3,"file":"faq-fa.min.js","names":["document","addEventListener","faqItems","Array","from","querySelectorAll","faqNavigation","querySelector","searchInput","getElementById","clearSearchButton","allSections","expandAllBtn","collapseAllBtn","length","debounce","func","delay","timeout","context","this","args","arguments","clearTimeout","setTimeout","apply","event","link","target","closest","category","dataset","gtag","event_category","event_label","value","hj","replace","toLowerCase","forEach","button","ctaType","linkType","status","createElement","id","setAttribute","className","parentNode","appendChild","getAttribute","updateStatus","term","count","total","trimmed","trim","noResultsMsg","textContent","style","display","handleSearch","searchTerm","visibleItemsCount","body","container","sectionHasVisibleItems","item","headerBtn","questionText","answerTextElement","answerText","keywords","includes","classList","contains","toggleItem","openedBySearch","hidden","search_term","results_count","debouncedSearch","e","key","preventDefault","section","focus","forceOpen","content","isOpen","add","maxHeight","scrollHeight","remove","window","accordionContainer","questionId","action","click","btn","stopPropagation","url","location","origin","pathname","navigator","clipboard","writeText","then","originalIcon","innerHTML","parent","b","label","originalText","color","fontWeight","hash","targetId","substring","targetItem","scrollIntoView","behavior","block","borderColor","boxShadow","matchMedia","matches"],"sources":["faq-fa.js"],"mappings":"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","ignoreList":[],"sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\r\n  \"use strict\";\r\n\r\n  const faqItems = Array.from(document.querySelectorAll(\".faq-item\"));\r\n  const faqNavigation = document.querySelector(\".faq-navigation\");\r\n  const searchInput = document.getElementById(\"faq-search\");\r\n  const clearSearchButton = document.getElementById(\"clear-search\");\r\n  const allSections = Array.from(document.querySelectorAll(\".faq-section\"));\r\n  // Support both FAQ page structure and Home page structure\r\n  const mainContent = document.querySelector(\".main-content\") || document.getElementById(\"faq-container\")?.parentElement;\r\n  const header = document.querySelector(\".page-header\");\r\n  const expandAllBtn = document.getElementById(\"expand-all-faq\");\r\n  const collapseAllBtn = document.getElementById(\"collapse-all-faq\");\r\n\r\n  // اگر هیچ FAQی نداریم، ادامه نده\r\n  if (!faqItems.length) {return;}\r\n\r\n  // Utility: simple debounce helper\r\n  function debounce(func, delay) {\r\n    let timeout;\r\n    return function () {\r\n      const context = this;\r\n      const args = arguments;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(() => func.apply(context, args), delay);\r\n    };\r\n  }\r\n\r\n  // --- GA4 & Hotjar Event Tracking Integration ---\r\n\r\n  // Track clicks on navigation links\r\n  if (faqNavigation) {\r\n    faqNavigation.addEventListener(\"click\", (event) => {\r\n      const link = event.target.closest(\"a\");\r\n      if (!link) {return;}\r\n      const category = link.dataset.category || \"unknown\";\r\n\r\n      if (typeof gtag === \"function\") {\r\n        gtag(\"event\", \"faq_nav_click\", {\r\n          event_category: \"FAQ Navigation\",\r\n          event_label: `Clicked category: ${category}`,\r\n          value: 1,\r\n        });\r\n      }\r\n      if (typeof hj === \"function\") {\r\n        hj(\r\n          \"event\",\r\n          `faq_nav_clicked_category_${category.replace(/\\s/g, \"_\").toLowerCase()}`\r\n        );\r\n      }\r\n    });\r\n  }\r\n\r\n  // Track Clicks on Call-to-Action Buttons\r\n  document.querySelectorAll(\".button-link\").forEach((button) => {\r\n    button.addEventListener(\"click\", () => {\r\n      const ctaType = button.dataset.ctaType || \"generic\";\r\n      if (typeof gtag === \"function\") {\r\n        gtag(\"event\", \"faq_cta_click\", {\r\n          event_category: \"FAQ Call to Action\",\r\n          event_label: `CTA Clicked: ${ctaType}`,\r\n          value: 1,\r\n        });\r\n      }\r\n      if (typeof hj === \"function\") {\r\n        hj(\"event\", `faq_cta_clicked_${ctaType}`);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Track Clicks on Internal Text Links\r\n  document.querySelectorAll(\".faq-answer .text-link\").forEach((link) => {\r\n    link.addEventListener(\"click\", () => {\r\n      const linkType = link.dataset.linkType || \"generic\";\r\n      if (typeof gtag === \"function\") {\r\n        gtag(\"event\", \"faq_text_link_click\", {\r\n          event_category: \"FAQ Internal Link\",\r\n          event_label: `Text link clicked: ${linkType}`,\r\n          value: 1,\r\n        });\r\n      }\r\n      if (typeof hj === \"function\") {\r\n        hj(\"event\", `faq_text_link_clicked_${linkType}`);\r\n      }\r\n    });\r\n  });\r\n\r\n  // --- FAQ Search Functionality (Cognitive Load Reduction - Information Foraging) ---\r\n\r\n  if (searchInput) {\r\n    // live region برای اعلام تعداد نتایج (برای اسکرین‌ریدر)\r\n    let status = document.getElementById(\"faq-search-status\");\r\n    if (!status) {\r\n      status = document.createElement(\"div\");\r\n      status.id = \"faq-search-status\";\r\n      status.setAttribute(\"aria-live\", \"polite\");\r\n      status.setAttribute(\"aria-atomic\", \"true\");\r\n      status.className = \"faq-search-status sr-only\";\r\n      (searchInput.closest(\"form\") || searchInput.parentNode).appendChild(\r\n        status\r\n      );\r\n    }\r\n\r\n    if (clearSearchButton && !clearSearchButton.getAttribute(\"aria-label\")) {\r\n      clearSearchButton.setAttribute(\"aria-label\", \"پاک کردن جستجوی پرسش‌ها\");\r\n    }\r\n\r\n    const updateStatus = (term, count) => {\r\n      const total = faqItems.length;\r\n      const trimmed = term.trim();\r\n      const noResultsMsg = document.getElementById(\"faq-no-results\");\r\n      \r\n      if (!trimmed) {\r\n        status.textContent = `نمایش ${total} پرسش موجود.`;\r\n        if(noResultsMsg) noResultsMsg.style.display = 'none';\r\n      } else if (!count) {\r\n        status.textContent = `هیچ نتیجه‌ای برای «${trimmed}» پیدا نشد.`;\r\n        if(noResultsMsg) {\r\n            noResultsMsg.style.display = 'block';\r\n            noResultsMsg.textContent = `نتیجه‌ای برای «${trimmed}» یافت نشد. لطفاً کلمات کلیدی دیگری را امتحان کنید.`;\r\n        }\r\n      } else {\r\n        status.textContent = `${count} نتیجه برای «${trimmed}» یافت شد.`;\r\n        if(noResultsMsg) noResultsMsg.style.display = 'none';\r\n      }\r\n    };\r\n\r\n    const handleSearch = () => {\r\n      const rawTerm = searchInput.value || \"\";\r\n      const searchTerm = rawTerm.trim().toLowerCase();\r\n\r\n      if (clearSearchButton) {\r\n        clearSearchButton.style.display = searchTerm ? \"block\" : \"none\";\r\n      }\r\n\r\n      let visibleItemsCount = 0;\r\n\r\n      // Handle sections if they exist (FAQ page), otherwise just items (Home page)\r\n      const containers = allSections.length ? allSections : [document.getElementById(\"faq-container\") || document.body];\r\n\r\n      containers.forEach((container) => {\r\n        let sectionHasVisibleItems = false;\r\n        const itemsInContainer = container.querySelectorAll(\".faq-item\");\r\n\r\n        itemsInContainer.forEach((item) => {\r\n          const headerBtn = item.querySelector(\".accordion-header\");\r\n          const questionText = headerBtn\r\n            ? headerBtn.textContent.toLowerCase()\r\n            : \"\";\r\n          const answerTextElement = item.querySelector(\".faq-answer\");\r\n          const answerText = answerTextElement\r\n            ? answerTextElement.textContent.toLowerCase()\r\n            : \"\";\r\n          const keywords = (item.dataset.keywords || \"\").toLowerCase();\r\n\r\n          const matches =\r\n            !searchTerm ||\r\n            questionText.includes(searchTerm) ||\r\n            answerText.includes(searchTerm) ||\r\n            keywords.includes(searchTerm);\r\n\r\n          if (matches) {\r\n            item.style.display = \"\"; // Reset display\r\n            sectionHasVisibleItems = true;\r\n            visibleItemsCount++;\r\n\r\n            // Highlight logic could go here\r\n\r\n            // Open item if searching\r\n            if (searchTerm && !item.classList.contains(\"is-open\")) {\r\n              toggleItem(item, true);\r\n              item.dataset.openedBySearch = \"true\";\r\n            }\r\n          } else {\r\n            item.style.display = \"none\";\r\n            // Close if it was opened by search\r\n            if (item.classList.contains(\"is-open\") && item.dataset.openedBySearch) {\r\n              toggleItem(item, false);\r\n              delete item.dataset.openedBySearch;\r\n            }\r\n          }\r\n        });\r\n\r\n        if (container.classList.contains(\"faq-section\")) {\r\n            container.hidden = !sectionHasVisibleItems;\r\n        }\r\n      });\r\n\r\n      // Track search event in GA4\r\n      if (typeof gtag === \"function\" && searchTerm.length > 2) {\r\n        gtag(\"event\", \"faq_search\", {\r\n          event_category: \"FAQ Search\",\r\n          search_term: searchTerm,\r\n          results_count: visibleItemsCount,\r\n        });\r\n      }\r\n      \r\n      updateStatus(searchTerm, visibleItemsCount);\r\n    };\r\n\r\n    const debouncedSearch = debounce(handleSearch, 200);\r\n    searchInput.addEventListener(\"input\", debouncedSearch);\r\n\r\n    // ESC برای پاک کردن سریع سرچ\r\n    searchInput.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        searchInput.value = \"\";\r\n        if(clearSearchButton) clearSearchButton.style.display = \"none\";\r\n        handleSearch();\r\n      }\r\n    });\r\n\r\n    if (clearSearchButton) {\r\n        clearSearchButton.addEventListener(\"click\", () => {\r\n        searchInput.value = \"\";\r\n        clearSearchButton.style.display = \"none\";\r\n\r\n        faqItems.forEach((item) => {\r\n            item.style.display = \"\";\r\n            if (item.classList.contains(\"is-open\") && item.dataset.openedBySearch) {\r\n            toggleItem(item, false);\r\n            delete item.dataset.openedBySearch;\r\n            }\r\n        });\r\n        allSections.forEach((section) => {\r\n            section.hidden = false;\r\n        });\r\n\r\n        updateStatus(\"\", faqItems.length);\r\n        searchInput.focus();\r\n        });\r\n    }\r\n  }\r\n\r\n  // --- Accordion Logic ---\r\n  \r\n  function toggleItem(item, forceOpen = null) {\r\n      const headerBtn = item.querySelector(\".accordion-header\");\r\n      const content = item.querySelector(\".accordion-content\");\r\n      if (!headerBtn || !content) return;\r\n\r\n      const isOpen = item.classList.contains(\"is-open\");\r\n      const shouldOpen = forceOpen !== null ? forceOpen : !isOpen;\r\n\r\n      if (shouldOpen) {\r\n          item.classList.add(\"is-open\");\r\n          headerBtn.setAttribute(\"aria-expanded\", \"true\");\r\n          content.style.maxHeight = (content.scrollHeight + 500) + \"px\"; // Add generous buffer\r\n      } else {\r\n          item.classList.remove(\"is-open\");\r\n          headerBtn.setAttribute(\"aria-expanded\", \"false\");\r\n          content.style.maxHeight = null;\r\n      }\r\n  }\r\n\r\n  // Handle resize to adjust max-height of open items\r\n  window.addEventListener('resize', debounce(() => {\r\n      faqItems.forEach(item => {\r\n          if (item.classList.contains(\"is-open\")) {\r\n              const content = item.querySelector(\".accordion-content\");\r\n              if (content) {\r\n                  content.style.maxHeight = (content.scrollHeight + 500) + \"px\";\r\n              }\r\n          }\r\n      });\r\n  }, 200));\r\n\r\n  // Event Delegation for Accordion Clicks\r\n  const accordionContainer = document.getElementById(\"faq-container\") || document.querySelector(\".main-content\");\r\n  if (accordionContainer) {\r\n      accordionContainer.addEventListener(\"click\", (event) => {\r\n          const headerBtn = event.target.closest(\".accordion-header\");\r\n          if (!headerBtn) return;\r\n\r\n          // Ignore clicks on interactive elements inside header (like copy link)\r\n          if (event.target.closest(\".copy-faq-link\") || event.target.closest(\"a\")) return;\r\n\r\n          const item = headerBtn.closest(\".accordion-item\");\r\n          if (!item) return;\r\n\r\n          // Close others (Accordion behavior) - Optional, can be toggle behavior\r\n          // faqItems.forEach(otherItem => {\r\n          //     if (otherItem !== item && otherItem.classList.contains(\"is-open\")) {\r\n          //         toggleItem(otherItem, false);\r\n          //     }\r\n          // });\r\n\r\n          toggleItem(item);\r\n          \r\n          // Analytics\r\n          const questionId = item.dataset.questionId || \"unknown\";\r\n          const action = item.classList.contains(\"is-open\") ? \"expand\" : \"collapse\";\r\n          if (typeof gtag === \"function\") {\r\n              gtag(\"event\", `faq_${action}`, {\r\n                  event_category: \"FAQ Interaction\",\r\n                  event_label: `Question ${action}ed: ${questionId}`,\r\n              });\r\n          }\r\n      });\r\n\r\n      // Keyboard support for accordion headers\r\n      accordionContainer.addEventListener(\"keydown\", (event) => {\r\n          const headerBtn = event.target.closest(\".accordion-header\");\r\n          if (!headerBtn) return;\r\n\r\n          if (event.key === \"Enter\" || event.key === \" \") {\r\n              event.preventDefault();\r\n              // Trigger click logic\r\n              headerBtn.click();\r\n          }\r\n      });\r\n  }\r\n\r\n  // Expand/Collapse All\r\n  if (expandAllBtn) {\r\n      expandAllBtn.addEventListener(\"click\", () => {\r\n          faqItems.forEach(item => {\r\n              if (item.style.display !== \"none\") toggleItem(item, true);\r\n          });\r\n      });\r\n  }\r\n\r\n  if (collapseAllBtn) {\r\n      collapseAllBtn.addEventListener(\"click\", () => {\r\n          faqItems.forEach(item => toggleItem(item, false));\r\n      });\r\n  }\r\n\r\n  // Copy Link Functionality\r\n  document.querySelectorAll(\".copy-faq-link\").forEach(btn => {\r\n      btn.addEventListener(\"click\", (e) => {\r\n          e.stopPropagation(); // Prevent accordion toggle\r\n          const link = btn.dataset.link; // e.g. #faq-item-fa-1\r\n          if (!link) return;\r\n          \r\n          const url = window.location.origin + window.location.pathname + link;\r\n          navigator.clipboard.writeText(url).then(() => {\r\n              const originalIcon = btn.innerHTML;\r\n              btn.innerHTML = '<i class=\"fas fa-check\"></i>';\r\n              btn.classList.add(\"copied\");\r\n              setTimeout(() => {\r\n                  btn.innerHTML = originalIcon;\r\n                  btn.classList.remove(\"copied\");\r\n              }, 2000);\r\n          });\r\n      });\r\n  });\r\n\r\n  // Feedback Buttons\r\n  document.querySelectorAll(\".btn-feedback\").forEach(btn => {\r\n      btn.addEventListener(\"click\", (e) => {\r\n          e.stopPropagation();\r\n          const parent = btn.closest(\".faq-feedback\");\r\n          parent.querySelectorAll(\".btn-feedback\").forEach(b => b.classList.remove(\"active\"));\r\n          btn.classList.add(\"active\");\r\n          \r\n          // Visual feedback\r\n          const label = parent.querySelector(\".feedback-label\");\r\n          if (label) {\r\n              const originalText = \"آیا این پاسخ مفید بود؟\"; // Default text\r\n              label.textContent = \"بازخورد شما ثبت شد. ممنون!\";\r\n              label.style.color = \"#27ae60\";\r\n              label.style.fontWeight = \"bold\";\r\n              \r\n              setTimeout(() => {\r\n                  label.textContent = originalText;\r\n                  label.style.color = \"\";\r\n                  label.style.fontWeight = \"\";\r\n                  btn.classList.remove(\"active\");\r\n              }, 3000);\r\n          }\r\n\r\n          // Analytics\r\n          if (typeof gtag === \"function\") {\r\n              gtag(\"event\", \"faq_feedback\", {\r\n                  event_category: \"FAQ Feedback\",\r\n                  event_label: btn.classList.contains(\"up\") ? \"helpful\" : \"not_helpful\",\r\n              });\r\n          }\r\n      });\r\n  });\r\n\r\n  // Check for hash on load to open specific FAQ\r\n  if (window.location.hash) {\r\n      const targetId = window.location.hash.substring(1);\r\n      const targetItem = document.getElementById(targetId);\r\n      if (targetItem && targetItem.classList.contains(\"faq-item\")) {\r\n          setTimeout(() => {\r\n              toggleItem(targetItem, true);\r\n              targetItem.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n              // Add a temporary highlight effect\r\n              targetItem.style.borderColor = \"var(--faq-primary)\";\r\n              targetItem.style.boxShadow = \"0 0 0 4px rgba(52, 152, 219, 0.2)\";\r\n              setTimeout(() => {\r\n                  targetItem.style.borderColor = \"\";\r\n                  targetItem.style.boxShadow = \"\";\r\n              }, 2000);\r\n          }, 500);\r\n      }\r\n  }\r\n\r\n  // --- Page entry animation ---\r\n  const prefersReducedMotion = window.matchMedia\r\n    ? window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches\r\n    : false;\r\n\r\n  if (!prefersReducedMotion && header) {\r\n      // Simple fade in if not already handled by CSS\r\n  }\r\n});\r\n"]}