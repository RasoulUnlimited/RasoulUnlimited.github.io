{"version":3,"file":"gallery-filter.min.js","names":["window","document","addEventListener","filterBar","querySelector","cards","Array","from","querySelectorAll","length","buttons","ALL_FILTER","currentFilter","isFarsi","dataset","lang","documentElement","toLowerCase","startsWith","liveRegion","getCardCategories","card","category","split","map","c","trim","filter","Boolean","createElement","setAttribute","filterLive","className","appendChild","items","categories","totalItems","applyFilter","filterValue","sourceButton","isAllFilter","activeButton","find","b","targetBtn","forEach","btn","isActive","classList","toggle","visibleCount","show","includes","hidden","textContent","itemWord","totalWord","updateLiveRegion","event","button","target","closest","preventDefault","initialFromAttr","initialFilter","defaultBtn","contains"],"sources":["gallery-filter.js"],"mappings":"CAAA,WACE,aAGsB,oBAAXA,QAA8C,oBAAbC,UAI5CA,SAASC,iBAAiB,mBAAoB,WAC5C,MAAMC,EAAYF,SAASG,cAAc,eACzC,IAAKD,EAAW,OAEhB,MAAME,EAAQC,MAAMC,KAAKN,SAASO,iBAAiB,mBACnD,IAAKH,EAAMI,OAAQ,OAEnB,MAAMC,EAAUJ,MAAMC,KACpBJ,EAAUK,iBAAiB,wBAE7B,IAAKE,EAAQD,OAAQ,OAErB,MAAME,EAAa,MACnB,IAAIC,EAAgBD,EAGpB,MAIME,GAHJV,EAAUW,QAAQC,MAClBd,SAASe,gBAAgBD,MACzB,MACuBE,cAAcC,WAAW,MAGlD,IAAIC,EAAahB,EAAUC,cAAc,6BAezC,SAASgB,EAAkBC,GAEzB,OADYA,EAAKP,QAAQQ,UAAY,IAElCC,MAAM,OACNC,IAAKC,GAAMA,EAAEC,QACbC,OAAOC,QACZ,CApBKT,IACHA,EAAalB,SAAS4B,cAAc,QACpCV,EAAWW,aAAa,YAAa,UACrCX,EAAWW,aAAa,cAAe,QACvCX,EAAWW,aAAa,OAAQ,UAChCX,EAAWL,QAAQiB,WAAa,OAChCZ,EAAWa,UAAY,sBACvB7B,EAAU8B,YAAYd,IAkBxB,MAAMe,EAAQ7B,EAAMmB,IAAKH,IAAS,CAChCA,OACAc,WAAYf,EAAkBC,MAE1Be,EAAaF,EAAMzB,OA+CzB,SAAS4B,EAAYC,EAAaC,GAChC,MAAMZ,EAASW,GAAe3B,EACxB6B,EAAcb,IAAWhB,EAG/B,GAAIgB,IAAWf,IAAkB2B,EAC/B,OAEF3B,EAAgBe,EAGhB,MAAMc,EACJF,GACA7B,EAAQgC,KAAMC,IAAOA,EAAE7B,QAAQa,QAAUhB,KAAgBgB,IACzDjB,EAAQ,GA3DZ,IAAyBkC,KA6DPH,IA1DhB/B,EAAQmC,QAASC,IACf,MAAMC,EAAWD,IAAQF,EACzBE,EAAIE,UAAUC,OAAO,SAAUF,GAC/BD,EAAIhB,aAAa,eAAgBiB,EAAW,OAAS,WAyDvD,IAAIG,EAAe,EAEnBhB,EAAMW,QAAQ,EAAGxB,OAAMc,iBACrB,MAAMgB,EACJX,GACCL,EAAW1B,OAAS,GAAK0B,EAAWiB,SAASzB,GAEhDN,EAAKgC,QAAUF,EACf9B,EAAK2B,UAAUC,OAAO,mBAAoBE,GAEtCA,IAAMD,GAAgB,KA/D9B,SAA0BA,GACxB,IAAK/B,EAAY,OAEjB,GAAIN,EAYF,YAVEM,EAAWmC,YADTJ,IAAiBd,EAEA,IAAjBc,EACI,+BACA,GAAGA,uBAGU,IAAjBA,EACI,kCACA,GAAGA,aAAwBd,wBAMrC,MAAMmB,EAA4B,IAAjBL,EAAqB,OAAS,QACzCM,EAA2B,IAAfpB,EAAmB,OAAS,QAG5CjB,EAAWmC,YADTJ,IAAiBd,EAEA,IAAjBc,EACI,iBACA,GAAGA,KAAgBK,UAGN,IAAjBL,EACI,6BACA,GAAGA,QAAmBd,KAAcoB,SAE9C,CAiCEC,CAAiBP,EACnB,CAGA/C,EAAUD,iBAAiB,QAAUwD,IACnC,MAAMC,EAASD,EAAME,OAAOC,QAAQ,uBACpC,IAAKF,EAAQ,OAEbD,EAAMI,iBAGNzB,EADesB,EAAO7C,QAAQa,QAAUhB,EACpBgD,KAOtB,MAAMI,EAAkB5D,EAAUW,QAAQkD,cACpCC,EACJvD,EAAQgC,KAAMC,GAAMA,EAAEK,UAAUkB,SAAS,YAAcxD,EAAQ,GAQjE2B,EALE0B,IACCE,EAAaA,EAAWnD,QAAQa,OAAShB,IAC1CA,EAIJ,EACD,CAzKD","ignoreList":[],"sourcesContent":["(function () {\r\n  \"use strict\";\r\n\r\n  // جلوگیری از اجرا در محیط‌های SSR/Node\r\n  if (typeof window === \"undefined\" || typeof document === \"undefined\") {\r\n    return;\r\n  }\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", function () {\r\n    const filterBar = document.querySelector(\".filter-bar\");\r\n    if (!filterBar) return;\r\n\r\n    const cards = Array.from(document.querySelectorAll(\".presskit-card\"));\r\n    if (!cards.length) return;\r\n\r\n    const buttons = Array.from(\r\n      filterBar.querySelectorAll(\"button[data-filter]\")\r\n    );\r\n    if (!buttons.length) return;\r\n\r\n    const ALL_FILTER = \"all\";\r\n    let currentFilter = ALL_FILTER;\r\n\r\n    // تشخیص زبان\r\n    const langAttr =\r\n      filterBar.dataset.lang ||\r\n      document.documentElement.lang ||\r\n      \"en\";\r\n    const isFarsi = langAttr.toLowerCase().startsWith(\"fa\");\r\n\r\n    // Live region برای اعلام تعداد نتایج\r\n    let liveRegion = filterBar.querySelector('[data-filter-live=\"true\"]');\r\n    if (!liveRegion) {\r\n      liveRegion = document.createElement(\"span\");\r\n      liveRegion.setAttribute(\"aria-live\", \"polite\");\r\n      liveRegion.setAttribute(\"aria-atomic\", \"true\");\r\n      liveRegion.setAttribute(\"role\", \"status\");\r\n      liveRegion.dataset.filterLive = \"true\";\r\n      liveRegion.className = \"filter-live sr-only\"; // .sr-only باید در CSS تعریف شود\r\n      filterBar.appendChild(liveRegion);\r\n    }\r\n\r\n    /**\r\n     * دریافت دسته‌های یک کارت از data-category\r\n     * پشتیبانی از چند دسته با جداکننده‌ی space\r\n     */\r\n    function getCardCategories(card) {\r\n      const raw = card.dataset.category || \"\";\r\n      return raw\r\n        .split(/\\s+/)\r\n        .map((c) => c.trim())\r\n        .filter(Boolean);\r\n    }\r\n\r\n    /**\r\n     * ساختار داده‌ی داخلی برای کارت‌ها\r\n     */\r\n    const items = cards.map((card) => ({\r\n      card,\r\n      categories: getCardCategories(card),\r\n    }));\r\n    const totalItems = items.length;\r\n\r\n    function setActiveButton(targetBtn) {\r\n      if (!targetBtn) return;\r\n\r\n      buttons.forEach((btn) => {\r\n        const isActive = btn === targetBtn;\r\n        btn.classList.toggle(\"active\", isActive);\r\n        btn.setAttribute(\"aria-pressed\", isActive ? \"true\" : \"false\");\r\n      });\r\n    }\r\n\r\n    function updateLiveRegion(visibleCount) {\r\n      if (!liveRegion) return;\r\n\r\n      if (isFarsi) {\r\n        if (visibleCount === totalItems) {\r\n          liveRegion.textContent =\r\n            visibleCount === 0\r\n              ? \"هیچ موردی نمایش داده نمی‌شود\"\r\n              : `${visibleCount} مورد نمایش داده شد`;\r\n        } else {\r\n          liveRegion.textContent =\r\n            visibleCount === 0\r\n              ? \"هیچ موردی با این فیلتر یافت نشد\"\r\n              : `${visibleCount} مورد از ${totalItems} مورد نمایش داده شد`;\r\n        }\r\n        return;\r\n      }\r\n\r\n      // حالت انگلیسی\r\n      const itemWord = visibleCount === 1 ? \"item\" : \"items\";\r\n      const totalWord = totalItems === 1 ? \"item\" : \"items\";\r\n\r\n      if (visibleCount === totalItems) {\r\n        liveRegion.textContent =\r\n          visibleCount === 0\r\n            ? \"No items shown\"\r\n            : `${visibleCount} ${itemWord} shown`;\r\n      } else {\r\n        liveRegion.textContent =\r\n          visibleCount === 0\r\n            ? \"No items match this filter\"\r\n            : `${visibleCount} of ${totalItems} ${totalWord} shown`;\r\n      }\r\n    }\r\n\r\n    function applyFilter(filterValue, sourceButton) {\r\n      const filter = filterValue || ALL_FILTER;\r\n      const isAllFilter = filter === ALL_FILTER;\r\n\r\n      // اگر فیلتر تغییری نکرده، لازم نیست دوباره همه‌چیز رندر شود\r\n      if (filter === currentFilter && !sourceButton) {\r\n        return;\r\n      }\r\n      currentFilter = filter;\r\n\r\n      // اگر از سمت دکمه صدا زده نشد، سعی کن دکمه‌ی مربوط به این فیلتر را پیدا کنی\r\n      const activeButton =\r\n        sourceButton ||\r\n        buttons.find((b) => (b.dataset.filter || ALL_FILTER) === filter) ||\r\n        buttons[0];\r\n\r\n      setActiveButton(activeButton);\r\n\r\n      let visibleCount = 0;\r\n\r\n      items.forEach(({ card, categories }) => {\r\n        const show =\r\n          isAllFilter ||\r\n          (categories.length > 0 && categories.includes(filter));\r\n\r\n        card.hidden = !show;\r\n        card.classList.toggle(\"is-filtered-out\", !show);\r\n\r\n        if (show) visibleCount += 1;\r\n      });\r\n\r\n      updateLiveRegion(visibleCount);\r\n    }\r\n\r\n    // کلیک روی filter bar (event delegation)\r\n    filterBar.addEventListener(\"click\", (event) => {\r\n      const button = event.target.closest(\"button[data-filter]\");\r\n      if (!button) return;\r\n\r\n      event.preventDefault();\r\n\r\n      const filter = button.dataset.filter || ALL_FILTER;\r\n      applyFilter(filter, button);\r\n    });\r\n\r\n    // اینیت اولیه:\r\n    // ۱. data-initial-filter روی خود filter-bar\r\n    // ۲. اگر نبود، دکمه‌ی active\r\n    // ۳. اگر هیچ‌کدام نبود، اولین دکمه\r\n    const initialFromAttr = filterBar.dataset.initialFilter;\r\n    const defaultBtn =\r\n      buttons.find((b) => b.classList.contains(\"active\")) || buttons[0];\r\n\r\n    const initialFilter =\r\n      initialFromAttr ||\r\n      (defaultBtn ? defaultBtn.dataset.filter : ALL_FILTER) ||\r\n      ALL_FILTER;\r\n\r\n    // اینجا دکمه را به applyFilter پاس نمی‌دهیم تا خودش براساس initialFilter دکمه‌ی درست را پیدا کند\r\n    applyFilter(initialFilter);\r\n  });\r\n})();\r\n"]}