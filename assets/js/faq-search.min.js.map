{"version":3,"file":"faq-search.min.js","names":["document","addEventListener","searchInput","getElementById","clearButton","faqItems","Array","from","querySelectorAll","length","debounceTimer","status","updateStatus","term","visibleCount","total","trimmed","trim","textContent","filterFaq","searchTerm","undefined","value","toLowerCase","hasTerm","forEach","item","summary","querySelector","answerEl","question","answer","keywords","dataset","includes","hidden","open","setAttribute","openedBySearch","createElement","id","className","closest","appendChild","parentNode","getAttribute","style","display","clearTimeout","setTimeout","e","key","preventDefault","focus","window"],"sources":["faq-search.js"],"mappings":"CAGA,WACE,aAEAA,SAASC,iBAAiB,mBAAoB,WAC5C,MAAMC,EAAcF,SAASG,eAAe,cACtCC,EAAcJ,SAASG,eAAe,gBACtCE,EAAWC,MAAMC,KAAKP,SAASQ,iBAAiB,cAEtD,IAAKN,IAAgBE,IAAgBC,EAASI,OAAS,OAGvD,IAgBIC,EAhBAC,EAASX,SAASG,eAAe,qBAkBrC,SAASS,EAAaC,EAAMC,GAC1B,MAAMC,EAAQV,EAASI,OACjBO,EAAUH,EAAKI,OAMrBN,EAAOO,YAJFF,EAKc,IAAjBF,EACI,yBAAyBE,MACzB,SAASF,WAAuC,IAAjBA,EAAqB,GAAK,YAAYE,MANpD,eAAeD,aAA2B,IAAVA,EAAc,GAAK,MAO5E,CAEA,SAASI,EAAUN,GACjB,MACMO,SADmBC,IAATR,EAAqBA,EAAOX,EAAYoB,QACzB,IAAIL,OAAOM,cACpCC,EAAUJ,EAAWX,OAAS,EAEpC,IAAIK,EAAe,EAEnBT,EAASoB,QAASC,IAChB,MAAMC,EAAUD,EAAKE,cAAc,WAC7BC,EAAWH,EAAKE,cAAc,6BAE9BE,EAAWH,EACbA,EAAQT,YAAYK,cACpB,GACEQ,EAASF,EACXA,EAASX,YAAYK,cACrB,GACES,GAAYN,EAAKO,QAAQD,UAAY,IAAIT,eAG5CC,GACDM,EAASI,SAASd,IAClBW,EAAOG,SAASd,IAChBY,EAASE,SAASd,IAGlBM,EAAKS,QAAS,EACdrB,IAGIU,IAAYE,EAAKU,OACnBV,EAAKU,MAAO,EACRT,GAAUA,EAAQU,aAAa,gBAAiB,QACpDX,EAAKO,QAAQK,eAAiB,SAI3Bd,GAAWE,EAAKO,QAAQK,wBACpBZ,EAAKO,QAAQK,eAChBZ,EAAKU,OACPV,EAAKU,MAAO,EACRT,GAAUA,EAAQU,aAAa,gBAAiB,aAIxDX,EAAKS,QAAS,EAEVT,EAAKU,MAAQV,EAAKO,QAAQK,iBAC5BZ,EAAKU,MAAO,EACRT,GAAUA,EAAQU,aAAa,gBAAiB,gBAC7CX,EAAKO,QAAQK,mBAK1B1B,EAAaQ,EAAYN,EAC3B,CAvFKH,IACHA,EAASX,SAASuC,cAAc,OAChC5B,EAAO6B,GAAK,oBACZ7B,EAAO0B,aAAa,YAAa,UACjC1B,EAAO0B,aAAa,cAAe,QACnC1B,EAAO8B,UAAY,4BACnBvC,EAAYwC,QAAQ,SAASC,YAAYhC,IACvCT,EAAY0C,WAAWD,YAAYhC,IAIlCP,EAAYyC,aAAa,eAC5BzC,EAAYiC,aAAa,aAAc,oBA6EzCnC,EAAYD,iBAAiB,QAAS,KACpC,MAAMY,EAAOX,EAAYoB,MAAML,OAAOM,cACtCnB,EAAY0C,MAAMC,QAAUlC,EAAO,cAAgB,OAEnDmC,aAAatC,GACbA,EAAgBuC,WAAW,IAAM9B,EAAUN,GAAO,OAIpDX,EAAYD,iBAAiB,UAAYiD,IACzB,WAAVA,EAAEC,MACJD,EAAEE,iBACFlD,EAAYoB,MAAQ,GACpBlB,EAAY0C,MAAMC,QAAU,OAC5BC,aAAatC,GACbS,EAAU,OAIdf,EAAYH,iBAAiB,QAAS,KACpCC,EAAYoB,MAAQ,GACpBlB,EAAY0C,MAAMC,QAAU,OAC5BC,aAAatC,GACbS,EAAU,IACVjB,EAAYmD,UAIdjD,EAAY0C,MAAMC,QAAU,OAC5B5B,EAAU,IAGVmC,OAAOrD,iBAAiB,eAAgB,KACtC+C,aAAatC,IAEjB,EACD,CAzID","ignoreList":[],"sourcesContent":["// Minimal FAQ search functionality for home pages\r\n// Derived from assets/js/faq-fa.js without analytics or extras\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", function () {\r\n    const searchInput = document.getElementById(\"faq-search\");\r\n    const clearButton = document.getElementById(\"clear-search\");\r\n    const faqItems = Array.from(document.querySelectorAll(\".faq-item\"));\r\n\r\n    if (!searchInput || !clearButton || !faqItems.length) {return;}\r\n\r\n    // Live region برای اعلام تعداد نتایج (a11y)\r\n    let status = document.getElementById(\"faq-search-status\");\r\n    if (!status) {\r\n      status = document.createElement(\"div\");\r\n      status.id = \"faq-search-status\";\r\n      status.setAttribute(\"aria-live\", \"polite\");\r\n      status.setAttribute(\"aria-atomic\", \"true\");\r\n      status.className = \"faq-search-status sr-only\"; // تو CSS .sr-only رو تعریف کن\r\n      searchInput.closest(\"form\")?.appendChild(status) ||\r\n        searchInput.parentNode.appendChild(status);\r\n    }\r\n\r\n    // مطمئن شو دکمه‌ی پاک‌کردن برای اسکرین‌ریدر واضح است\r\n    if (!clearButton.getAttribute(\"aria-label\")) {\r\n      clearButton.setAttribute(\"aria-label\", \"Clear FAQ search\");\r\n    }\r\n\r\n    let debounceTimer;\r\n\r\n    function updateStatus(term, visibleCount) {\r\n      const total = faqItems.length;\r\n      const trimmed = term.trim();\r\n\r\n      if (!trimmed) {\r\n        status.textContent = `Showing all ${total} question${total === 1 ? \"\" : \"s\"}.`;\r\n        return;\r\n      }\r\n      status.textContent =\r\n        visibleCount === 0\r\n          ? `No results found for “${trimmed}”.`\r\n          : `Found ${visibleCount} result${visibleCount === 1 ? \"\" : \"s\"} for “${trimmed}”.`;\r\n    }\r\n\r\n    function filterFaq(term) {\r\n      const rawTerm = term !== undefined ? term : searchInput.value;\r\n      const searchTerm = (rawTerm || \"\").trim().toLowerCase();\r\n      const hasTerm = searchTerm.length > 0;\r\n\r\n      let visibleCount = 0;\r\n\r\n      faqItems.forEach((item) => {\r\n        const summary = item.querySelector(\"summary\");\r\n        const answerEl = item.querySelector(\".faq-answer, p, .faq-body\");\r\n\r\n        const question = summary\r\n          ? summary.textContent.toLowerCase()\r\n          : \"\";\r\n        const answer = answerEl\r\n          ? answerEl.textContent.toLowerCase()\r\n          : \"\";\r\n        const keywords = (item.dataset.keywords || \"\").toLowerCase();\r\n\r\n        const matches =\r\n          !hasTerm ||\r\n          question.includes(searchTerm) ||\r\n          answer.includes(searchTerm) ||\r\n          keywords.includes(searchTerm);\r\n\r\n        if (matches) {\r\n          item.hidden = false;\r\n          visibleCount++;\r\n\r\n          // اگر سرچ داریم، آیتم رو باز کن ولی فقط اگر قبلاً باز نبوده\r\n          if (hasTerm && !item.open) {\r\n            item.open = true;\r\n            if (summary) {summary.setAttribute(\"aria-expanded\", \"true\");}\r\n            item.dataset.openedBySearch = \"true\";\r\n          }\r\n\r\n          // اگر سرچ خالی شده و این آیتم فقط به‌خاطر سرچ باز بود → ببندش\r\n          if (!hasTerm && item.dataset.openedBySearch) {\r\n            delete item.dataset.openedBySearch;\r\n            if (item.open) {\r\n              item.open = false;\r\n              if (summary) {summary.setAttribute(\"aria-expanded\", \"false\");}\r\n            }\r\n          }\r\n        } else {\r\n          item.hidden = true;\r\n          // اگر در اثر سرچ باز شده بود، ببند\r\n          if (item.open && item.dataset.openedBySearch) {\r\n            item.open = false;\r\n            if (summary) {summary.setAttribute(\"aria-expanded\", \"false\");}\r\n            delete item.dataset.openedBySearch;\r\n          }\r\n        }\r\n      });\r\n\r\n      updateStatus(searchTerm, visibleCount);\r\n    }\r\n\r\n    searchInput.addEventListener(\"input\", () => {\r\n      const term = searchInput.value.trim().toLowerCase();\r\n      clearButton.style.display = term ? \"inline-flex\" : \"none\";\r\n\r\n      clearTimeout(debounceTimer);\r\n      debounceTimer = setTimeout(() => filterFaq(term), 200);\r\n    });\r\n\r\n    // ESC داخل اینپوت → سرچ پاک شود\r\n    searchInput.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        searchInput.value = \"\";\r\n        clearButton.style.display = \"none\";\r\n        clearTimeout(debounceTimer);\r\n        filterFaq(\"\");\r\n      }\r\n    });\r\n\r\n    clearButton.addEventListener(\"click\", () => {\r\n      searchInput.value = \"\";\r\n      clearButton.style.display = \"none\";\r\n      clearTimeout(debounceTimer);\r\n      filterFaq(\"\");\r\n      searchInput.focus();\r\n    });\r\n\r\n    // وضعیت اولیه\r\n    clearButton.style.display = \"none\";\r\n    filterFaq(\"\");\r\n\r\n    // Cleanup on page unload to prevent memory leaks\r\n    window.addEventListener(\"beforeunload\", () => {\r\n      clearTimeout(debounceTimer);\r\n    });\r\n  });\r\n})();\r\n"]}