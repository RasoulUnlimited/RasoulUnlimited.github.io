{"version":3,"file":"faq-search.min.js","names":["document","addEventListener","searchInput","getElementById","clearButton","faqItems","Array","from","querySelectorAll","expandAllBtn","collapseAllBtn","length","debounceTimer","status","highlightText","element","term","innerHTML","textContent","text","regex","RegExp","replace","test","filterFaq","searchTerm","undefined","value","trim","toLowerCase","hasTerm","visibleCount","forEach","item","summary","querySelector","answerEl","isCustomAccordion","tagName","question","answer","keywords","dataset","includes","hidden","style","display","classList","contains","add","header","setAttribute","openedBySearch","open","remove","noResults","total","trimmed","updateStatus","createElement","id","className","closest","appendChild","parentNode","getAttribute","clearTimeout","setTimeout","focus","panel"],"sources":["faq-search.js"],"mappings":"CAGA,WACE,aAEAA,SAASC,iBAAiB,mBAAoB,WAC5C,MAAMC,EAAcF,SAASG,eAAe,cACtCC,EAAcJ,SAASG,eAAe,gBACtCE,EAAWC,MAAMC,KAAKP,SAASQ,iBAAiB,cAChDC,EAAeT,SAASG,eAAe,kBACvCO,EAAiBV,SAASG,eAAe,oBAE/C,IAAKD,IAAgBE,IAAgBC,EAASM,OAAS,OAGvD,IAgBIC,EAhBAC,EAASb,SAASG,eAAe,qBAiCrC,SAASW,EAAcC,EAASC,GAC9B,IAAKA,EAGH,YADAD,EAAQE,UAAYF,EAAQG,aAI9B,MAAMC,EAAOJ,EAAQG,YACfE,EAAQ,IAAIC,OAAO,IAAIL,EAAKM,QAAQ,sBAAuB,WAAY,MACzEF,EAAMG,KAAKJ,GACbJ,EAAQE,UAAYE,EAAKG,QAAQF,EAAO,0CAExCL,EAAQE,UAAYE,CAExB,CAEA,SAASK,EAAUR,GACjB,MACMS,SADmBC,IAATV,EAAqBA,EAAOd,EAAYyB,QACzB,IAAIC,OAAOC,cACpCC,EAAUL,EAAWd,OAAS,EAEpC,IAAIoB,EAAe,EAEnB1B,EAAS2B,QAASC,IAEhB,MAAMC,EAAUD,EAAKE,cAAc,YAAcF,EAAKE,cAAc,yBAA2BF,EAAKE,cAAc,qBAC5GC,EAAWH,EAAKE,cAAc,iDAG9BE,GAAqBJ,EAAKK,SAA0C,YAA/BL,EAAKK,QAAQT,cAElDU,EAAWL,EACbA,EAAQhB,YAAYW,cACpB,GACEW,EAASJ,EACXA,EAASlB,YAAYW,cACrB,GACEY,GAAYR,EAAKS,QAAQD,UAAY,IAAIZ,cAQ/C,IALGC,GACDS,EAASI,SAASlB,IAClBe,EAAOG,SAASlB,IAChBgB,EAASE,SAASlB,GAEP,CAUX,GATAQ,EAAKW,QAAS,EACdX,EAAKY,MAAMC,QAAU,GACrBf,IAGIG,GAASpB,EAAcoB,EAASJ,EAAUL,EAAa,MACvDW,GAAUtB,EAAcsB,EAAUN,EAAUL,EAAa,MAGzDK,EACF,GAAIO,GACA,IAAKJ,EAAKc,UAAUC,SAAS,WAAY,CACrCf,EAAKc,UAAUE,IAAI,WACnB,MAAMC,EAASjB,EAAKE,cAAc,qBAC9Be,GAAQA,EAAOC,aAAa,gBAAiB,QACjDlB,EAAKS,QAAQU,eAAiB,OAE1BhB,IAAUA,EAASQ,QAAS,EACpC,OAEKX,EAAKoB,OACNpB,EAAKoB,MAAO,EACZpB,EAAKS,QAAQU,eAAiB,QAMxC,IAAKtB,GAAWG,EAAKS,QAAQU,eAAgB,CAC3C,GAAIf,EAAmB,CACnBJ,EAAKc,UAAUO,OAAO,WACtB,MAAMJ,EAASjB,EAAKE,cAAc,qBAC9Be,GAAQA,EAAOC,aAAa,gBAAiB,SAC7Cf,IAAUA,EAASQ,QAAS,EACpC,MACIX,EAAKoB,MAAO,SAETpB,EAAKS,QAAQU,cACtB,CACF,MACEnB,EAAKW,QAAS,EACdX,EAAKY,MAAMC,QAAU,SAIzB,MAAMS,EAAYvD,SAASG,eAAe,kBACtCoD,IACFA,EAAUV,MAAMC,QAA2B,IAAjBf,EAAqB,QAAU,QAG3D3B,EAAYyC,MAAMC,QAAUhB,EAAU,QAAU,OA/GlD,SAAsBd,EAAMe,GAC1B,MAAMyB,EAAQnD,EAASM,OACjB8C,EAAUzC,EAAKY,OAMrBf,EAAOK,YAJFuC,EAKc,IAAjB1B,EACI,yBAAyB0B,MACzB,SAAS1B,WAAuC,IAAjBA,EAAqB,GAAK,YAAY0B,MANpD,eAAeD,aAA2B,IAAVA,EAAc,GAAK,MAO5E,CAoGEE,CAAajC,EAAYM,EAC3B,CAlIKlB,IACHA,EAASb,SAAS2D,cAAc,OAChC9C,EAAO+C,GAAK,oBACZ/C,EAAOsC,aAAa,YAAa,UACjCtC,EAAOsC,aAAa,cAAe,QACnCtC,EAAOgD,UAAY,4BACnB3D,EAAY4D,QAAQ,SAASC,YAAYlD,IACvCX,EAAY8D,WAAWD,YAAYlD,IAIlCT,EAAY6D,aAAa,eAC5B7D,EAAY+C,aAAa,aAAc,oBAwHzCjD,EAAYD,iBAAiB,QAAS,WACpCiE,aAAatD,GACbA,EAAgBuD,WAAW,IAAM3C,IAAa,IAChD,GAEApB,EAAYH,iBAAiB,QAAS,WACpCC,EAAYyB,MAAQ,GACpBH,IACAtB,EAAYkE,OACd,GAGI3D,GACFA,EAAaR,iBAAiB,QAAS,KACrCI,EAAS2B,QAAQC,IACf,IAAIA,EAAKW,QAAiC,SAAvBX,EAAKY,MAAMC,QAG9B,GAD2Bb,EAAKK,SAA0C,YAA/BL,EAAKK,QAAQT,cAQtDI,EAAKoB,MAAO,MAPS,CACrBpB,EAAKc,UAAUE,IAAI,WACnB,MAAMC,EAASjB,EAAKE,cAAc,qBAC5BkC,EAAQpC,EAAKE,cAAc,sBAC7Be,GAAQA,EAAOC,aAAa,gBAAiB,QAC7CkB,IAAOA,EAAMzB,QAAS,EAC5B,IAIFnC,EAAa0C,aAAa,eAAgB,QACtCzC,GAAgBA,EAAeyC,aAAa,eAAgB,WAIhEzC,GACFA,EAAeT,iBAAiB,QAAS,KACvCI,EAAS2B,QAAQC,IACf,IAAIA,EAAKW,QAAiC,SAAvBX,EAAKY,MAAMC,QAG9B,GAD2Bb,EAAKK,SAA0C,YAA/BL,EAAKK,QAAQT,cAQtDI,EAAKoB,MAAO,MAPS,CACrBpB,EAAKc,UAAUO,OAAO,WACtB,MAAMJ,EAASjB,EAAKE,cAAc,qBAC5BkC,EAAQpC,EAAKE,cAAc,sBAC7Be,GAAQA,EAAOC,aAAa,gBAAiB,SAC7CkB,IAAOA,EAAMzB,QAAS,EAC5B,IAIFlC,EAAeyC,aAAa,eAAgB,QACxC1C,GAAcA,EAAa0C,aAAa,eAAgB,UAGlE,EACD,CAxMD","ignoreList":[],"sourcesContent":["// Minimal FAQ search functionality for home pages\r\n// Derived from assets/js/faq-fa.js without analytics or extras\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", function () {\r\n    const searchInput = document.getElementById(\"faq-search\");\r\n    const clearButton = document.getElementById(\"clear-search\");\r\n    const faqItems = Array.from(document.querySelectorAll(\".faq-item\"));\r\n    const expandAllBtn = document.getElementById(\"expand-all-faq\");\r\n    const collapseAllBtn = document.getElementById(\"collapse-all-faq\");\r\n\r\n    if (!searchInput || !clearButton || !faqItems.length) {return;}\r\n\r\n    // Live region برای اعلام تعداد نتایج (a11y)\r\n    let status = document.getElementById(\"faq-search-status\");\r\n    if (!status) {\r\n      status = document.createElement(\"div\");\r\n      status.id = \"faq-search-status\";\r\n      status.setAttribute(\"aria-live\", \"polite\");\r\n      status.setAttribute(\"aria-atomic\", \"true\");\r\n      status.className = \"faq-search-status sr-only\"; // تو CSS .sr-only رو تعریف کن\r\n      searchInput.closest(\"form\")?.appendChild(status) ||\r\n        searchInput.parentNode.appendChild(status);\r\n    }\r\n\r\n    // مطمئن شو دکمه‌ی پاک‌کردن برای اسکرین‌ریدر واضح است\r\n    if (!clearButton.getAttribute(\"aria-label\")) {\r\n      clearButton.setAttribute(\"aria-label\", \"Clear FAQ search\");\r\n    }\r\n\r\n    let debounceTimer;\r\n\r\n    function updateStatus(term, visibleCount) {\r\n      const total = faqItems.length;\r\n      const trimmed = term.trim();\r\n\r\n      if (!trimmed) {\r\n        status.textContent = `Showing all ${total} question${total === 1 ? \"\" : \"s\"}.`;\r\n        return;\r\n      }\r\n      status.textContent =\r\n        visibleCount === 0\r\n          ? `No results found for “${trimmed}”.`\r\n          : `Found ${visibleCount} result${visibleCount === 1 ? \"\" : \"s\"} for “${trimmed}”.`;\r\n    }\r\n\r\n    // Helper to highlight text\r\n    function highlightText(element, term) {\r\n      if (!term) {\r\n        // Remove highlights\r\n        element.innerHTML = element.textContent;\r\n        return;\r\n      }\r\n      \r\n      const text = element.textContent;\r\n      const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi');\r\n      if (regex.test(text)) {\r\n        element.innerHTML = text.replace(regex, '<span class=\"highlight-term\">$1</span>');\r\n      } else {\r\n        element.innerHTML = text;\r\n      }\r\n    }\r\n\r\n    function filterFaq(term) {\r\n      const rawTerm = term !== undefined ? term : searchInput.value;\r\n      const searchTerm = (rawTerm || \"\").trim().toLowerCase();\r\n      const hasTerm = searchTerm.length > 0;\r\n\r\n      let visibleCount = 0;\r\n\r\n      faqItems.forEach((item) => {\r\n        // Support both <details>/<summary> and custom .accordion-item structure\r\n        const summary = item.querySelector(\"summary\") || item.querySelector(\".accordion-header h3\") || item.querySelector(\".accordion-header\");\r\n        const answerEl = item.querySelector(\".faq-answer, p, .faq-body, .accordion-content\");\r\n        \r\n        // For custom accordion, the header button is the summary\r\n        const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n\r\n        const question = summary\r\n          ? summary.textContent.toLowerCase()\r\n          : \"\";\r\n        const answer = answerEl\r\n          ? answerEl.textContent.toLowerCase()\r\n          : \"\";\r\n        const keywords = (item.dataset.keywords || \"\").toLowerCase();\r\n\r\n        const matches =\r\n          !hasTerm ||\r\n          question.includes(searchTerm) ||\r\n          answer.includes(searchTerm) ||\r\n          keywords.includes(searchTerm);\r\n\r\n        if (matches) {\r\n          item.hidden = false;\r\n          item.style.display = \"\"; // Reset display property\r\n          visibleCount++;\r\n\r\n          // Highlight terms\r\n          if (summary) highlightText(summary, hasTerm ? searchTerm : null);\r\n          if (answerEl) highlightText(answerEl, hasTerm ? searchTerm : null);\r\n\r\n          // Open item if searching\r\n          if (hasTerm) {\r\n            if (isCustomAccordion) {\r\n                if (!item.classList.contains(\"is-open\")) {\r\n                    item.classList.add(\"is-open\");\r\n                    const header = item.querySelector(\".accordion-header\");\r\n                    if (header) header.setAttribute(\"aria-expanded\", \"true\");\r\n                    item.dataset.openedBySearch = \"true\";\r\n                    // Ensure content is visible\r\n                    if (answerEl) answerEl.hidden = false;\r\n                }\r\n            } else {\r\n                if (!item.open) {\r\n                    item.open = true;\r\n                    item.dataset.openedBySearch = \"true\";\r\n                }\r\n            }\r\n          }\r\n\r\n          // Close if search cleared and was opened by search\r\n          if (!hasTerm && item.dataset.openedBySearch) {\r\n            if (isCustomAccordion) {\r\n                item.classList.remove(\"is-open\");\r\n                const header = item.querySelector(\".accordion-header\");\r\n                if (header) header.setAttribute(\"aria-expanded\", \"false\");\r\n                if (answerEl) answerEl.hidden = true;\r\n            } else {\r\n                item.open = false;\r\n            }\r\n            delete item.dataset.openedBySearch;\r\n          }\r\n        } else {\r\n          item.hidden = true;\r\n          item.style.display = \"none\"; // Force hide\r\n        }\r\n      });\r\n\r\n      const noResults = document.getElementById(\"faq-no-results\");\r\n      if (noResults) {\r\n        noResults.style.display = visibleCount === 0 ? \"block\" : \"none\";\r\n      }\r\n\r\n      clearButton.style.display = hasTerm ? \"block\" : \"none\";\r\n      updateStatus(searchTerm, visibleCount);\r\n    }\r\n\r\n    searchInput.addEventListener(\"input\", function () {\r\n      clearTimeout(debounceTimer);\r\n      debounceTimer = setTimeout(() => filterFaq(), 300);\r\n    });\r\n\r\n    clearButton.addEventListener(\"click\", function () {\r\n      searchInput.value = \"\";\r\n      filterFaq();\r\n      searchInput.focus();\r\n    });\r\n\r\n    // Expand/Collapse All Logic\r\n    if (expandAllBtn) {\r\n      expandAllBtn.addEventListener(\"click\", () => {\r\n        faqItems.forEach(item => {\r\n          if (item.hidden || item.style.display === \"none\") return; // Skip hidden items\r\n          \r\n          const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n          if (isCustomAccordion) {\r\n            item.classList.add(\"is-open\");\r\n            const header = item.querySelector(\".accordion-header\");\r\n            const panel = item.querySelector(\".accordion-content\");\r\n            if (header) header.setAttribute(\"aria-expanded\", \"true\");\r\n            if (panel) panel.hidden = false;\r\n          } else {\r\n            item.open = true;\r\n          }\r\n        });\r\n        expandAllBtn.setAttribute(\"aria-pressed\", \"true\");\r\n        if (collapseAllBtn) collapseAllBtn.setAttribute(\"aria-pressed\", \"false\");\r\n      });\r\n    }\r\n\r\n    if (collapseAllBtn) {\r\n      collapseAllBtn.addEventListener(\"click\", () => {\r\n        faqItems.forEach(item => {\r\n          if (item.hidden || item.style.display === \"none\") return;\r\n          \r\n          const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n          if (isCustomAccordion) {\r\n            item.classList.remove(\"is-open\");\r\n            const header = item.querySelector(\".accordion-header\");\r\n            const panel = item.querySelector(\".accordion-content\");\r\n            if (header) header.setAttribute(\"aria-expanded\", \"false\");\r\n            if (panel) panel.hidden = true;\r\n          } else {\r\n            item.open = false;\r\n          }\r\n        });\r\n        collapseAllBtn.setAttribute(\"aria-pressed\", \"true\");\r\n        if (expandAllBtn) expandAllBtn.setAttribute(\"aria-pressed\", \"false\");\r\n      });\r\n    }\r\n  });\r\n})();\r\n"]}