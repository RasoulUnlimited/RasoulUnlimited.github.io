{"version":3,"file":"faq-search.min.js","names":["document","addEventListener","searchInput","getElementById","clearButton","faqItems","Array","from","querySelectorAll","length","debounceTimer","status","filterFaq","term","rawTerm","undefined","value","searchTerm","trim","toLowerCase","hasTerm","visibleCount","forEach","item","summary","querySelector","answerEl","isCustomAccordion","tagName","question","textContent","answer","keywords","dataset","includes","hidden","style","display","classList","contains","add","setAttribute","openedBySearch","open","remove","noResultsEl","total","trimmed","updateStatus","createElement","id","className","closest","appendChild","parentNode","getAttribute","clearTimeout","setTimeout","e","key","preventDefault","focus","window"],"sources":["faq-search.js"],"mappings":"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","ignoreList":[],"sourcesContent":["// Minimal FAQ search functionality for home pages\r\n// Derived from assets/js/faq-fa.js without analytics or extras\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", function () {\r\n    const searchInput = document.getElementById(\"faq-search\");\r\n    const clearButton = document.getElementById(\"clear-search\");\r\n    const faqItems = Array.from(document.querySelectorAll(\".faq-item\"));\r\n\r\n    if (!searchInput || !clearButton || !faqItems.length) {return;}\r\n\r\n    // Live region برای اعلام تعداد نتایج (a11y)\r\n    let status = document.getElementById(\"faq-search-status\");\r\n    if (!status) {\r\n      status = document.createElement(\"div\");\r\n      status.id = \"faq-search-status\";\r\n      status.setAttribute(\"aria-live\", \"polite\");\r\n      status.setAttribute(\"aria-atomic\", \"true\");\r\n      status.className = \"faq-search-status sr-only\"; // تو CSS .sr-only رو تعریف کن\r\n      searchInput.closest(\"form\")?.appendChild(status) ||\r\n        searchInput.parentNode.appendChild(status);\r\n    }\r\n\r\n    // مطمئن شو دکمه‌ی پاک‌کردن برای اسکرین‌ریدر واضح است\r\n    if (!clearButton.getAttribute(\"aria-label\")) {\r\n      clearButton.setAttribute(\"aria-label\", \"Clear FAQ search\");\r\n    }\r\n\r\n    let debounceTimer;\r\n\r\n    function updateStatus(term, visibleCount) {\r\n      const total = faqItems.length;\r\n      const trimmed = term.trim();\r\n\r\n      if (!trimmed) {\r\n        status.textContent = `Showing all ${total} question${total === 1 ? \"\" : \"s\"}.`;\r\n        return;\r\n      }\r\n      status.textContent =\r\n        visibleCount === 0\r\n          ? `No results found for “${trimmed}”.`\r\n          : `Found ${visibleCount} result${visibleCount === 1 ? \"\" : \"s\"} for “${trimmed}”.`;\r\n    }\r\n\r\n    function filterFaq(term) {\r\n      const rawTerm = term !== undefined ? term : searchInput.value;\r\n      const searchTerm = (rawTerm || \"\").trim().toLowerCase();\r\n      const hasTerm = searchTerm.length > 0;\r\n\r\n      let visibleCount = 0;\r\n\r\n      faqItems.forEach((item) => {\r\n        // Support both <details>/<summary> and custom .accordion-item structure\r\n        const summary = item.querySelector(\"summary\") || item.querySelector(\".accordion-header\");\r\n        const answerEl = item.querySelector(\".faq-answer, p, .faq-body, .accordion-content\");\r\n        \r\n        // For custom accordion, the header button is the summary\r\n        const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n\r\n        const question = summary\r\n          ? summary.textContent.toLowerCase()\r\n          : \"\";\r\n        const answer = answerEl\r\n          ? answerEl.textContent.toLowerCase()\r\n          : \"\";\r\n        const keywords = (item.dataset.keywords || \"\").toLowerCase();\r\n\r\n        const matches =\r\n          !hasTerm ||\r\n          question.includes(searchTerm) ||\r\n          answer.includes(searchTerm) ||\r\n          keywords.includes(searchTerm);\r\n\r\n        if (matches) {\r\n          item.hidden = false;\r\n          item.style.display = \"\"; // Reset display property\r\n          visibleCount++;\r\n\r\n          // Open item if searching\r\n          if (hasTerm) {\r\n            if (isCustomAccordion) {\r\n                if (!item.classList.contains(\"is-open\")) {\r\n                    item.classList.add(\"is-open\");\r\n                    if (summary) summary.setAttribute(\"aria-expanded\", \"true\");\r\n                    item.dataset.openedBySearch = \"true\";\r\n                    // Ensure content is visible\r\n                    if (answerEl) answerEl.hidden = false;\r\n                }\r\n            } else {\r\n                if (!item.open) {\r\n                    item.open = true;\r\n                    item.dataset.openedBySearch = \"true\";\r\n                }\r\n            }\r\n          }\r\n\r\n          // Close if search cleared and was opened by search\r\n          if (!hasTerm && item.dataset.openedBySearch) {\r\n            delete item.dataset.openedBySearch;\r\n            if (isCustomAccordion) {\r\n                item.classList.remove(\"is-open\");\r\n                if (summary) summary.setAttribute(\"aria-expanded\", \"false\");\r\n                if (answerEl) answerEl.hidden = true;\r\n            } else {\r\n                item.open = false;\r\n            }\r\n          }\r\n        } else {\r\n          item.hidden = true;\r\n          item.style.display = \"none\"; // Force hide\r\n          \r\n          // Reset state if hidden\r\n          if (item.dataset.openedBySearch) {\r\n            delete item.dataset.openedBySearch;\r\n            if (isCustomAccordion) {\r\n                item.classList.remove(\"is-open\");\r\n                if (summary) summary.setAttribute(\"aria-expanded\", \"false\");\r\n                if (answerEl) answerEl.hidden = true;\r\n            } else {\r\n                item.open = false;\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n      const noResultsEl = document.getElementById(\"faq-no-results\");\r\n      if (noResultsEl) {\r\n        noResultsEl.style.display = visibleCount === 0 && hasTerm ? \"block\" : \"none\";\r\n      }\r\n\r\n      updateStatus(rawTerm, visibleCount);\r\n    }\r\n\r\n    searchInput.addEventListener(\"input\", function () {\r\n      const term = searchInput.value.trim().toLowerCase();\r\n      clearButton.style.display = term ? \"inline-flex\" : \"none\";\r\n\r\n      clearTimeout(debounceTimer);\r\n      debounceTimer = setTimeout(() => filterFaq(term), 200);\r\n    });\r\n\r\n    // ESC داخل اینپوت → سرچ پاک شود\r\n    searchInput.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        searchInput.value = \"\";\r\n        clearButton.style.display = \"none\";\r\n        clearTimeout(debounceTimer);\r\n        filterFaq(\"\");\r\n      }\r\n    });\r\n\r\n    clearButton.addEventListener(\"click\", () => {\r\n      searchInput.value = \"\";\r\n      clearButton.style.display = \"none\";\r\n      clearTimeout(debounceTimer);\r\n      filterFaq(\"\");\r\n      searchInput.focus();\r\n    });\r\n\r\n    // وضعیت اولیه\r\n    clearButton.style.display = \"none\";\r\n    filterFaq(\"\");\r\n\r\n    // Cleanup on page unload to prevent memory leaks\r\n    window.addEventListener(\"beforeunload\", () => {\r\n      clearTimeout(debounceTimer);\r\n    });\r\n  });\r\n})();\r\n"]}