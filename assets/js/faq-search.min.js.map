{"version":3,"file":"faq-search.min.js","names":["document","addEventListener","window","createToast","message","toast","createElement","className","textContent","style","cssText","body","appendChild","requestAnimationFrame","opacity","setTimeout","remove","searchInput","getElementById","clearButton","faqItems","Array","from","querySelectorAll","expandAllBtn","collapseAllBtn","length","debounceTimer","status","id","setAttribute","closest","parentNode","getAttribute","originalContent","Map","highlightText","element","term","has","innerHTML","get","text","newHtml","RegExp","replace","filterFaq","searchTerm","undefined","value","trim","toLowerCase","hasTerm","visibleCount","forEach","item","summaryEl","querySelector","answerEl","isCustomAccordion","tagName","questionText","answerText","keywords","dataset","includes","hidden","display","classList","contains","add","header","openedBySearch","open","noResults","total","trimmed","updateStatus","summary","answer","set","clearTimeout","e","key","preventDefault","focus","panel","btn","stopPropagation","link","url","location","origin","pathname","navigator","clipboard","writeText","then","originalIcon","color","catch","err","storedFeedback","localStorage","getItem","parent","b","isUp","setItem","hash","targetId","substring","targetItem","scrollIntoView","behavior","block","transition","originalBg","backgroundColor"],"sources":["faq-search.js"],"mappings":"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","ignoreList":[],"sourcesContent":["// Minimal FAQ search functionality for home pages\r\n// Derived from assets/js/faq-fa.js without analytics or extras\r\n\r\n(function () {\r\n  \"use strict\";\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", function () {\r\n    // Toast fallback\r\n    if (typeof window.createToast !== 'function') {\r\n      window.createToast = function(message) {\r\n        const toast = document.createElement('div');\r\n        toast.className = 'toast-notification';\r\n        toast.textContent = message;\r\n        toast.style.cssText = `\r\n          position: fixed;\r\n          bottom: 20px;\r\n          left: 50%;\r\n          transform: translateX(-50%);\r\n          background: rgba(0,0,0,0.8);\r\n          color: white;\r\n          padding: 10px 20px;\r\n          border-radius: 20px;\r\n          z-index: 10000;\r\n          opacity: 0;\r\n          transition: opacity 0.3s;\r\n          font-family: inherit;\r\n          font-size: 0.9rem;\r\n        `;\r\n        document.body.appendChild(toast);\r\n        requestAnimationFrame(() => toast.style.opacity = '1');\r\n        setTimeout(() => {\r\n          toast.style.opacity = '0';\r\n          setTimeout(() => toast.remove(), 300);\r\n        }, 3000);\r\n      };\r\n    }\r\n\r\n    const searchInput = document.getElementById(\"faq-search\");\r\n    const clearButton = document.getElementById(\"clear-search\");\r\n    const faqItems = Array.from(document.querySelectorAll(\".faq-item\"));\r\n    const expandAllBtn = document.getElementById(\"expand-all-faq\");\r\n    const collapseAllBtn = document.getElementById(\"collapse-all-faq\");\r\n\r\n    if (!searchInput || !clearButton || !faqItems.length) {return;}\r\n\r\n    // Live region for announcing search results (a11y)\r\n    let status = document.getElementById(\"faq-search-status\");\r\n    if (!status) {\r\n      status = document.createElement(\"div\");\r\n      status.id = \"faq-search-status\";\r\n      status.setAttribute(\"aria-live\", \"polite\");\r\n      status.setAttribute(\"aria-atomic\", \"true\");\r\n      status.className = \"faq-search-status sr-only\";\r\n      (searchInput.closest(\"form\") || searchInput.parentNode).appendChild(status);\r\n    }\r\n\r\n    // Ensure clear button has accessible label\r\n    if (!clearButton.getAttribute(\"aria-label\")) {\r\n      clearButton.setAttribute(\"aria-label\", \"پاک کردن جستجو\");\r\n    }\r\n\r\n    let debounceTimer;\r\n    // Store original content to restore after search clears\r\n    const originalContent = new Map();\r\n\r\n    faqItems.forEach(item => {\r\n      const summary = item.querySelector(\".accordion-header h3\") || item.querySelector(\"summary\");\r\n      const answer = item.querySelector(\".accordion-content\") || item.querySelector(\".faq-answer\");\r\n      if (summary) originalContent.set(summary, summary.innerHTML);\r\n      if (answer) originalContent.set(answer, answer.innerHTML);\r\n    });\r\n\r\n    function updateStatus(term, visibleCount) {\r\n      const total = faqItems.length;\r\n      const trimmed = term.trim();\r\n\r\n      if (!trimmed) {\r\n        status.textContent = `نمایش همه ${total} سوال.`;\r\n        return;\r\n      }\r\n      status.textContent =\r\n        visibleCount === 0\r\n          ? `نتیجه‌ای برای «${trimmed}» یافت نشد.`\r\n          : `${visibleCount} نتیجه برای «${trimmed}» پیدا شد.`;\r\n    }\r\n\r\n    // Helper to highlight text safely\r\n    function highlightText(element, term) {\r\n      if (!element) return;\r\n      \r\n      // Always restore original first to avoid nested spans\r\n      if (originalContent.has(element)) {\r\n        element.innerHTML = originalContent.get(element);\r\n      }\r\n\r\n      if (!term) return;\r\n      \r\n      const text = element.innerHTML;\r\n      // Simple regex for text content - be careful with HTML tags\r\n      // This is a simple implementation. For robust highlighting in HTML, a tree walker is better.\r\n      // But for this specific use case (h3 and p), simple replacement is usually acceptable if no complex nested tags.\r\n      \r\n      const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi');\r\n      \r\n      // Only replace text nodes ideally, but innerHTML replace is faster for simple content\r\n      // We use a negative lookahead to avoid replacing inside HTML tags (attributes)\r\n      const newHtml = text.replace(new RegExp(`(?![^<]+>)(${term.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')})`, 'gi'), '<span class=\"highlight-term\">$1</span>');\r\n      \r\n      element.innerHTML = newHtml;\r\n    }\r\n\r\n    function filterFaq(term) {\r\n      const rawTerm = term !== undefined ? term : searchInput.value;\r\n      const searchTerm = (rawTerm || \"\").trim().toLowerCase();\r\n      const hasTerm = searchTerm.length > 0;\r\n\r\n      let visibleCount = 0;\r\n\r\n      faqItems.forEach((item) => {\r\n        // Support both <details>/<summary> and custom .accordion-item structure\r\n        const summaryEl = item.querySelector(\".accordion-header h3\") || item.querySelector(\"summary\");\r\n        const answerEl = item.querySelector(\".accordion-content\") || item.querySelector(\".faq-answer\");\r\n        \r\n        // For custom accordion, the header button is the summary\r\n        const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n\r\n        const questionText = summaryEl ? summaryEl.textContent.toLowerCase() : \"\";\r\n        const answerText = answerEl ? answerEl.textContent.toLowerCase() : \"\";\r\n        const keywords = (item.dataset.keywords || \"\").toLowerCase();\r\n\r\n        const matches =\r\n          !hasTerm ||\r\n          questionText.includes(searchTerm) ||\r\n          answerText.includes(searchTerm) ||\r\n          keywords.includes(searchTerm);\r\n\r\n        if (matches) {\r\n          item.hidden = false;\r\n          item.style.display = \"\"; // Reset display property\r\n          visibleCount++;\r\n\r\n          // Highlight terms\r\n          if (summaryEl) highlightText(summaryEl, hasTerm ? searchTerm : null);\r\n          if (answerEl) highlightText(answerEl, hasTerm ? searchTerm : null);\r\n\r\n          // Open item if searching\r\n          if (hasTerm) {\r\n            if (isCustomAccordion) {\r\n                if (!item.classList.contains(\"is-open\")) {\r\n                    item.classList.add(\"is-open\");\r\n                    const header = item.querySelector(\".accordion-header\");\r\n                    if (header) header.setAttribute(\"aria-expanded\", \"true\");\r\n                    item.dataset.openedBySearch = \"true\";\r\n                    // Ensure content is visible (handled by CSS usually, but explicit doesn't hurt)\r\n                    if (answerEl) answerEl.hidden = false;\r\n                }\r\n            } else {\r\n                if (!item.open) {\r\n                    item.open = true;\r\n                    item.dataset.openedBySearch = \"true\";\r\n                }\r\n            }\r\n          }\r\n\r\n          // Close if search cleared and was opened by search\r\n          if (!hasTerm && item.dataset.openedBySearch) {\r\n            if (isCustomAccordion) {\r\n                item.classList.remove(\"is-open\");\r\n                const header = item.querySelector(\".accordion-header\");\r\n                if (header) header.setAttribute(\"aria-expanded\", \"false\");\r\n                if (answerEl) answerEl.hidden = true;\r\n            } else {\r\n                item.open = false;\r\n            }\r\n            delete item.dataset.openedBySearch;\r\n          }\r\n        } else {\r\n          item.hidden = true;\r\n          item.style.display = \"none\"; // Force hide\r\n        }\r\n      });\r\n\r\n      const noResults = document.getElementById(\"faq-no-results\");\r\n      if (noResults) {\r\n        noResults.style.display = visibleCount === 0 ? \"block\" : \"none\";\r\n      }\r\n\r\n      clearButton.style.display = hasTerm ? \"block\" : \"none\";\r\n      updateStatus(searchTerm, visibleCount);\r\n    }\r\n\r\n    searchInput.addEventListener(\"input\", function () {\r\n      clearTimeout(debounceTimer);\r\n      debounceTimer = setTimeout(() => filterFaq(), 300);\r\n    });\r\n\r\n    // ESC to clear\r\n    searchInput.addEventListener(\"keydown\", (e) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        searchInput.value = \"\";\r\n        filterFaq();\r\n        searchInput.focus();\r\n      }\r\n    });\r\n\r\n    clearButton.addEventListener(\"click\", function () {\r\n      searchInput.value = \"\";\r\n      filterFaq();\r\n      searchInput.focus();\r\n    });\r\n\r\n    // Expand/Collapse All Logic\r\n    if (expandAllBtn) {\r\n      expandAllBtn.addEventListener(\"click\", () => {\r\n        faqItems.forEach(item => {\r\n          if (item.hidden || item.style.display === \"none\") return; // Skip hidden items\r\n          \r\n          const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n          if (isCustomAccordion) {\r\n            item.classList.add(\"is-open\");\r\n            const header = item.querySelector(\".accordion-header\");\r\n            const panel = item.querySelector(\".accordion-content\");\r\n            if (header) header.setAttribute(\"aria-expanded\", \"true\");\r\n            if (panel) panel.hidden = false;\r\n          } else {\r\n            item.open = true;\r\n          }\r\n        });\r\n        expandAllBtn.setAttribute(\"aria-pressed\", \"true\");\r\n        if (collapseAllBtn) collapseAllBtn.setAttribute(\"aria-pressed\", \"false\");\r\n      });\r\n    }\r\n\r\n    if (collapseAllBtn) {\r\n      collapseAllBtn.addEventListener(\"click\", () => {\r\n        faqItems.forEach(item => {\r\n          if (item.hidden || item.style.display === \"none\") return;\r\n          \r\n          const isCustomAccordion = !item.tagName || item.tagName.toLowerCase() !== 'details';\r\n          if (isCustomAccordion) {\r\n            item.classList.remove(\"is-open\");\r\n            const header = item.querySelector(\".accordion-header\");\r\n            const panel = item.querySelector(\".accordion-content\");\r\n            if (header) header.setAttribute(\"aria-expanded\", \"false\");\r\n            if (panel) panel.hidden = true;\r\n          } else {\r\n            item.open = false;\r\n          }\r\n        });\r\n        collapseAllBtn.setAttribute(\"aria-pressed\", \"true\");\r\n        if (expandAllBtn) expandAllBtn.setAttribute(\"aria-pressed\", \"false\");\r\n      });\r\n    }\r\n\r\n    // --- New Features Logic ---\r\n\r\n    // 1. Copy Link Functionality\r\n    document.querySelectorAll('.copy-faq-link').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        e.stopPropagation(); // Prevent accordion toggle\r\n        const link = btn.dataset.link;\r\n        if (!link) return;\r\n\r\n        const url = window.location.origin + window.location.pathname + link;\r\n        \r\n        navigator.clipboard.writeText(url).then(() => {\r\n          // Visual feedback\r\n          const originalIcon = btn.innerHTML;\r\n          btn.innerHTML = '<i class=\"fas fa-check\"></i>';\r\n          btn.style.color = '#2ecc71';\r\n          \r\n          // Show toast if available\r\n          if (window.createToast) {\r\n            window.createToast('لینک کپی شد!');\r\n          }\r\n\r\n          setTimeout(() => {\r\n            btn.innerHTML = originalIcon;\r\n            btn.style.color = '';\r\n          }, 2000);\r\n        }).catch(err => {\r\n          console.error('Failed to copy: ', err);\r\n        });\r\n      });\r\n    });\r\n\r\n    // 2. Feedback Functionality\r\n    // Restore feedback state\r\n    document.querySelectorAll('.faq-item').forEach(item => {\r\n        const id = item.id;\r\n        const storedFeedback = localStorage.getItem(`faq-feedback-${id}`);\r\n        if (storedFeedback) {\r\n            const btn = item.querySelector(`.btn-feedback.${storedFeedback}`);\r\n            if (btn) btn.classList.add('active');\r\n        }\r\n    });\r\n\r\n    document.querySelectorAll('.btn-feedback').forEach(btn => {\r\n      btn.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        const parent = btn.closest('.faq-feedback');\r\n        const item = btn.closest('.faq-item');\r\n        const id = item.id;\r\n        \r\n        // Remove active class from siblings\r\n        parent.querySelectorAll('.btn-feedback').forEach(b => b.classList.remove('active'));\r\n        \r\n        // Add active class to clicked button\r\n        btn.classList.add('active');\r\n        \r\n        const isUp = btn.classList.contains('up');\r\n        localStorage.setItem(`faq-feedback-${id}`, isUp ? 'up' : 'down');\r\n        \r\n        // Optional: Send analytics event here\r\n        const questionId = btn.closest('.faq-item').id;\r\n        console.log(`Feedback for ${questionId}: ${isUp ? 'Positive' : 'Negative'}`);\r\n        \r\n        if (window.createToast) {\r\n          window.createToast('بازخورد شما ثبت شد. ممنون!');\r\n        }\r\n      });\r\n    });\r\n\r\n    // 3. Handle Hash Navigation\r\n    if (window.location.hash) {\r\n      const targetId = window.location.hash.substring(1);\r\n      const targetItem = document.getElementById(targetId);\r\n      if (targetItem && targetItem.classList.contains('faq-item')) {\r\n        setTimeout(() => {\r\n          // Open the item\r\n          const isCustomAccordion = !targetItem.tagName || targetItem.tagName.toLowerCase() !== 'details';\r\n          if (isCustomAccordion) {\r\n            targetItem.classList.add(\"is-open\");\r\n            const header = targetItem.querySelector(\".accordion-header\");\r\n            const panel = targetItem.querySelector(\".accordion-content\");\r\n            if (header) header.setAttribute(\"aria-expanded\", \"true\");\r\n            if (panel) panel.hidden = false;\r\n          } else {\r\n            targetItem.open = true;\r\n          }\r\n          \r\n          // Scroll to it\r\n          targetItem.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n          \r\n          // Highlight effect\r\n          targetItem.style.transition = 'background-color 0.5s';\r\n          const originalBg = targetItem.style.backgroundColor;\r\n          targetItem.style.backgroundColor = 'rgba(52, 152, 219, 0.1)';\r\n          setTimeout(() => {\r\n            targetItem.style.backgroundColor = originalBg;\r\n          }, 1500);\r\n        }, 500); // Delay to ensure page load\r\n      }\r\n    }\r\n\r\n  });\r\n})();\r\n"]}