{"version":3,"file":"accordion.min.js","names":["window","addEventListener","document","querySelectorAll","forEach","content","style","maxHeight","scrollHeight","acc","index","dataset","accordionId","String","root","allowMultiple","getAttribute","hasAttribute","items","Array","from","headers","toggleItem","item","header","querySelector","panel","isExpanded","otherItem","collapseItem","setAttribute","opacity","classList","add","dispatchEvent","CustomEvent","bubbles","detail","expandItem","remove","accId","headerId","id","panelId","initiallyOpen","contains","push","e","key","preventDefault","currentIndex","indexOf","focus","length","initAccordion"],"sources":["accordion.js"],"mappings":"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","ignoreList":[],"sourcesContent":["// js/accordion.js\r\n(function () {\r\n  \"use strict\";\r\n\r\n  /**\r\n   * Initialize a single accordion container.\r\n   * @param {HTMLElement} root\r\n   */\r\n  function initAccordion(root) {\r\n    if (!root) {return;}\r\n\r\n    const allowMultiple =\r\n      root.getAttribute(\"data-allow-multiple\") === \"true\" ||\r\n      root.hasAttribute(\"data-allow-multiple\");\r\n\r\n    const items = Array.from(root.querySelectorAll(\".accordion-item\"));\r\n    const headers = [];\r\n\r\n    // First pass: Collect all headers and setup ARIA attributes\r\n    items.forEach((item, index) => {\r\n      const header = item.querySelector(\".accordion-header\");\r\n      const panel = item.querySelector(\".accordion-content\");\r\n\r\n      if (!header || !panel) {return;}\r\n\r\n      const accId = root.dataset.accordionId || \"main\";\r\n      const headerId = header.id || `accordion-header-${accId}-${index}`;\r\n      const panelId = panel.id || `accordion-panel-${accId}-${index}`;\r\n\r\n      header.id = headerId;\r\n      panel.id = panelId;\r\n\r\n      // آیا این آیتم در HTML به صورت پیش‌فرض باز است؟\r\n      const initiallyOpen =\r\n        item.classList.contains(\"is-open\") || item.hasAttribute(\"data-open\");\r\n\r\n      // ARIA wiring\r\n      header.setAttribute(\"role\", \"button\");\r\n      header.setAttribute(\"aria-controls\", panelId);\r\n      header.setAttribute(\"aria-expanded\", initiallyOpen ? \"true\" : \"false\");\r\n      header.setAttribute(\"tabindex\", \"0\");\r\n\r\n      panel.setAttribute(\"role\", \"region\");\r\n      panel.setAttribute(\"aria-labelledby\", headerId);\r\n      // panel.hidden = !initiallyOpen; // Removed for animation support\r\n\r\n      if (initiallyOpen) {\r\n        item.classList.add(\"is-open\");\r\n        panel.style.maxHeight = panel.scrollHeight + 50 + \"px\";\r\n        panel.style.opacity = \"1\";\r\n      } else {\r\n        item.classList.remove(\"is-open\");\r\n        panel.style.maxHeight = null;\r\n        panel.style.opacity = \"0\";\r\n      }\r\n\r\n      // Add to headers array for keyboard navigation\r\n      headers.push(header);\r\n    });\r\n\r\n    // Second pass: Attach event listeners using complete headers array\r\n    items.forEach((item, index) => {\r\n      const header = item.querySelector(\".accordion-header\");\r\n      const panel = item.querySelector(\".accordion-content\");\r\n\r\n      if (!header || !panel) {return;}\r\n\r\n      // Click / keyboard handlers\r\n      header.addEventListener(\"click\", () => {\r\n        toggleItem(item, allowMultiple);\r\n      });\r\n\r\n      header.addEventListener(\"keydown\", (e) => {\r\n        const key = e.key;\r\n\r\n        if (key === \"Enter\" || key === \" \") {\r\n          e.preventDefault();\r\n          toggleItem(item, allowMultiple);\r\n          return;\r\n        }\r\n\r\n        const currentIndex = headers.indexOf(header);\r\n        if (currentIndex === -1) {return;}\r\n\r\n        if (key === \"ArrowDown\") {\r\n          e.preventDefault();\r\n          const next = headers[currentIndex + 1] || headers[0];\r\n          next.focus();\r\n        } else if (key === \"ArrowUp\") {\r\n          e.preventDefault();\r\n          const prev = headers[currentIndex - 1] || headers[headers.length - 1];\r\n          prev.focus();\r\n        } else if (key === \"Home\") {\r\n          e.preventDefault();\r\n          headers[0].focus();\r\n        } else if (key === \"End\") {\r\n          e.preventDefault();\r\n          headers[headers.length - 1].focus();\r\n        }\r\n      });\r\n    });\r\n\r\n    /**\r\n     * Toggle one accordion item\r\n     * @param {HTMLElement} item\r\n     * @param {boolean} allowMultiple\r\n     */\r\n    function toggleItem(item, allowMultiple) {\r\n      const header = item.querySelector(\".accordion-header\");\r\n      const panel = item.querySelector(\".accordion-content\");\r\n      if (!header || !panel) {return;}\r\n\r\n      const isExpanded = header.getAttribute(\"aria-expanded\") === \"true\";\r\n\r\n      if (!allowMultiple) {\r\n        items.forEach((otherItem) => {\r\n          if (otherItem === item) {return;}\r\n          collapseItem(otherItem);\r\n        });\r\n      }\r\n\r\n      if (isExpanded) {\r\n        collapseItem(item);\r\n      } else {\r\n        expandItem(item);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Collapse item\r\n     * @param {HTMLElement} item\r\n     */\r\n    function collapseItem(item) {\r\n      const header = item.querySelector(\".accordion-header\");\r\n      const panel = item.querySelector(\".accordion-content\");\r\n      if (!header || !panel) {return;}\r\n\r\n      header.setAttribute(\"aria-expanded\", \"false\");\r\n      panel.style.maxHeight = null;\r\n      panel.style.opacity = \"0\";\r\n      item.classList.remove(\"is-open\");\r\n\r\n      // Custom event for hooks / analytics / extra animations\r\n      item.dispatchEvent(\r\n        new CustomEvent(\"accordion:collapse\", {\r\n          bubbles: true,\r\n          detail: { item, accordionId: root.dataset.accordionId },\r\n        })\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Expand item\r\n     * @param {HTMLElement} item\r\n     */\r\n    function expandItem(item) {\r\n      const header = item.querySelector(\".accordion-header\");\r\n      const panel = item.querySelector(\".accordion-content\");\r\n      if (!header || !panel) {return;}\r\n\r\n      header.setAttribute(\"aria-expanded\", \"true\");\r\n      // Add larger buffer to account for padding transition and potential layout shifts\r\n      panel.style.maxHeight = (panel.scrollHeight + 500) + \"px\";\r\n      panel.style.opacity = \"1\";\r\n      item.classList.add(\"is-open\");\r\n\r\n      // Custom event for hooks / analytics / extra animations\r\n      item.dispatchEvent(\r\n        new CustomEvent(\"accordion:expand\", {\r\n          bubbles: true,\r\n          detail: { item, accordionId: root.dataset.accordionId },\r\n        })\r\n      );\r\n    }\r\n  }\r\n\r\n  // Handle resize to adjust max-height of open items\r\n  window.addEventListener('resize', () => {\r\n      document.querySelectorAll(\".accordion-item.is-open .accordion-content\").forEach(content => {\r\n          content.style.maxHeight = (content.scrollHeight + 500) + \"px\";\r\n      });\r\n  });\r\n\r\n  document.addEventListener(\"DOMContentLoaded\", () => {\r\n    const accordions = document.querySelectorAll(\".accordion\");\r\n    accordions.forEach((acc, index) => {\r\n      if (!acc.dataset.accordionId) {\r\n        acc.dataset.accordionId = String(index + 1);\r\n      }\r\n      initAccordion(acc);\r\n    });\r\n  });\r\n})();\r\n"]}